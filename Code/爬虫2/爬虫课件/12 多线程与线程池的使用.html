<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.0.5 (458014)"/><meta name="altitude" content="36"/><meta name="author" content="李居豪"/><meta name="created" content="2019-05-26 13:26:32 +0000"/><meta name="latitude" content="39.63157002178432"/><meta name="longitude" content="116.0504192512924"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2019-06-03 11:59:04 +0000"/><meta name="content-class" content="yinxiang.markdown"/><title>12 多线程与线程池的使用</title></head><body><div><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/><hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/><h2 style="box-sizing: content-box; font-size: 34px; border-bottom: 1px solid rgb(219, 219, 219);"><span style="font-size: 34px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">线程介绍</span></h2><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(82, 134, 188); text-decoration: underline; box-sizing: content-box;">多任务的概念</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(82, 134, 188); text-decoration: underline; box-sizing: content-box;">线程</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(82, 134, 188); text-decoration: underline; box-sizing: content-box;">单线程执行</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(82, 134, 188); text-decoration: underline; box-sizing: content-box;">多线程执行</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(82, 134, 188); text-decoration: underline; box-sizing: content-box;">主线程与子线程的执行顺序</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(82, 134, 188); text-decoration: underline; box-sizing: content-box;">线程的执行顺序</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(82, 134, 188); text-decoration: underline; box-sizing: content-box;">多线程-共享全局变量</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(82, 134, 188); text-decoration: underline; box-sizing: content-box;">列表当做实参传递到线程中</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(82, 134, 188); text-decoration: underline; box-sizing: content-box;">互斥锁(重点)</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(82, 134, 188); text-decoration: underline; box-sizing: content-box;">死锁问题</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(82, 134, 188); text-decoration: underline; box-sizing: content-box;">多线程爬虫案例（jobbole）</span></div></li></ul><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%; box-sizing: content-box;">多任务的概念</span></h3><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">什么叫“多任务”呢？简单地说，就是操作系统可以同时运行多个任务。打个比方，你一边看电影，一边聊QQ，一边在用Word赶作业，这就是多任务，这时至少同时有3个任务正在运行。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">单核CPU如何执行多任务？</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">多核CPU如何执行多任务？</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">真正的并行执行多任务只能在多核CPU上实现，但是，由于任务数量远远多于CPU的核心数量，所以，操作系统也会自动把很多任务轮流调度到每个核心上执行。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">注意</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">并发</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：指的是任务数多余cpu核数，通过操作系统的各种任务调度算法，实现用多个任务“一起”执行（实际上总有一些任务不在执行，因为切换任务的速度相当快，看上去一起执行而已）</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">并行</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：指的是任务数小于等于cpu核数，即任务真的是一起执行的</span></div><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%; box-sizing: content-box;">线程</span></h3><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">python的thread模块是比较底层的模块，python的threading模块是对thread做了一些包装的，可以更加方便的被使用</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">1. 使用threading模块</span></div><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%; box-sizing: content-box;">单线程执行</span></h3><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#coding=utf-8</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import time</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def saySorry():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">　　for i in range(5):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("亲爱的，我错了，我能吃饭了吗？")</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(1)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def do():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(5):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("亲爱的，我错了，我给你按摩")</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(1)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">if __name__ == "__main__":</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">saySorry()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">saydo()</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">运行结果：</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">.....</span></div></div><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%; box-sizing: content-box;">多线程执行</span></h3><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#coding=utf-8</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import threading</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import time</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def saySorry():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">　　for i in range(5):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("亲爱的，我错了，我能吃饭了吗？")</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(1)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def do():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(5):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("亲爱的，我错了，我给你按摩")</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(1)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">if __name__ == "__main__":</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">td1 = threading.Thread(target=saySorry)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">td1.start() #启动线程，即让线程开始执行</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">td2 = threading.Thread(target=saySorry)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">td2.start() #启动线程，即让线程开始执行</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">threading.Thread参数介绍</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">target:线程执行的函数</span></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">name:线程名称</span></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">args:执行函数中需要传递的参数，元组类型</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">另外：注意daemon参数</span></div></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">如果某个子线程的daemon属性为False，主线程结束时会检测该子线程是否结束，如果该子线程还在运行，则主线程会等待它完成后再退出；</span></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">如果某个子线程的daemon属性为True，主线程运行结束时不对这个子线程进行检查而直接退出，同时所有daemon值为True的子线程将随主线程一起结束，而不论是否运行完成。</span></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">属性daemon的值默认为False，如果需要修改，必须在调用start()方法启动线程之前进行设置</span></div></li></ul><hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">说明</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">1.可以明显看出使用了多线程并发的操作，花费时间要短很多</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">2.当调用start()时，才会真正的创建线程，并且开始执行</span></div></div><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%; box-sizing: content-box;">主线程与子线程的执行顺序</span></h3><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#coding=utf-8</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import threading</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">from time import sleep,ctime</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def sing():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(3):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("正在唱歌...%d"%i)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">sleep(1)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def dance():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(3):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("正在跳舞...%d"%i)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">sleep(1)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">if __name__ == '__main__':</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print('---开始---:%s'%ctime())</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t1 = threading.Thread(target=sing)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t2 = threading.Thread(target=dance)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t1.start()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t2.start()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t1.join()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t2.join()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#sleep(5) # 屏蔽此行代码，试试看，程序是否会立马结束？</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print('---结束---:%s'%ctime())</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">线程-注意点</span></div><ol style="box-sizing: content-box; padding-left: 30px; margin: 6px 0px 10px; list-style-type: decimal;"><li style="box-sizing: content-box;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">线程执行代码的封装</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">通过上一小节，能够看出，通过使用threading模块能完成多任务的程序开发，为了让每个线程的封装性更完美，所以使用threading模块时，往往会定义一个新的子类class，只要继承threading.Thread就可以了，然后重写run方法</span></div></li></ol><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">示例如下：</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#coding=utf-8</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import threading</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import time</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">class MyThread(threading.Thread):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def run(self):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(3):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(1)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">msg = "I'm "+self.name+' @ '+str(i) #name属性中保存的是当前线程的名字</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(msg)</span></div><div><br/></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">if __name__ == '__main__':</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t = MyThread()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t.start()</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">说明</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">python的threading.Thread类有一个run方法，用于定义线程的功能函数，可以在自己的线程类中覆盖该方法。而创建自己的线程实例后，通过Thread类的start方法，可以启动该线程，交给python虚拟机进行调度，当该线程获得执行的机会时，就会调用run方法执行线程。</span></div></li></ul><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%; box-sizing: content-box;">线程的执行顺序</span></h3><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#coding=utf-8</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import threading</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import time</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">class MyThread(threading.Thread):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def run(self):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(3):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(1)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">msg = "I'm "+self.name+' @ '+str(i)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(msg)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def test():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(5):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t = MyThread()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t.start()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">if __name__ == '__main__':</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">test()</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">说明</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">从代码和执行结果我们可以看出，多线程程序的执行顺序是不确定的。当执行到sleep语句时，线程将被阻塞（Blocked），到sleep结束后，线程进入就绪（Runnable）状态，等待调度。而线程调度将自行选择一个线程执行。上面的代码中只能保证每个线程都运行完整个run函数，但是线程的启动顺序、run函数中每次循环的执行顺序都不能确定。</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">3. 总结</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">每个线程默认有一个名字，尽管上面的例子中没有指定线程对象的name，但是python会自动为线程指定一个名字。</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">当线程的run()方法结束时该线程完成。</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">无法控制线程调度程序，但可以通过别的方式来影响线程调度的方式。</span></div></li></ul><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%; box-sizing: content-box;">多线程-共享全局变量</span></h3><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">from threading import Thread</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import time</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">g_num = 100</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def work1():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">global g_num</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(3):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">g_num += 1</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("----in work1, g_num is %d---"%g_num)</span></div><div><br/></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def work2():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">global g_num</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("----in work2, g_num is %d---"%g_num)</span></div><div><br/></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("---线程创建之前g_num is %d---"%g_num)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t1 = Thread(target=work1)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t1.start()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#延时一会，保证t1线程中的事情做完</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(1)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t2 = Thread(target=work2)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t2.start()</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">运行结果:</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">---线程创建之前g_num is 100---</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">----in work1, g_num is 103---</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">----in work2, g_num is 103---</span></div></div></div><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%; box-sizing: content-box;">元组当做实参传递到线程中</span></h3><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">from threading import Thread</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import time</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def work1(nums):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">nums.append(44)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("----in work1---",nums)</span></div><div><br/></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def work2(nums):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#延时一会，保证t1线程中的事情做完</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(1)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("----in work2---",nums)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">g_nums = [11,22,33]</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t1 = Thread(target=work1, args=(g_nums,))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t1.start()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t2 = Thread(target=work2, args=(g_nums,))</span></div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t2.start()</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">运行结果:</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">----in work1--- [11, 22, 33, 44]</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">----in work2--- [11, 22, 33, 44]</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">总结：</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">在一个进程内的所有线程共享全局变量，很方便在多个线程间共享数据</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">缺点就是，线程是对全局变量随意遂改可能造成多线程之间对全局变量的混乱（即线程非安全）</span></div></li></ul><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%; box-sizing: content-box;">互斥锁(重点)</span></h3><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">当多个线程几乎同时修改某一个共享数据的时候，需要进行同步控制</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">线程同步能够保证多个线程安全访问竞争资源，最简单的同步机制是引入互斥锁。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">互斥锁为资源引入一个状态：锁定/非锁定</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">某个线程要更改共享数据时，先将其锁定，此时资源的状态为“锁定”，其他线程不能更改；直到该线程释放资源，将资源的状态变成“非锁定”，其他的线程才能再次锁定该资源。互斥锁保证了每次只有一个线程进行写入操作，从而保证了多线程情况下数据的正确性。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">threading模块中定义了Lock类，可以方便的处理锁定：</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 创建锁</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutex = threading.Lock()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 锁定</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutex.acquire()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 释放</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutex.release()</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">注意：</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">如果这个锁之前是没有上锁的，那么acquire不会堵塞</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">如果在调用acquire对这个锁上锁之前 它已经被 其他线程上了锁，那么此时acquire会堵塞，直到这个锁被解锁为止</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">使用互斥锁完成2个线程对同一个全局变量各加100万次的操作</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import threading</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import time</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">g_num = 0</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def test1(num):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">global g_num</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(num):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutex.acquire() # 上锁</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">g_num += 1</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutex.release() # 解锁</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("---test1---g_num=%d"%g_num)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def test2(num):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">global g_num</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(num):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutex.acquire() # 上锁</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">g_num += 1</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutex.release() # 解锁</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("---test2---g_num=%d"%g_num)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 创建一个互斥锁</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 默认是未上锁的状态</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutex = threading.Lock()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 创建2个线程，让他们各自对g_num加1000000次</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p1 = threading.Thread(target=test1, args=(1000000,))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p1.start()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p2 = threading.Thread(target=test2, args=(1000000,))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p2.start()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p1.join()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p2.join()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("2个线程对同一个全局变量操作之后的最终结果是:%s" % g_num)</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">运行结果：</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">2个线程对同一个全局变量操作之后的最终结果是:2000000</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">可以看到最后的结果，加入互斥锁后，其结果与预期相符。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">上锁解锁过程</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">当一个线程调用锁的acquire()方法获得锁时，锁就进入“locked”状态。</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">每次只有一个线程可以获得锁。如果此时另一个线程试图获得这个锁，该线程就会变为“blocked”状态，称为“阻塞”，直到拥有锁的线程调用锁的release()方法释放锁之后，锁进入“unlocked”状态。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">线程调度程序从处于同步阻塞状态的线程中选择一个来获得锁，并使得该线程进入运行（running）状态。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">总结</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">锁的好处：</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">确保了某段关键代码只能由一个线程从头到尾完整地执行</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">锁的坏处：</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">阻止了多线程并发执行，包含锁的某段代码实际上只能以单线程模式执行，效率就大大地下降了</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">由于可以存在多个锁，不同的线程持有不同的锁，并试图获取对方持有的锁时，可能会造成死锁</span></div></li></ul><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%; box-sizing: content-box;">死锁问题</span></h3><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">在线程间共享多个资源的时候，如果两个线程分别占有一部分资源并且同时等待对方的资源，就会造成死锁。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">尽管死锁很少发生，但一旦发生就会造成应用的停止响应。下面看一个死锁的例子</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#coding=utf-8</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import threading</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import time</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">class MyThread1(threading.Thread):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def run(self):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 对mutexA上锁</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutexA.acquire()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># mutexA上锁后，延时1秒，等待另外那个线程 把mutexB上锁</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(self.name+'----do1---up----')</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(1)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 此时会堵塞，因为这个mutexB已经被另外的线程抢先上锁了</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutexB.acquire()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(self.name+'----do1---down----')</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutexB.release()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 对mutexA解锁</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutexA.release()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">class MyThread2(threading.Thread):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def run(self):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 对mutexB上锁</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutexB.acquire()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># mutexB上锁后，延时1秒，等待另外那个线程 把mutexA上锁</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(self.name+'----do2---up----')</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(1)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 此时会堵塞，因为这个mutexA已经被另外的线程抢先上锁了</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutexA.acquire()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(self.name+'----do2---down----')</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutexA.release()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 对mutexB解锁</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutexB.release()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutexA = threading.Lock()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">mutexB = threading.Lock()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">if __name__ == '__main__':</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t1 = MyThread1()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t2 = MyThread2()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t1.start()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t2.start()</span></div></div></div><hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">多线程爬虫案例（jobbole）</span></h3><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">Queue（队列对象）</span></h4><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">Queue是python中的标准库，可以直接import Queue引用;</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">队列是线程间最常用的交换数据的形式</span></div></div><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">python下多线程的思考</span></h4><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">对于资源，加锁是个重要的环节。因为python原生的</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">list,dict等，都是not thread safe的</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">。而</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">Queue，是线程安全</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">的，因此在满足使用条件下，建议使用队列</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">初始化： class (</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">FIFO 先进先出</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">)</span></div></li></ul><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">queue = queue.Queue(maxsize)</span></div></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">包中的常用方法:</span></div></li></ul><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">queue.qsize() 返回队列的大小</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">queue.empty() 如果队列为空，返回True,反之False</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">queue.full() 如果队列满了，返回True,反之False</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">queue.full 与 maxsize 大小对应</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">queue.get(block,timeout)获取队列，timeout等待时间</span></div></div></div><ol start="3" style="box-sizing: content-box; padding-left: 30px; margin: 6px 0px 10px; list-style-type: decimal;"><li style="box-sizing: content-box;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">创建一个“队列”对象</span></div></li></ol><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import queue</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">myqueue = queue.Queue( maxsize = 10 )</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">4.将一个值放入队列中</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">myqueue.put(10)</span></div></div><ol start="5" style="box-sizing: content-box; padding-left: 30px; margin: 6px 0px 10px; list-style-type: decimal;"><li style="box-sizing: content-box;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">将一个值从队列中取出</span></div></li></ol><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">myqueue.get()</span></div></div><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; color: rgb(51, 51, 51); line-height: 160%;">多线程示意图(典型的生成者和消费者的模式)：</span></h4><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;"><img src="12%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E4%BD%BF%E7%94%A8.resources/25B8D419-87CF-4364-B497-DC8CFAC4C17F.png" height="385" width="1130"/></span></div><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">根据上面的图解，使用多线程爬取jobbole网站数据</span></h4><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import requests</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import threading</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">from lxml import etree</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import queue</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">class crawlThread(threading.Thread):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">"""自定义爬取线程"""</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def __init__(self,threadName,page_queue,data_queue):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">super(crawlThread,self).__init__()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">self.threadName = threadName</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">self.page_queue = page_queue</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">self.data_queue = data_queue</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">self.headers = {'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:60.0) Gecko/20100101 Firefox/60.0',}</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def run(self):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 这里从page_queue获取对应的页码</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">while not self.page_queue.empty():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#get()从队列中取值，先进先出</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">page = self.page_queue.get()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(page)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">full_url = 'http://blog.jobbole.com/all-posts/page/'+str(page)+'/'</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">response = requests.get(full_url,headers=self.headers)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">response.encoding = 'utf-8'</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">if response.status_code == 200:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#将获取到的结果，存放在data_queue队列中</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">self.data_queue.put(response.text)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># #线程的采集任务</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># def crawl_data(page_queue,data_queue):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># header = {</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:60.0) Gecko/20100101 Firefox/60.0',</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># }</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># # 这里从page_queue获取对应的页码</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># while not page_queue.empty():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># #get()从队列中取值，先进先出</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># page = page_queue.get()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># print(page)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># full_url = 'http://blog.jobbole.com/all-posts/page/'+str(page)+'/'</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># response = requests.get(full_url,headers=header)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># response.encoding = 'utf-8'</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># if response.status_code == 200:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># #将获取到的结果，存放在data_queue队列中</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># data_queue.put(response.text)</span></div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">class parseThread(threading.Thread):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">"""自定义解析线程"""</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def __init__(self,threadName,data_queue,lock):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">super(parseThread,self).__init__()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">self.threadName = threadName</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">self.data_queue = data_queue</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">self.lock = lock</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def run(self):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#不为空的时候去取值，为空说明没有解析任务了</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">while not self.data_queue.empty():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">html = etree.HTML(self.data_queue.get())</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">articles = html.xpath('//div[@]')</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for item in articles:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">title = item.xpath('.//a[@]/text()')[0]</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(title)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#加锁</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">self.lock.acquire()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">with open('jobbole.txt','a') as f:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">f.write(title+'\n')</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#解锁</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">self.lock.release()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># def parse_data(data_queue):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># #不为空的时候去取值，为空说明没有解析任务了</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># while not data_queue.empty():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># html = etree.HTML(data_queue.get())</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># articles = html.xpath('//div[@]')</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># for item in articles:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># title = item.xpath('.//a[@]/text()')[0]</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># print(title)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def spider():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#创建一个任务队列：里面的参数maxsize表示最大的存储量</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">page_queue = queue.Queue(40)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#http://blog.jobbole.com/all-posts/page/2/ (2表示页码)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(1,30):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">page_queue.put(i)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#将解析后的数据放在这个队列中，供后后面的解析线程去做解析</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">data_queue = queue.Queue()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#创建线程取下载任务</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">lock = threading.Lock()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">crawlThreadName = ['crawl1号','crawl2号','crawl3号','crawl4号']</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">thread_list = []</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for threadName in crawlThreadName:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># thread = threading.Thread(target=crawl_data,name=threadName,args=(page_queue,data_queue))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">thread = crawlThread(threadName,page_queue,data_queue)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">thread.start()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">thread_list.append(thread)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># thread.join() 不能直接写在这里</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for thread in thread_list:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">thread.join()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#创建解析线程：</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">parseThreadName = ['parse1号','parse2号','parse3号','parse4号']</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">parseThread_list = []</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for threadName in parseThreadName:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># thread = threading.Thread(target=parse_data,name=threadName,args=(data_queue,))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">thread = parseThread(threadName,data_queue,lock)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">thread.start()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">parseThread_list.append(thread)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for thread in parseThread_list:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">thread.join()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#打印当前线程的名称</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(threading.current_thread().name)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">if __name__ == '__main__':</span></div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">spider()</span></div></div><hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">线程池</span></h3><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%; box-sizing: content-box;">使用python3.2之后为我们封装的线程池</span></h3><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">(案例一)线程池简单使用样例</span></h4><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">导入模块包</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">from concurrent.futures import ThreadPoolExecutor</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">线程池中的线程需要执行的任务</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def get_page_data(page):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">"""</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">线程需要执行的任务</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">:param url:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">:return:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">"""</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(page)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">return 'done下载完成'</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">任务执行完毕之后的回调函数，可以获取到现场执行完毕的返回值</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def done(future):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(future.result())</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">创建线程池，并往线程池中添加任务</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#创建一个线程池</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">pool = ThreadPoolExecutor(10)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#如何提交任务给线程池呢？</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#网线程池中添加任务</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for pagenum in range(50):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#submit: 表示将我们需要执行的任务给这个线程池，</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">handler = pool.submit(get_page_data,pagenum)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#给线程池设置任务之后，可以设置一个回调函数，</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#作用是：当我们某个任务执行完毕之后，就会回调你设置的回调函数</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">handler.add_done_callback(done)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">pool.shutdown(wait=True)</span></div></div></div><hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; color: rgb(51, 51, 51); line-height: 160%;">课后作业：</span></h4><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">自定义一个类,可以设置任意京东商品url地址，获取该商品的全部评论信息，将评论信息数据分别保存至csv文件和mysql数据库，要求使用线程池来完成</span></div><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; color: rgb(51, 51, 51); line-height: 160%;">扩展作业：</span></h4><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">使用线程池获取起点的小说网小说和章节数据**</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 1.思路，首先获取分类的url地址</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 2.根据分类的url地址获取小说列表</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 3.根据小说列表，拼接章节列表url地址</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 4.根据章节列表url地址，获取章节列表</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 5.获取章节列表,遍历得到每一章节的url地址</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 6.根据章节的url地址,发起请求获取响应,解析，得到每一章节的数据</span></div></div></div></div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%0A*%20*%20*%0A%0A*%20*%20*%0A%0A%23%23%20%E7%BA%BF%E7%A8%8B%E4%BB%8B%E7%BB%8D%0A*%20%5B%E5%A4%9A%E4%BB%BB%E5%8A%A1%E7%9A%84%E6%A6%82%E5%BF%B5%5D(%23%E5%A4%9A%E4%BB%BB%E5%8A%A1%E7%9A%84%E6%A6%82%E5%BF%B5)%0A*%20%5B%E7%BA%BF%E7%A8%8B%5D(%23%E7%BA%BF%E7%A8%8B)%0A*%20%5B%E5%8D%95%E7%BA%BF%E7%A8%8B%E6%89%A7%E8%A1%8C%5D(%23%E5%8D%95%E7%BA%BF%E7%A8%8B%E6%89%A7%E8%A1%8C)%0A*%20%5B%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%89%A7%E8%A1%8C%5D(%23%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%89%A7%E8%A1%8C)%0A*%20%5B%E4%B8%BB%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%AD%90%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F%5D(%23%E4%B8%BB%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%AD%90%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F)%0A*%20%5B%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F%5D(%23%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F)%0A*%20%5B%E5%A4%9A%E7%BA%BF%E7%A8%8B-%E5%85%B1%E4%BA%AB%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%5D(%23%E5%A4%9A%E7%BA%BF%E7%A8%8B-%E5%85%B1%E4%BA%AB%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F)%0A*%20%5B%E5%88%97%E8%A1%A8%E5%BD%93%E5%81%9A%E5%AE%9E%E5%8F%82%E4%BC%A0%E9%80%92%E5%88%B0%E7%BA%BF%E7%A8%8B%E4%B8%AD%5D(%23%E5%88%97%E8%A1%A8%E5%BD%93%E5%81%9A%E5%AE%9E%E5%8F%82%E4%BC%A0%E9%80%92%E5%88%B0%E7%BA%BF****%E7%A8%8B%E4%B8%AD)%0A*%20%5B%E4%BA%92%E6%96%A5%E9%94%81(%E9%87%8D%E7%82%B9)%5D(%23%E4%BA%92%E6%96%A5%E9%94%81(%E9%87%8D%E7%82%B9))%0A*%20%5B%E6%AD%BB%E9%94%81%E9%97%AE%E9%A2%98%5D(%23%E6%AD%BB%E9%94%81%E9%97%AE%E9%A2%98)%0A*%20%5B%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%88%AC%E8%99%AB%E6%A1%88%E4%BE%8B%EF%BC%88jobbole%EF%BC%89%5D(%23%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%88%AC%E8%99%AB%E6%A1%88%E4%BE%8B%EF%BC%88jobbole%EF%BC%89)%0A%0A%23%23%23%20**%E5%A4%9A%E4%BB%BB%E5%8A%A1%E7%9A%84%E6%A6%82%E5%BF%B5**%0A%0A%E4%BB%80%E4%B9%88%E5%8F%AB%E2%80%9C%E5%A4%9A%E4%BB%BB%E5%8A%A1%E2%80%9D%E5%91%A2%EF%BC%9F%E7%AE%80%E5%8D%95%E5%9C%B0%E8%AF%B4%EF%BC%8C%E5%B0%B1%E6%98%AF%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8F%AF%E4%BB%A5%E5%90%8C%E6%97%B6%E8%BF%90%E8%A1%8C%E5%A4%9A%E4%B8%AA%E4%BB%BB%E5%8A%A1%E3%80%82%E6%89%93%E4%B8%AA%E6%AF%94%E6%96%B9%EF%BC%8C%E4%BD%A0%E4%B8%80%E8%BE%B9%E7%9C%8B%E7%94%B5%E5%BD%B1%EF%BC%8C%E4%B8%80%E8%BE%B9%E8%81%8AQQ%EF%BC%8C%E4%B8%80%E8%BE%B9%E5%9C%A8%E7%94%A8Word%E8%B5%B6%E4%BD%9C%E4%B8%9A%EF%BC%8C%E8%BF%99%E5%B0%B1%E6%98%AF%E5%A4%9A%E4%BB%BB%E5%8A%A1%EF%BC%8C%E8%BF%99%E6%97%B6%E8%87%B3%E5%B0%91%E5%90%8C%E6%97%B6%E6%9C%893%E4%B8%AA%E4%BB%BB%E5%8A%A1%E6%AD%A3%E5%9C%A8%E8%BF%90%E8%A1%8C%E3%80%82%0A%0A%E5%8D%95%E6%A0%B8CPU%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E5%A4%9A%E4%BB%BB%E5%8A%A1%EF%BC%9F%0A%E5%A4%9A%E6%A0%B8CPU%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E5%A4%9A%E4%BB%BB%E5%8A%A1%EF%BC%9F%0A%0A%E7%9C%9F%E6%AD%A3%E7%9A%84%E5%B9%B6%E8%A1%8C%E6%89%A7%E8%A1%8C%E5%A4%9A%E4%BB%BB%E5%8A%A1%E5%8F%AA%E8%83%BD%E5%9C%A8%E5%A4%9A%E6%A0%B8CPU%E4%B8%8A%E5%AE%9E%E7%8E%B0%EF%BC%8C%E4%BD%86%E6%98%AF%EF%BC%8C%E7%94%B1%E4%BA%8E%E4%BB%BB%E5%8A%A1%E6%95%B0%E9%87%8F%E8%BF%9C%E8%BF%9C%E5%A4%9A%E4%BA%8ECPU%E7%9A%84%E6%A0%B8%E5%BF%83%E6%95%B0%E9%87%8F%EF%BC%8C%E6%89%80%E4%BB%A5%EF%BC%8C%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%9F%E4%BC%9A%E8%87%AA%E5%8A%A8%E6%8A%8A%E5%BE%88%E5%A4%9A%E4%BB%BB%E5%8A%A1%E8%BD%AE%E6%B5%81%E8%B0%83%E5%BA%A6%E5%88%B0%E6%AF%8F%E4%B8%AA%E6%A0%B8%E5%BF%83%E4%B8%8A%E6%89%A7%E8%A1%8C%E3%80%82%0A%0A%0A**%E6%B3%A8%E6%84%8F**%EF%BC%9A%0A%0A**%E5%B9%B6%E5%8F%91**%EF%BC%9A%E6%8C%87%E7%9A%84%E6%98%AF%E4%BB%BB%E5%8A%A1%E6%95%B0%E5%A4%9A%E4%BD%99cpu%E6%A0%B8%E6%95%B0%EF%BC%8C%E9%80%9A%E8%BF%87%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%90%84%E7%A7%8D%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95%EF%BC%8C%E5%AE%9E%E7%8E%B0%E7%94%A8%E5%A4%9A%E4%B8%AA%E4%BB%BB%E5%8A%A1%E2%80%9C%E4%B8%80%E8%B5%B7%E2%80%9D%E6%89%A7%E8%A1%8C%EF%BC%88%E5%AE%9E%E9%99%85%E4%B8%8A%E6%80%BB%E6%9C%89%E4%B8%80%E4%BA%9B%E4%BB%BB%E5%8A%A1%E4%B8%8D%E5%9C%A8%E6%89%A7%E8%A1%8C%EF%BC%8C%E5%9B%A0%E4%B8%BA%E5%88%87%E6%8D%A2%E4%BB%BB%E5%8A%A1%E7%9A%84%E9%80%9F%E5%BA%A6%E7%9B%B8%E5%BD%93%E5%BF%AB%EF%BC%8C%E7%9C%8B%E4%B8%8A%E5%8E%BB%E4%B8%80%E8%B5%B7%E6%89%A7%E8%A1%8C%E8%80%8C%E5%B7%B2%EF%BC%89%0A%0A**%E5%B9%B6%E8%A1%8C**%EF%BC%9A%E6%8C%87%E7%9A%84%E6%98%AF%E4%BB%BB%E5%8A%A1%E6%95%B0%E5%B0%8F%E4%BA%8E%E7%AD%89%E4%BA%8Ecpu%E6%A0%B8%E6%95%B0%EF%BC%8C%E5%8D%B3%E4%BB%BB%E5%8A%A1%E7%9C%9F%E7%9A%84%E6%98%AF%E4%B8%80%E8%B5%B7%E6%89%A7%E8%A1%8C%E7%9A%84%0A%0A%23%23%23%20**%E7%BA%BF%E7%A8%8B**%0A%20%0A**python%E7%9A%84thread%E6%A8%A1%E5%9D%97%E6%98%AF%E6%AF%94%E8%BE%83%E5%BA%95%E5%B1%82%E7%9A%84%E6%A8%A1%E5%9D%97%EF%BC%8Cpython%E7%9A%84threading%E6%A8%A1%E5%9D%97%E6%98%AF%E5%AF%B9thread%E5%81%9A%E4%BA%86%E4%B8%80%E4%BA%9B%E5%8C%85%E8%A3%85%E7%9A%84%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%9B%B4%E5%8A%A0%E6%96%B9%E4%BE%BF%E7%9A%84%E8%A2%AB%E4%BD%BF%E7%94%A8**%0A%0A**1.%20%E4%BD%BF%E7%94%A8threading%E6%A8%A1%E5%9D%97**%0A%0A%23%23%23%20**%E5%8D%95%E7%BA%BF%E7%A8%8B%E6%89%A7%E8%A1%8C**%0A%60%60%60%0A%23coding%3Dutf-8%0Aimport%20time%0A%0Adef%20saySorry()%3A%0A%E3%80%80%E3%80%80for%20i%20in%20range(5)%3A%0A%20%20%20%20%20%20%20%20print(%22%E4%BA%B2%E7%88%B1%E7%9A%84%EF%BC%8C%E6%88%91%E9%94%99%E4%BA%86%EF%BC%8C%E6%88%91%E8%83%BD%E5%90%83%E9%A5%AD%E4%BA%86%E5%90%97%EF%BC%9F%22)%0A%20%20%20%20%20%20%20%20time.sleep(1)%0A%0Adef%20do()%3A%0A%20%20%20%20for%20i%20in%20range(5)%3A%0A%20%20%20%20%20%20%20%20print(%22%E4%BA%B2%E7%88%B1%E7%9A%84%EF%BC%8C%E6%88%91%E9%94%99%E4%BA%86%EF%BC%8C%E6%88%91%E7%BB%99%E4%BD%A0%E6%8C%89%E6%91%A9%22)%0A%20%20%20%20%20%20%20%20time.sleep(1)%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20%20%20%20%20saySorry()%0A%20%20%20%20%20%20%20%20saydo()%0A%60%60%60%0A%0A%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C%EF%BC%9A%0A.....%0A%0A%0A%23%23%23%20**%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%89%A7%E8%A1%8C**%0A%60%60%60%0A%0A%23coding%3Dutf-8%0Aimport%20threading%0Aimport%20time%0A%0Adef%20saySorry()%3A%0A%E3%80%80%E3%80%80for%20i%20in%20range(5)%3A%0A%20%20%20%20%20%20%20%20print(%22%E4%BA%B2%E7%88%B1%E7%9A%84%EF%BC%8C%E6%88%91%E9%94%99%E4%BA%86%EF%BC%8C%E6%88%91%E8%83%BD%E5%90%83%E9%A5%AD%E4%BA%86%E5%90%97%EF%BC%9F%22)%0A%20%20%20%20%20%20%20%20time.sleep(1)%0A%0Adef%20do()%3A%0A%20%20%20%20for%20i%20in%20range(5)%3A%0A%20%20%20%20%20%20%20%20print(%22%E4%BA%B2%E7%88%B1%E7%9A%84%EF%BC%8C%E6%88%91%E9%94%99%E4%BA%86%EF%BC%8C%E6%88%91%E7%BB%99%E4%BD%A0%E6%8C%89%E6%91%A9%22)%0A%20%20%20%20%20%20%20%20time.sleep(1)%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20td1%20%3D%20threading.Thread(target%3DsaySorry)%0A%20%20%20%20td1.start()%20%23%E5%90%AF%E5%8A%A8%E7%BA%BF%E7%A8%8B%EF%BC%8C%E5%8D%B3%E8%AE%A9%E7%BA%BF%E7%A8%8B%E5%BC%80%E5%A7%8B%E6%89%A7%E8%A1%8C%0A%20%20%20%20td2%20%3D%20threading.Thread(target%3DsaySorry)%0A%20%20%20%20td2.start()%20%23%E5%90%AF%E5%8A%A8%E7%BA%BF%E7%A8%8B%EF%BC%8C%E5%8D%B3%E8%AE%A9%E7%BA%BF%E7%A8%8B%E5%BC%80%E5%A7%8B%E6%89%A7%E8%A1%8C%0A%60%60%60%0A**threading.Thread%E5%8F%82%E6%95%B0%E4%BB%8B%E7%BB%8D**%0A-%20target%3A%E7%BA%BF%E7%A8%8B%E6%89%A7%E8%A1%8C%E7%9A%84%E5%87%BD%E6%95%B0%0A-%20name%3A%E7%BA%BF%E7%A8%8B%E5%90%8D%E7%A7%B0%0A-%20args%3A%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0%E4%B8%AD%E9%9C%80%E8%A6%81%E4%BC%A0%E9%80%92%E7%9A%84%E5%8F%82%E6%95%B0%EF%BC%8C%E5%85%83%E7%BB%84%E7%B1%BB%E5%9E%8B%0A**%E5%8F%A6%E5%A4%96%EF%BC%9A%E6%B3%A8%E6%84%8Fdaemon%E5%8F%82%E6%95%B0**%0A-%20%E5%A6%82%E6%9E%9C%E6%9F%90%E4%B8%AA%E5%AD%90%E7%BA%BF%E7%A8%8B%E7%9A%84daemon%E5%B1%9E%E6%80%A7%E4%B8%BAFalse%EF%BC%8C%E4%B8%BB%E7%BA%BF%E7%A8%8B%E7%BB%93%E6%9D%9F%E6%97%B6%E4%BC%9A%E6%A3%80%E6%B5%8B%E8%AF%A5%E5%AD%90%E7%BA%BF%E7%A8%8B%E6%98%AF%E5%90%A6%E7%BB%93%E6%9D%9F%EF%BC%8C%E5%A6%82%E6%9E%9C%E8%AF%A5%E5%AD%90%E7%BA%BF%E7%A8%8B%E8%BF%98%E5%9C%A8%E8%BF%90%E8%A1%8C%EF%BC%8C%E5%88%99%E4%B8%BB%E7%BA%BF%E7%A8%8B%E4%BC%9A%E7%AD%89%E5%BE%85%E5%AE%83%E5%AE%8C%E6%88%90%E5%90%8E%E5%86%8D%E9%80%80%E5%87%BA%EF%BC%9B%0A%0A-%20%E5%A6%82%E6%9E%9C%E6%9F%90%E4%B8%AA%E5%AD%90%E7%BA%BF%E7%A8%8B%E7%9A%84daemon%E5%B1%9E%E6%80%A7%E4%B8%BATrue%EF%BC%8C%E4%B8%BB%E7%BA%BF%E7%A8%8B%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9D%9F%E6%97%B6%E4%B8%8D%E5%AF%B9%E8%BF%99%E4%B8%AA%E5%AD%90%E7%BA%BF%E7%A8%8B%E8%BF%9B%E8%A1%8C%E6%A3%80%E6%9F%A5%E8%80%8C%E7%9B%B4%E6%8E%A5%E9%80%80%E5%87%BA%EF%BC%8C%E5%90%8C%E6%97%B6%E6%89%80%E6%9C%89daemon%E5%80%BC%E4%B8%BATrue%E7%9A%84%E5%AD%90%E7%BA%BF%E7%A8%8B%E5%B0%86%E9%9A%8F%E4%B8%BB%E7%BA%BF%E7%A8%8B%E4%B8%80%E8%B5%B7%E7%BB%93%E6%9D%9F%EF%BC%8C%E8%80%8C%E4%B8%8D%E8%AE%BA%E6%98%AF%E5%90%A6%E8%BF%90%E8%A1%8C%E5%AE%8C%E6%88%90%E3%80%82%0A%0A-%20%E5%B1%9E%E6%80%A7daemon%E7%9A%84%E5%80%BC%E9%BB%98%E8%AE%A4%E4%B8%BAFalse%EF%BC%8C%E5%A6%82%E6%9E%9C%E9%9C%80%E8%A6%81%E4%BF%AE%E6%94%B9%EF%BC%8C%E5%BF%85%E9%A1%BB%E5%9C%A8%E8%B0%83%E7%94%A8start()%E6%96%B9%E6%B3%95%E5%90%AF%E5%8A%A8%E7%BA%BF%E7%A8%8B%E4%B9%8B%E5%89%8D%E8%BF%9B%E8%A1%8C%E8%AE%BE%E7%BD%AE%0A%0A---------------------%20%0A%0A**%E8%AF%B4%E6%98%8E**%0A%0A1.%E5%8F%AF%E4%BB%A5%E6%98%8E%E6%98%BE%E7%9C%8B%E5%87%BA%E4%BD%BF%E7%94%A8%E4%BA%86%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%B9%B6%E5%8F%91%E7%9A%84%E6%93%8D%E4%BD%9C%EF%BC%8C%E8%8A%B1%E8%B4%B9%E6%97%B6%E9%97%B4%E8%A6%81%E7%9F%AD%E5%BE%88%E5%A4%9A%0A2.%E5%BD%93%E8%B0%83%E7%94%A8start()%E6%97%B6%EF%BC%8C%E6%89%8D%E4%BC%9A%E7%9C%9F%E6%AD%A3%E7%9A%84%E5%88%9B%E5%BB%BA%E7%BA%BF%E7%A8%8B%EF%BC%8C%E5%B9%B6%E4%B8%94%E5%BC%80%E5%A7%8B%E6%89%A7%E8%A1%8C%0A%0A%0A%23%23%23%20**%E4%B8%BB%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%AD%90%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F**%0A%0A%60%60%60%0A%23coding%3Dutf-8%0Aimport%20threading%0Afrom%20time%20import%20sleep%2Cctime%0A%0Adef%20sing()%3A%0A%20%20%20%20for%20i%20in%20range(3)%3A%0A%20%20%20%20%20%20%20%20print(%22%E6%AD%A3%E5%9C%A8%E5%94%B1%E6%AD%8C...%25d%22%25i)%0A%20%20%20%20%20%20%20%20sleep(1)%0A%0Adef%20dance()%3A%0A%20%20%20%20for%20i%20in%20range(3)%3A%0A%20%20%20%20%20%20%20%20print(%22%E6%AD%A3%E5%9C%A8%E8%B7%B3%E8%88%9E...%25d%22%25i)%0A%20%20%20%20%20%20%20%20sleep(1)%0A%0Aif%20__name__%20%3D%3D%20'__main__'%3A%0A%20%20%20%20print('---%E5%BC%80%E5%A7%8B---%3A%25s'%25ctime())%0A%0A%20%20%20%20t1%20%3D%20threading.Thread(target%3Dsing)%0A%20%20%20%20t2%20%3D%20threading.Thread(target%3Ddance)%0A%0A%20%20%20%20t1.start()%0A%20%20%20%20t2.start()%0A%0A%20%20%20%20t1.join()%0A%20%20%20%20t2.join()%0A%0A%20%20%20%20%23sleep(5)%20%23%20%E5%B1%8F%E8%94%BD%E6%AD%A4%E8%A1%8C%E4%BB%A3%E7%A0%81%EF%BC%8C%E8%AF%95%E8%AF%95%E7%9C%8B%EF%BC%8C%E7%A8%8B%E5%BA%8F%E6%98%AF%E5%90%A6%E4%BC%9A%E7%AB%8B%E9%A9%AC%E7%BB%93%E6%9D%9F%EF%BC%9F%0A%20%20%20%20print('---%E7%BB%93%E6%9D%9F---%3A%25s'%25ctime())%0A%60%60%60%0A%0A**%E7%BA%BF%E7%A8%8B-%E6%B3%A8%E6%84%8F%E7%82%B9**%0A%0A1.%20%E7%BA%BF%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E7%9A%84%E5%B0%81%E8%A3%85%0A%E9%80%9A%E8%BF%87%E4%B8%8A%E4%B8%80%E5%B0%8F%E8%8A%82%EF%BC%8C%E8%83%BD%E5%A4%9F%E7%9C%8B%E5%87%BA%EF%BC%8C%E9%80%9A%E8%BF%87%E4%BD%BF%E7%94%A8threading%E6%A8%A1%E5%9D%97%E8%83%BD%E5%AE%8C%E6%88%90%E5%A4%9A%E4%BB%BB%E5%8A%A1%E7%9A%84%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91%EF%BC%8C%E4%B8%BA%E4%BA%86%E8%AE%A9%E6%AF%8F%E4%B8%AA%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%B0%81%E8%A3%85%E6%80%A7%E6%9B%B4%E5%AE%8C%E7%BE%8E%EF%BC%8C%E6%89%80%E4%BB%A5%E4%BD%BF%E7%94%A8threading%E6%A8%A1%E5%9D%97%E6%97%B6%EF%BC%8C%E5%BE%80%E5%BE%80%E4%BC%9A%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84%E5%AD%90%E7%B1%BBclass%EF%BC%8C%E5%8F%AA%E8%A6%81%E7%BB%A7%E6%89%BFthreading.Thread%E5%B0%B1%E5%8F%AF%E4%BB%A5%E4%BA%86%EF%BC%8C%E7%84%B6%E5%90%8E%E9%87%8D%E5%86%99run%E6%96%B9%E6%B3%95%0A%0A%E7%A4%BA%E4%BE%8B%E5%A6%82%E4%B8%8B%EF%BC%9A%0A%0A%60%60%60%0A%23coding%3Dutf-8%0Aimport%20threading%0Aimport%20time%0A%0Aclass%20MyThread(threading.Thread)%3A%0A%20%20%20%20def%20run(self)%3A%0A%20%20%20%20%20%20%20%20for%20i%20in%20range(3)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20time.sleep(1)%0A%20%20%20%20%20%20%20%20%20%20%20%20msg%20%3D%20%22I'm%20%22%2Bself.name%2B'%20%40%20'%2Bstr(i)%20%23name%E5%B1%9E%E6%80%A7%E4%B8%AD%E4%BF%9D%E5%AD%98%E7%9A%84%E6%98%AF%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%90%8D%E5%AD%97%0A%20%20%20%20%20%20%20%20%20%20%20%20print(msg)%0A%0A%0Aif%20__name__%20%3D%3D%20'__main__'%3A%0A%20%20%20%20t%20%3D%20MyThread()%0A%20%20%20%20t.start()%0A%60%60%60%0A%0A**%E8%AF%B4%E6%98%8E**%0A-%20python%E7%9A%84threading.Thread%E7%B1%BB%E6%9C%89%E4%B8%80%E4%B8%AArun%E6%96%B9%E6%B3%95%EF%BC%8C%E7%94%A8%E4%BA%8E%E5%AE%9A%E4%B9%89%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%8A%9F%E8%83%BD%E5%87%BD%E6%95%B0%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%9C%A8%E8%87%AA%E5%B7%B1%E7%9A%84%E7%BA%BF%E7%A8%8B%E7%B1%BB%E4%B8%AD%E8%A6%86%E7%9B%96%E8%AF%A5%E6%96%B9%E6%B3%95%E3%80%82%E8%80%8C%E5%88%9B%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E7%BA%BF%E7%A8%8B%E5%AE%9E%E4%BE%8B%E5%90%8E%EF%BC%8C%E9%80%9A%E8%BF%87Thread%E7%B1%BB%E7%9A%84start%E6%96%B9%E6%B3%95%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%90%AF%E5%8A%A8%E8%AF%A5%E7%BA%BF%E7%A8%8B%EF%BC%8C%E4%BA%A4%E7%BB%99python%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BF%9B%E8%A1%8C%E8%B0%83%E5%BA%A6%EF%BC%8C%E5%BD%93%E8%AF%A5%E7%BA%BF%E7%A8%8B%E8%8E%B7%E5%BE%97%E6%89%A7%E8%A1%8C%E7%9A%84%E6%9C%BA%E4%BC%9A%E6%97%B6%EF%BC%8C%E5%B0%B1%E4%BC%9A%E8%B0%83%E7%94%A8run%E6%96%B9%E6%B3%95%E6%89%A7%E8%A1%8C%E7%BA%BF%E7%A8%8B%E3%80%82%0A%0A%23%23%23%20**%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F**%0A%0A%60%60%60%0A%23coding%3Dutf-8%0Aimport%20threading%0Aimport%20time%0A%0Aclass%20MyThread(threading.Thread)%3A%0A%20%20%20%20def%20run(self)%3A%0A%20%20%20%20%20%20%20%20for%20i%20in%20range(3)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20time.sleep(1)%0A%20%20%20%20%20%20%20%20%20%20%20%20msg%20%3D%20%22I'm%20%22%2Bself.name%2B'%20%40%20'%2Bstr(i)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(msg)%0Adef%20test()%3A%0A%20%20%20%20for%20i%20in%20range(5)%3A%0A%20%20%20%20%20%20%20%20t%20%3D%20MyThread()%0A%20%20%20%20%20%20%20%20t.start()%0Aif%20__name__%20%3D%3D%20'__main__'%3A%0A%20%20%20%20test()%0A%60%60%60%0A%0A**%E8%AF%B4%E6%98%8E**%0A%0A-%20%E4%BB%8E%E4%BB%A3%E7%A0%81%E5%92%8C%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%87%BA%EF%BC%8C%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F%E6%98%AF%E4%B8%8D%E7%A1%AE%E5%AE%9A%E7%9A%84%E3%80%82%E5%BD%93%E6%89%A7%E8%A1%8C%E5%88%B0sleep%E8%AF%AD%E5%8F%A5%E6%97%B6%EF%BC%8C%E7%BA%BF%E7%A8%8B%E5%B0%86%E8%A2%AB%E9%98%BB%E5%A1%9E%EF%BC%88Blocked%EF%BC%89%EF%BC%8C%E5%88%B0sleep%E7%BB%93%E6%9D%9F%E5%90%8E%EF%BC%8C%E7%BA%BF%E7%A8%8B%E8%BF%9B%E5%85%A5%E5%B0%B1%E7%BB%AA%EF%BC%88Runnable%EF%BC%89%E7%8A%B6%E6%80%81%EF%BC%8C%E7%AD%89%E5%BE%85%E8%B0%83%E5%BA%A6%E3%80%82%E8%80%8C%E7%BA%BF%E7%A8%8B%E8%B0%83%E5%BA%A6%E5%B0%86%E8%87%AA%E8%A1%8C%E9%80%89%E6%8B%A9%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E6%89%A7%E8%A1%8C%E3%80%82%E4%B8%8A%E9%9D%A2%E7%9A%84%E4%BB%A3%E7%A0%81%E4%B8%AD%E5%8F%AA%E8%83%BD%E4%BF%9D%E8%AF%81%E6%AF%8F%E4%B8%AA%E7%BA%BF%E7%A8%8B%E9%83%BD%E8%BF%90%E8%A1%8C%E5%AE%8C%E6%95%B4%E4%B8%AArun%E5%87%BD%E6%95%B0%EF%BC%8C%E4%BD%86%E6%98%AF%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%90%AF%E5%8A%A8%E9%A1%BA%E5%BA%8F%E3%80%81run%E5%87%BD%E6%95%B0%E4%B8%AD%E6%AF%8F%E6%AC%A1%E5%BE%AA%E7%8E%AF%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F%E9%83%BD%E4%B8%8D%E8%83%BD%E7%A1%AE%E5%AE%9A%E3%80%82%0A%0A**3.%20%E6%80%BB%E7%BB%93**%0A-%20%E6%AF%8F%E4%B8%AA%E7%BA%BF%E7%A8%8B%E9%BB%98%E8%AE%A4%E6%9C%89%E4%B8%80%E4%B8%AA%E5%90%8D%E5%AD%97%EF%BC%8C%E5%B0%BD%E7%AE%A1%E4%B8%8A%E9%9D%A2%E7%9A%84%E4%BE%8B%E5%AD%90%E4%B8%AD%E6%B2%A1%E6%9C%89%E6%8C%87%E5%AE%9A%E7%BA%BF%E7%A8%8B%E5%AF%B9%E8%B1%A1%E7%9A%84name%EF%BC%8C%E4%BD%86%E6%98%AFpython%E4%BC%9A%E8%87%AA%E5%8A%A8%E4%B8%BA%E7%BA%BF%E7%A8%8B%E6%8C%87%E5%AE%9A%E4%B8%80%E4%B8%AA%E5%90%8D%E5%AD%97%E3%80%82%0A-%20%E5%BD%93%E7%BA%BF%E7%A8%8B%E7%9A%84run()%E6%96%B9%E6%B3%95%E7%BB%93%E6%9D%9F%E6%97%B6%E8%AF%A5%E7%BA%BF%E7%A8%8B%E5%AE%8C%E6%88%90%E3%80%82%0A-%20%E6%97%A0%E6%B3%95%E6%8E%A7%E5%88%B6%E7%BA%BF%E7%A8%8B%E8%B0%83%E5%BA%A6%E7%A8%8B%E5%BA%8F%EF%BC%8C%E4%BD%86%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E5%88%AB%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9D%A5%E5%BD%B1%E5%93%8D%E7%BA%BF%E7%A8%8B%E8%B0%83%E5%BA%A6%E7%9A%84%E6%96%B9%E5%BC%8F%E3%80%82%0A%0A%0A%23%23%23%20**%E5%A4%9A%E7%BA%BF%E7%A8%8B-%E5%85%B1%E4%BA%AB%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F**%0A%0A%60%60%60%0Afrom%20threading%20import%20Thread%0Aimport%20time%0A%0Ag_num%20%3D%20100%0A%0Adef%20work1()%3A%0A%20%20%20%20global%20g_num%0A%20%20%20%20for%20i%20in%20range(3)%3A%0A%20%20%20%20%20%20%20%20g_num%20%2B%3D%201%0A%0A%20%20%20%20print(%22----in%20work1%2C%20g_num%20is%20%25d---%22%25g_num)%0A%0A%0Adef%20work2()%3A%0A%20%20%20%20global%20g_num%0A%20%20%20%20print(%22----in%20work2%2C%20g_num%20is%20%25d---%22%25g_num)%0A%0A%0Aprint(%22---%E7%BA%BF%E7%A8%8B%E5%88%9B%E5%BB%BA%E4%B9%8B%E5%89%8Dg_num%20is%20%25d---%22%25g_num)%0A%0At1%20%3D%20Thread(target%3Dwork1)%0At1.start()%0A%0A%23%E5%BB%B6%E6%97%B6%E4%B8%80%E4%BC%9A%EF%BC%8C%E4%BF%9D%E8%AF%81t1%E7%BA%BF%E7%A8%8B%E4%B8%AD%E7%9A%84%E4%BA%8B%E6%83%85%E5%81%9A%E5%AE%8C%0Atime.sleep(1)%0A%0At2%20%3D%20Thread(target%3Dwork2)%0At2.start()%0A%60%60%60%0A%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C%3A%0A%60%60%60%0A---%E7%BA%BF%E7%A8%8B%E5%88%9B%E5%BB%BA%E4%B9%8B%E5%89%8Dg_num%20is%20100---%0A----in%20work1%2C%20g_num%20is%20103---%0A----in%20work2%2C%20g_num%20is%20103---%0A%60%60%60%0A%0A%23%23%23%20**%E5%85%83%E7%BB%84%E5%BD%93%E5%81%9A%E5%AE%9E%E5%8F%82%E4%BC%A0%E9%80%92%E5%88%B0%E7%BA%BF%E7%A8%8B%E4%B8%AD**%0A%0A%60%60%60%0Afrom%20threading%20import%20Thread%0Aimport%20time%0A%0Adef%20work1(nums)%3A%0A%20%20%20%20nums.append(44)%0A%20%20%20%20print(%22----in%20work1---%22%2Cnums)%0A%0A%0Adef%20work2(nums)%3A%0A%20%20%20%20%23%E5%BB%B6%E6%97%B6%E4%B8%80%E4%BC%9A%EF%BC%8C%E4%BF%9D%E8%AF%81t1%E7%BA%BF%E7%A8%8B%E4%B8%AD%E7%9A%84%E4%BA%8B%E6%83%85%E5%81%9A%E5%AE%8C%0A%20%20%20%20time.sleep(1)%0A%20%20%20%20print(%22----in%20work2---%22%2Cnums)%0A%0Ag_nums%20%3D%20%5B11%2C22%2C33%5D%0A%0At1%20%3D%20Thread(target%3Dwork1%2C%20args%3D(g_nums%2C))%0At1.start()%0A%0At2%20%3D%20Thread(target%3Dwork2%2C%20args%3D(g_nums%2C))%0At2.start()%0A%60%60%60%0A%0A%0A%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C%3A%0A%60%60%60%0A----in%20work1---%20%5B11%2C%2022%2C%2033%2C%2044%5D%0A----in%20work2---%20%5B11%2C%2022%2C%2033%2C%2044%5D%0A%60%60%60%0A**%E6%80%BB%E7%BB%93%EF%BC%9A**%0A%0A-%20%E5%9C%A8%E4%B8%80%E4%B8%AA%E8%BF%9B%E7%A8%8B%E5%86%85%E7%9A%84%E6%89%80%E6%9C%89%E7%BA%BF%E7%A8%8B%E5%85%B1%E4%BA%AB%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%EF%BC%8C%E5%BE%88%E6%96%B9%E4%BE%BF%E5%9C%A8%E5%A4%9A%E4%B8%AA%E7%BA%BF%E7%A8%8B%E9%97%B4%E5%85%B1%E4%BA%AB%E6%95%B0%E6%8D%AE%0A-%20%E7%BC%BA%E7%82%B9%E5%B0%B1%E6%98%AF%EF%BC%8C%E7%BA%BF%E7%A8%8B%E6%98%AF%E5%AF%B9%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E9%9A%8F%E6%84%8F%E9%81%82%E6%94%B9%E5%8F%AF%E8%83%BD%E9%80%A0%E6%88%90%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B9%8B%E9%97%B4%E5%AF%B9%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E7%9A%84%E6%B7%B7%E4%B9%B1%EF%BC%88%E5%8D%B3%E7%BA%BF%E7%A8%8B%E9%9D%9E%E5%AE%89%E5%85%A8%EF%BC%89%0A%0A%23%23%23%20**%E4%BA%92%E6%96%A5%E9%94%81(%E9%87%8D%E7%82%B9)**%0A%0A%E5%BD%93%E5%A4%9A%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%87%A0%E4%B9%8E%E5%90%8C%E6%97%B6%E4%BF%AE%E6%94%B9%E6%9F%90%E4%B8%80%E4%B8%AA%E5%85%B1%E4%BA%AB%E6%95%B0%E6%8D%AE%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E9%9C%80%E8%A6%81%E8%BF%9B%E8%A1%8C%E5%90%8C%E6%AD%A5%E6%8E%A7%E5%88%B6%0A%0A%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5%E8%83%BD%E5%A4%9F%E4%BF%9D%E8%AF%81%E5%A4%9A%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E8%AE%BF%E9%97%AE%E7%AB%9E%E4%BA%89%E8%B5%84%E6%BA%90%EF%BC%8C%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84%E5%90%8C%E6%AD%A5%E6%9C%BA%E5%88%B6%E6%98%AF%E5%BC%95%E5%85%A5%E4%BA%92%E6%96%A5%E9%94%81%E3%80%82%0A%0A%E4%BA%92%E6%96%A5%E9%94%81%E4%B8%BA%E8%B5%84%E6%BA%90%E5%BC%95%E5%85%A5%E4%B8%80%E4%B8%AA%E7%8A%B6%E6%80%81%EF%BC%9A%E9%94%81%E5%AE%9A%2F%E9%9D%9E%E9%94%81%E5%AE%9A%0A%0A%E6%9F%90%E4%B8%AA%E7%BA%BF%E7%A8%8B%E8%A6%81%E6%9B%B4%E6%94%B9%E5%85%B1%E4%BA%AB%E6%95%B0%E6%8D%AE%E6%97%B6%EF%BC%8C%E5%85%88%E5%B0%86%E5%85%B6%E9%94%81%E5%AE%9A%EF%BC%8C%E6%AD%A4%E6%97%B6%E8%B5%84%E6%BA%90%E7%9A%84%E7%8A%B6%E6%80%81%E4%B8%BA%E2%80%9C%E9%94%81%E5%AE%9A%E2%80%9D%EF%BC%8C%E5%85%B6%E4%BB%96%E7%BA%BF%E7%A8%8B%E4%B8%8D%E8%83%BD%E6%9B%B4%E6%94%B9%EF%BC%9B%E7%9B%B4%E5%88%B0%E8%AF%A5%E7%BA%BF%E7%A8%8B%E9%87%8A%E6%94%BE%E8%B5%84%E6%BA%90%EF%BC%8C%E5%B0%86%E8%B5%84%E6%BA%90%E7%9A%84%E7%8A%B6%E6%80%81%E5%8F%98%E6%88%90%E2%80%9C%E9%9D%9E%E9%94%81%E5%AE%9A%E2%80%9D%EF%BC%8C%E5%85%B6%E4%BB%96%E7%9A%84%E7%BA%BF%E7%A8%8B%E6%89%8D%E8%83%BD%E5%86%8D%E6%AC%A1%E9%94%81%E5%AE%9A%E8%AF%A5%E8%B5%84%E6%BA%90%E3%80%82%E4%BA%92%E6%96%A5%E9%94%81%E4%BF%9D%E8%AF%81%E4%BA%86%E6%AF%8F%E6%AC%A1%E5%8F%AA%E6%9C%89%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E8%BF%9B%E8%A1%8C%E5%86%99%E5%85%A5%E6%93%8D%E4%BD%9C%EF%BC%8C%E4%BB%8E%E8%80%8C%E4%BF%9D%E8%AF%81%E4%BA%86%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%83%85%E5%86%B5%E4%B8%8B%E6%95%B0%E6%8D%AE%E7%9A%84%E6%AD%A3%E7%A1%AE%E6%80%A7%E3%80%82%0A%0Athreading%E6%A8%A1%E5%9D%97%E4%B8%AD%E5%AE%9A%E4%B9%89%E4%BA%86Lock%E7%B1%BB%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%96%B9%E4%BE%BF%E7%9A%84%E5%A4%84%E7%90%86%E9%94%81%E5%AE%9A%EF%BC%9A%0A%60%60%60%0A%23%20%E5%88%9B%E5%BB%BA%E9%94%81%0Amutex%20%3D%20threading.Lock()%0A%0A%23%20%E9%94%81%E5%AE%9A%0Amutex.acquire()%0A%0A%23%20%E9%87%8A%E6%94%BE%0Amutex.release()%0A%60%60%60%0A%0A**%E6%B3%A8%E6%84%8F%EF%BC%9A**%0A-%20%E5%A6%82%E6%9E%9C%E8%BF%99%E4%B8%AA%E9%94%81%E4%B9%8B%E5%89%8D%E6%98%AF%E6%B2%A1%E6%9C%89%E4%B8%8A%E9%94%81%E7%9A%84%EF%BC%8C%E9%82%A3%E4%B9%88acquire%E4%B8%8D%E4%BC%9A%E5%A0%B5%E5%A1%9E%0A-%20%E5%A6%82%E6%9E%9C%E5%9C%A8%E8%B0%83%E7%94%A8acquire%E5%AF%B9%E8%BF%99%E4%B8%AA%E9%94%81%E4%B8%8A%E9%94%81%E4%B9%8B%E5%89%8D%20%E5%AE%83%E5%B7%B2%E7%BB%8F%E8%A2%AB%20%E5%85%B6%E4%BB%96%E7%BA%BF%E7%A8%8B%E4%B8%8A%E4%BA%86%E9%94%81%EF%BC%8C%E9%82%A3%E4%B9%88%E6%AD%A4%E6%97%B6acquire%E4%BC%9A%E5%A0%B5%E5%A1%9E%EF%BC%8C%E7%9B%B4%E5%88%B0%E8%BF%99%E4%B8%AA%E9%94%81%E8%A2%AB%E8%A7%A3%E9%94%81%E4%B8%BA%E6%AD%A2%0A%0A**%E4%BD%BF%E7%94%A8%E4%BA%92%E6%96%A5%E9%94%81%E5%AE%8C%E6%88%902%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%AF%B9%E5%90%8C%E4%B8%80%E4%B8%AA%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%90%84%E5%8A%A0100%E4%B8%87%E6%AC%A1%E7%9A%84%E6%93%8D%E4%BD%9C**%0A%0A%60%60%60%0Aimport%20threading%0Aimport%20time%0A%0Ag_num%20%3D%200%0A%0Adef%20test1(num)%3A%0A%20%20%20%20global%20g_num%0A%20%20%20%20for%20i%20in%20range(num)%3A%0A%20%20%20%20%20%20%20%20mutex.acquire()%20%20%23%20%E4%B8%8A%E9%94%81%0A%20%20%20%20%20%20%20%20g_num%20%2B%3D%201%0A%20%20%20%20%20%20%20%20mutex.release()%20%20%23%20%E8%A7%A3%E9%94%81%0A%0A%20%20%20%20print(%22---test1---g_num%3D%25d%22%25g_num)%0A%0Adef%20test2(num)%3A%0A%20%20%20%20global%20g_num%0A%20%20%20%20for%20i%20in%20range(num)%3A%0A%20%20%20%20%20%20%20%20mutex.acquire()%20%20%23%20%E4%B8%8A%E9%94%81%0A%20%20%20%20%20%20%20%20g_num%20%2B%3D%201%0A%20%20%20%20%20%20%20%20mutex.release()%20%20%23%20%E8%A7%A3%E9%94%81%0A%0A%20%20%20%20print(%22---test2---g_num%3D%25d%22%25g_num)%0A%0A%23%20%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E4%BA%92%E6%96%A5%E9%94%81%0A%23%20%E9%BB%98%E8%AE%A4%E6%98%AF%E6%9C%AA%E4%B8%8A%E9%94%81%E7%9A%84%E7%8A%B6%E6%80%81%0Amutex%20%3D%20threading.Lock()%0A%0A%23%20%E5%88%9B%E5%BB%BA2%E4%B8%AA%E7%BA%BF%E7%A8%8B%EF%BC%8C%E8%AE%A9%E4%BB%96%E4%BB%AC%E5%90%84%E8%87%AA%E5%AF%B9g_num%E5%8A%A01000000%E6%AC%A1%0Ap1%20%3D%20threading.Thread(target%3Dtest1%2C%20args%3D(1000000%2C))%0Ap1.start()%0A%0Ap2%20%3D%20threading.Thread(target%3Dtest2%2C%20args%3D(1000000%2C))%0Ap2.start()%0A%0Ap1.join()%0Ap2.join()%0A%0Aprint(%222%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%AF%B9%E5%90%8C%E4%B8%80%E4%B8%AA%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E6%93%8D%E4%BD%9C%E4%B9%8B%E5%90%8E%E7%9A%84%E6%9C%80%E7%BB%88%E7%BB%93%E6%9E%9C%E6%98%AF%3A%25s%22%20%25%20g_num)%0A%60%60%60%0A%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C%EF%BC%9A%0A%60%60%60%0A2%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%AF%B9%E5%90%8C%E4%B8%80%E4%B8%AA%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E6%93%8D%E4%BD%9C%E4%B9%8B%E5%90%8E%E7%9A%84%E6%9C%80%E7%BB%88%E7%BB%93%E6%9E%9C%E6%98%AF%3A2000000%0A%60%60%60%0A%0A%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E6%9C%80%E5%90%8E%E7%9A%84%E7%BB%93%E6%9E%9C%EF%BC%8C%E5%8A%A0%E5%85%A5%E4%BA%92%E6%96%A5%E9%94%81%E5%90%8E%EF%BC%8C%E5%85%B6%E7%BB%93%E6%9E%9C%E4%B8%8E%E9%A2%84%E6%9C%9F%E7%9B%B8%E7%AC%A6%E3%80%82%0A%0A**%E4%B8%8A%E9%94%81%E8%A7%A3%E9%94%81%E8%BF%87%E7%A8%8B**%0A%E5%BD%93%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E8%B0%83%E7%94%A8%E9%94%81%E7%9A%84acquire()%E6%96%B9%E6%B3%95%E8%8E%B7%E5%BE%97%E9%94%81%E6%97%B6%EF%BC%8C%E9%94%81%E5%B0%B1%E8%BF%9B%E5%85%A5%E2%80%9Clocked%E2%80%9D%E7%8A%B6%E6%80%81%E3%80%82%0A%0A%E6%AF%8F%E6%AC%A1%E5%8F%AA%E6%9C%89%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%8F%AF%E4%BB%A5%E8%8E%B7%E5%BE%97%E9%94%81%E3%80%82%E5%A6%82%E6%9E%9C%E6%AD%A4%E6%97%B6%E5%8F%A6%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E8%AF%95%E5%9B%BE%E8%8E%B7%E5%BE%97%E8%BF%99%E4%B8%AA%E9%94%81%EF%BC%8C%E8%AF%A5%E7%BA%BF%E7%A8%8B%E5%B0%B1%E4%BC%9A%E5%8F%98%E4%B8%BA%E2%80%9Cblocked%E2%80%9D%E7%8A%B6%E6%80%81%EF%BC%8C%E7%A7%B0%E4%B8%BA%E2%80%9C%E9%98%BB%E5%A1%9E%E2%80%9D%EF%BC%8C%E7%9B%B4%E5%88%B0%E6%8B%A5%E6%9C%89%E9%94%81%E7%9A%84%E7%BA%BF%E7%A8%8B%E8%B0%83%E7%94%A8%E9%94%81%E7%9A%84release()%E6%96%B9%E6%B3%95%E9%87%8A%E6%94%BE%E9%94%81%E4%B9%8B%E5%90%8E%EF%BC%8C%E9%94%81%E8%BF%9B%E5%85%A5%E2%80%9Cunlocked%E2%80%9D%E7%8A%B6%E6%80%81%E3%80%82%0A%0A%E7%BA%BF%E7%A8%8B%E8%B0%83%E5%BA%A6%E7%A8%8B%E5%BA%8F%E4%BB%8E%E5%A4%84%E4%BA%8E%E5%90%8C%E6%AD%A5%E9%98%BB%E5%A1%9E%E7%8A%B6%E6%80%81%E7%9A%84%E7%BA%BF%E7%A8%8B%E4%B8%AD%E9%80%89%E6%8B%A9%E4%B8%80%E4%B8%AA%E6%9D%A5%E8%8E%B7%E5%BE%97%E9%94%81%EF%BC%8C%E5%B9%B6%E4%BD%BF%E5%BE%97%E8%AF%A5%E7%BA%BF%E7%A8%8B%E8%BF%9B%E5%85%A5%E8%BF%90%E8%A1%8C%EF%BC%88running%EF%BC%89%E7%8A%B6%E6%80%81%E3%80%82%0A%0A**%E6%80%BB%E7%BB%93**%0A%0A**%E9%94%81%E7%9A%84%E5%A5%BD%E5%A4%84%EF%BC%9A**%0A%0A-%20%E7%A1%AE%E4%BF%9D%E4%BA%86%E6%9F%90%E6%AE%B5%E5%85%B3%E9%94%AE%E4%BB%A3%E7%A0%81%E5%8F%AA%E8%83%BD%E7%94%B1%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E4%BB%8E%E5%A4%B4%E5%88%B0%E5%B0%BE%E5%AE%8C%E6%95%B4%E5%9C%B0%E6%89%A7%E8%A1%8C%0A%0A**%E9%94%81%E7%9A%84%E5%9D%8F%E5%A4%84%EF%BC%9A**%0A%0A-%20%E9%98%BB%E6%AD%A2%E4%BA%86%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%B9%B6%E5%8F%91%E6%89%A7%E8%A1%8C%EF%BC%8C%E5%8C%85%E5%90%AB%E9%94%81%E7%9A%84%E6%9F%90%E6%AE%B5%E4%BB%A3%E7%A0%81%E5%AE%9E%E9%99%85%E4%B8%8A%E5%8F%AA%E8%83%BD%E4%BB%A5%E5%8D%95%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%BC%8F%E6%89%A7%E8%A1%8C%EF%BC%8C%E6%95%88%E7%8E%87%E5%B0%B1%E5%A4%A7%E5%A4%A7%E5%9C%B0%E4%B8%8B%E9%99%8D%E4%BA%86%0A-%20%E7%94%B1%E4%BA%8E%E5%8F%AF%E4%BB%A5%E5%AD%98%E5%9C%A8%E5%A4%9A%E4%B8%AA%E9%94%81%EF%BC%8C%E4%B8%8D%E5%90%8C%E7%9A%84%E7%BA%BF%E7%A8%8B%E6%8C%81%E6%9C%89%E4%B8%8D%E5%90%8C%E7%9A%84%E9%94%81%EF%BC%8C%E5%B9%B6%E8%AF%95%E5%9B%BE%E8%8E%B7%E5%8F%96%E5%AF%B9%E6%96%B9%E6%8C%81%E6%9C%89%E7%9A%84%E9%94%81%E6%97%B6%EF%BC%8C%E5%8F%AF%E8%83%BD%E4%BC%9A%E9%80%A0%E6%88%90%E6%AD%BB%E9%94%81%0A%0A%23%23%23%20**%E6%AD%BB%E9%94%81%E9%97%AE%E9%A2%98**%0A%0A%E5%9C%A8%E7%BA%BF%E7%A8%8B%E9%97%B4%E5%85%B1%E4%BA%AB%E5%A4%9A%E4%B8%AA%E8%B5%84%E6%BA%90%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%B8%A4%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%88%86%E5%88%AB%E5%8D%A0%E6%9C%89%E4%B8%80%E9%83%A8%E5%88%86%E8%B5%84%E6%BA%90%E5%B9%B6%E4%B8%94%E5%90%8C%E6%97%B6%E7%AD%89%E5%BE%85%E5%AF%B9%E6%96%B9%E7%9A%84%E8%B5%84%E6%BA%90%EF%BC%8C%E5%B0%B1%E4%BC%9A%E9%80%A0%E6%88%90%E6%AD%BB%E9%94%81%E3%80%82%0A%0A%E5%B0%BD%E7%AE%A1%E6%AD%BB%E9%94%81%E5%BE%88%E5%B0%91%E5%8F%91%E7%94%9F%EF%BC%8C%E4%BD%86%E4%B8%80%E6%97%A6%E5%8F%91%E7%94%9F%E5%B0%B1%E4%BC%9A%E9%80%A0%E6%88%90%E5%BA%94%E7%94%A8%E7%9A%84%E5%81%9C%E6%AD%A2%E5%93%8D%E5%BA%94%E3%80%82%E4%B8%8B%E9%9D%A2%E7%9C%8B%E4%B8%80%E4%B8%AA%E6%AD%BB%E9%94%81%E7%9A%84%E4%BE%8B%E5%AD%90%0A%60%60%60%0A%23coding%3Dutf-8%0Aimport%20threading%0Aimport%20time%0A%0Aclass%20MyThread1(threading.Thread)%3A%0A%20%20%20%20def%20run(self)%3A%0A%20%20%20%20%20%20%20%20%23%20%E5%AF%B9mutexA%E4%B8%8A%E9%94%81%0A%20%20%20%20%20%20%20%20mutexA.acquire()%0A%0A%20%20%20%20%20%20%20%20%23%20mutexA%E4%B8%8A%E9%94%81%E5%90%8E%EF%BC%8C%E5%BB%B6%E6%97%B61%E7%A7%92%EF%BC%8C%E7%AD%89%E5%BE%85%E5%8F%A6%E5%A4%96%E9%82%A3%E4%B8%AA%E7%BA%BF%E7%A8%8B%20%E6%8A%8AmutexB%E4%B8%8A%E9%94%81%0A%20%20%20%20%20%20%20%20print(self.name%2B'----do1---up----')%0A%20%20%20%20%20%20%20%20time.sleep(1)%0A%0A%20%20%20%20%20%20%20%20%23%20%E6%AD%A4%E6%97%B6%E4%BC%9A%E5%A0%B5%E5%A1%9E%EF%BC%8C%E5%9B%A0%E4%B8%BA%E8%BF%99%E4%B8%AAmutexB%E5%B7%B2%E7%BB%8F%E8%A2%AB%E5%8F%A6%E5%A4%96%E7%9A%84%E7%BA%BF%E7%A8%8B%E6%8A%A2%E5%85%88%E4%B8%8A%E9%94%81%E4%BA%86%0A%20%20%20%20%20%20%20%20mutexB.acquire()%0A%20%20%20%20%20%20%20%20print(self.name%2B'----do1---down----')%0A%20%20%20%20%20%20%20%20mutexB.release()%0A%0A%20%20%20%20%20%20%20%20%23%20%E5%AF%B9mutexA%E8%A7%A3%E9%94%81%0A%20%20%20%20%20%20%20%20mutexA.release()%0A%0Aclass%20MyThread2(threading.Thread)%3A%0A%20%20%20%20def%20run(self)%3A%0A%20%20%20%20%20%20%20%20%23%20%E5%AF%B9mutexB%E4%B8%8A%E9%94%81%0A%20%20%20%20%20%20%20%20mutexB.acquire()%0A%0A%20%20%20%20%20%20%20%20%23%20mutexB%E4%B8%8A%E9%94%81%E5%90%8E%EF%BC%8C%E5%BB%B6%E6%97%B61%E7%A7%92%EF%BC%8C%E7%AD%89%E5%BE%85%E5%8F%A6%E5%A4%96%E9%82%A3%E4%B8%AA%E7%BA%BF%E7%A8%8B%20%E6%8A%8AmutexA%E4%B8%8A%E9%94%81%0A%20%20%20%20%20%20%20%20print(self.name%2B'----do2---up----')%0A%20%20%20%20%20%20%20%20time.sleep(1)%0A%0A%20%20%20%20%20%20%20%20%23%20%E6%AD%A4%E6%97%B6%E4%BC%9A%E5%A0%B5%E5%A1%9E%EF%BC%8C%E5%9B%A0%E4%B8%BA%E8%BF%99%E4%B8%AAmutexA%E5%B7%B2%E7%BB%8F%E8%A2%AB%E5%8F%A6%E5%A4%96%E7%9A%84%E7%BA%BF%E7%A8%8B%E6%8A%A2%E5%85%88%E4%B8%8A%E9%94%81%E4%BA%86%0A%20%20%20%20%20%20%20%20mutexA.acquire()%0A%20%20%20%20%20%20%20%20print(self.name%2B'----do2---down----')%0A%20%20%20%20%20%20%20%20mutexA.release()%0A%0A%20%20%20%20%20%20%20%20%23%20%E5%AF%B9mutexB%E8%A7%A3%E9%94%81%0A%20%20%20%20%20%20%20%20mutexB.release()%0A%0AmutexA%20%3D%20threading.Lock()%0AmutexB%20%3D%20threading.Lock()%0A%0Aif%20__name__%20%3D%3D%20'__main__'%3A%0A%20%20%20%20t1%20%3D%20MyThread1()%0A%20%20%20%20t2%20%3D%20MyThread2()%0A%20%20%20%20t1.start()%0A%20%20%20%20t2.start()%0A%60%60%60%0A%0A--------------------------------------------------------%0A%0A%23%23%23%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%88%AC%E8%99%AB%E6%A1%88%E4%BE%8B%EF%BC%88jobbole%EF%BC%89%0A%0A%0A%23%23%23%23%20**Queue%EF%BC%88%E9%98%9F%E5%88%97%E5%AF%B9%E8%B1%A1%EF%BC%89**%0AQueue%E6%98%AFpython%E4%B8%AD%E7%9A%84%E6%A0%87%E5%87%86%E5%BA%93%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5import%20Queue%E5%BC%95%E7%94%A8%3B%0A%E9%98%9F%E5%88%97%E6%98%AF%E7%BA%BF%E7%A8%8B%E9%97%B4%E6%9C%80%E5%B8%B8%E7%94%A8%E7%9A%84%E4%BA%A4%E6%8D%A2%E6%95%B0%E6%8D%AE%E7%9A%84%E5%BD%A2%E5%BC%8F%0A%0A%23%23%23%23%20**python%E4%B8%8B%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%80%9D%E8%80%83**%0A%E5%AF%B9%E4%BA%8E%E8%B5%84%E6%BA%90%EF%BC%8C%E5%8A%A0%E9%94%81%E6%98%AF%E4%B8%AA%E9%87%8D%E8%A6%81%E7%9A%84%E7%8E%AF%E8%8A%82%E3%80%82%E5%9B%A0%E4%B8%BApython%E5%8E%9F%E7%94%9F%E7%9A%84**list%2Cdict%E7%AD%89%EF%BC%8C%E9%83%BD%E6%98%AFnot%20thread%20safe%E7%9A%84**%E3%80%82%E8%80%8C**Queue%EF%BC%8C%E6%98%AF%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8**%E7%9A%84%EF%BC%8C%E5%9B%A0%E6%AD%A4%E5%9C%A8%E6%BB%A1%E8%B6%B3%E4%BD%BF%E7%94%A8%E6%9D%A1%E4%BB%B6%E4%B8%8B%EF%BC%8C%E5%BB%BA%E8%AE%AE%E4%BD%BF%E7%94%A8%E9%98%9F%E5%88%97%0A%0A-%20%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%9A%20class%20(**FIFO%20%E5%85%88%E8%BF%9B%E5%85%88%E5%87%BA**)%0A%60%60%60%0A%20%20%20%20queue%20%3D%20queue.Queue(maxsize)%20%0A%60%60%60%0A%0A%0A-%20%E5%8C%85%E4%B8%AD%E7%9A%84%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95%3A%0A%60%60%60%0A%20%20%20%20queue.qsize()%20%E8%BF%94%E5%9B%9E%E9%98%9F%E5%88%97%E7%9A%84%E5%A4%A7%E5%B0%8F%0A%0A%20%20%20%20queue.empty()%20%E5%A6%82%E6%9E%9C%E9%98%9F%E5%88%97%E4%B8%BA%E7%A9%BA%EF%BC%8C%E8%BF%94%E5%9B%9ETrue%2C%E5%8F%8D%E4%B9%8BFalse%0A%0A%20%20%20%20queue.full()%20%E5%A6%82%E6%9E%9C%E9%98%9F%E5%88%97%E6%BB%A1%E4%BA%86%EF%BC%8C%E8%BF%94%E5%9B%9ETrue%2C%E5%8F%8D%E4%B9%8BFalse%0A%0A%20%20%20%20queue.full%20%E4%B8%8E%20maxsize%20%E5%A4%A7%E5%B0%8F%E5%AF%B9%E5%BA%94%0A%0A%20%20%20%20queue.get(block%2Ctimeout)%E8%8E%B7%E5%8F%96%E9%98%9F%E5%88%97%EF%BC%8Ctimeout%E7%AD%89%E5%BE%85%E6%97%B6%E9%97%B4%0A%60%60%60%0A3.%20%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E2%80%9C%E9%98%9F%E5%88%97%E2%80%9D%E5%AF%B9%E8%B1%A1%0A%60%60%60%0Aimport%20queue%0A%0Amyqueue%20%3D%20queue.Queue(%20maxsize%20%3D%2010%20)%0A%60%60%60%0A4.%E5%B0%86%E4%B8%80%E4%B8%AA%E5%80%BC%E6%94%BE%E5%85%A5%E9%98%9F%E5%88%97%E4%B8%AD%0A%60%60%60%0Amyqueue.put(10)%0A%60%60%60%0A5.%20%E5%B0%86%E4%B8%80%E4%B8%AA%E5%80%BC%E4%BB%8E%E9%98%9F%E5%88%97%E4%B8%AD%E5%8F%96%E5%87%BA%0A%60%60%60%0Amyqueue.get()%0A%60%60%60%0A%0A%23%23%23%23%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%A4%BA%E6%84%8F%E5%9B%BE(%E5%85%B8%E5%9E%8B%E7%9A%84%E7%94%9F%E6%88%90%E8%80%85%E5%92%8C%E6%B6%88%E8%B4%B9%E8%80%85%E7%9A%84%E6%A8%A1%E5%BC%8F)%EF%BC%9A%0A%0A!%5Bc60a6b17-ff51-4cb2-93c6-f204c82187c4%5D(https%3A%2F%2Fi.loli.net%2F2018%2F10%2F22%2F5bcd5d84ce375.png)%0A%0A%0A%23%23%23%23%20**%E6%A0%B9%E6%8D%AE%E4%B8%8A%E9%9D%A2%E7%9A%84%E5%9B%BE%E8%A7%A3%EF%BC%8C%E4%BD%BF%E7%94%A8%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%88%AC%E5%8F%96jobbole%E7%BD%91%E7%AB%99%E6%95%B0%E6%8D%AE**%0A%60%60%60%0Aimport%20requests%0Aimport%20threading%0Afrom%20lxml%20import%20etree%0Aimport%20queue%0A%0Aclass%20crawlThread(threading.Thread)%3A%0A%20%20%20%20%22%22%22%E8%87%AA%E5%AE%9A%E4%B9%89%E7%88%AC%E5%8F%96%E7%BA%BF%E7%A8%8B%22%22%22%0A%20%20%20%20def%20__init__(self%2CthreadName%2Cpage_queue%2Cdata_queue)%3A%0A%20%20%20%20%20%20%20%20super(crawlThread%2Cself).__init__()%0A%20%20%20%20%20%20%20%20self.threadName%20%3D%20threadName%0A%20%20%20%20%20%20%20%20self.page_queue%20%3D%20page_queue%0A%20%20%20%20%20%20%20%20self.data_queue%20%3D%20data_queue%0A%20%20%20%20%20%20%20%20self.headers%20%3D%20%7B'User-Agent'%3A'Mozilla%2F5.0%20(Macintosh%3B%20Intel%20Mac%20OS%20X%2010.13%3B%20rv%3A60.0)%20Gecko%2F20100101%20Firefox%2F60.0'%2C%7D%0A%0A%20%20%20%20def%20run(self)%3A%0A%20%20%20%20%20%20%20%20%23%20%E8%BF%99%E9%87%8C%E4%BB%8Epage_queue%E8%8E%B7%E5%8F%96%E5%AF%B9%E5%BA%94%E7%9A%84%E9%A1%B5%E7%A0%81%0A%20%20%20%20%20%20%20%20while%20not%20self.page_queue.empty()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23get()%E4%BB%8E%E9%98%9F%E5%88%97%E4%B8%AD%E5%8F%96%E5%80%BC%EF%BC%8C%E5%85%88%E8%BF%9B%E5%85%88%E5%87%BA%0A%20%20%20%20%20%20%20%20%20%20%20%20page%20%3D%20self.page_queue.get()%0A%20%20%20%20%20%20%20%20%20%20%20%20print(page)%0A%20%20%20%20%20%20%20%20%20%20%20%20full_url%20%3D%20'http%3A%2F%2Fblog.jobbole.com%2Fall-posts%2Fpage%2F'%2Bstr(page)%2B'%2F'%0A%20%20%20%20%20%20%20%20%20%20%20%20response%20%3D%20requests.get(full_url%2Cheaders%3Dself.headers)%0A%20%20%20%20%20%20%20%20%20%20%20%20response.encoding%20%3D%20'utf-8'%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20response.status_code%20%3D%3D%20200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%E5%B0%86%E8%8E%B7%E5%8F%96%E5%88%B0%E7%9A%84%E7%BB%93%E6%9E%9C%EF%BC%8C%E5%AD%98%E6%94%BE%E5%9C%A8data_queue%E9%98%9F%E5%88%97%E4%B8%AD%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.data_queue.put(response.text)%0A%20%20%20%20%20%20%20%20%0A%23%20%23%E7%BA%BF%E7%A8%8B%E7%9A%84%E9%87%87%E9%9B%86%E4%BB%BB%E5%8A%A1%0A%23%20def%20crawl_data(page_queue%2Cdata_queue)%3A%0A%23%20%20%20%20%20header%20%3D%20%7B%0A%23%20%20%20%20%20%20%20%20%20'User-Agent'%3A'Mozilla%2F5.0%20(Macintosh%3B%20Intel%20Mac%20OS%20X%2010.13%3B%20rv%3A60.0)%20Gecko%2F20100101%20Firefox%2F60.0'%2C%0A%23%20%20%20%20%20%7D%0A%23%20%20%20%20%20%23%20%E8%BF%99%E9%87%8C%E4%BB%8Epage_queue%E8%8E%B7%E5%8F%96%E5%AF%B9%E5%BA%94%E7%9A%84%E9%A1%B5%E7%A0%81%0A%23%20%20%20%20%20while%20not%20page_queue.empty()%3A%0A%23%20%20%20%20%20%20%20%20%20%23get()%E4%BB%8E%E9%98%9F%E5%88%97%E4%B8%AD%E5%8F%96%E5%80%BC%EF%BC%8C%E5%85%88%E8%BF%9B%E5%85%88%E5%87%BA%0A%23%20%20%20%20%20%20%20%20%20page%20%3D%20page_queue.get()%0A%23%20%20%20%20%20%20%20%20%20print(page)%0A%23%20%20%20%20%20%20%20%20%20full_url%20%3D%20'http%3A%2F%2Fblog.jobbole.com%2Fall-posts%2Fpage%2F'%2Bstr(page)%2B'%2F'%0A%23%20%20%20%20%20%20%20%20%20response%20%3D%20requests.get(full_url%2Cheaders%3Dheader)%0A%23%20%20%20%20%20%20%20%20%20response.encoding%20%3D%20'utf-8'%0A%23%20%20%20%20%20%20%20%20%20if%20response.status_code%20%3D%3D%20200%3A%0A%23%20%20%20%20%20%20%20%20%20%20%20%20%20%23%E5%B0%86%E8%8E%B7%E5%8F%96%E5%88%B0%E7%9A%84%E7%BB%93%E6%9E%9C%EF%BC%8C%E5%AD%98%E6%94%BE%E5%9C%A8data_queue%E9%98%9F%E5%88%97%E4%B8%AD%0A%23%20%20%20%20%20%20%20%20%20%20%20%20%20data_queue.put(response.text)%0A%0A%0A%0Aclass%20parseThread(threading.Thread)%3A%0A%20%20%20%20%22%22%22%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A7%A3%E6%9E%90%E7%BA%BF%E7%A8%8B%22%22%22%0A%20%20%20%20def%20__init__(self%2CthreadName%2Cdata_queue%2Clock)%3A%0A%20%20%20%20%20%20%20%20super(parseThread%2Cself).__init__()%0A%20%20%20%20%20%20%20%20self.threadName%20%3D%20threadName%0A%20%20%20%20%20%20%20%20self.data_queue%20%3D%20data_queue%0A%20%20%20%20%20%20%20%20self.lock%20%3D%20lock%0A%0A%20%20%20%20def%20run(self)%3A%0A%20%20%20%20%20%20%20%20%23%E4%B8%8D%E4%B8%BA%E7%A9%BA%E7%9A%84%E6%97%B6%E5%80%99%E5%8E%BB%E5%8F%96%E5%80%BC%EF%BC%8C%E4%B8%BA%E7%A9%BA%E8%AF%B4%E6%98%8E%E6%B2%A1%E6%9C%89%E8%A7%A3%E6%9E%90%E4%BB%BB%E5%8A%A1%E4%BA%86%0A%20%20%20%20%20%20%20%20while%20not%20self.data_queue.empty()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20html%20%3D%20etree.HTML(self.data_queue.get())%0A%20%20%20%20%20%20%20%20%20%20%20%20articles%20%3D%20html.xpath('%2F%2Fdiv%5B%40class%3D%22post%20floated-thumb%22%5D')%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20item%20in%20articles%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%20%3D%20item.xpath('.%2F%2Fa%5B%40class%3D%22archive-title%22%5D%2Ftext()')%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(title)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%E5%8A%A0%E9%94%81%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.lock.acquire()%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20with%20open('jobbole.txt'%2C'a')%20as%20f%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f.write(title%2B'%5Cn')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%E8%A7%A3%E9%94%81%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.lock.release()%20%0A%0A%23%20def%20parse_data(data_queue)%3A%0A%23%20%20%20%20%20%23%E4%B8%8D%E4%B8%BA%E7%A9%BA%E7%9A%84%E6%97%B6%E5%80%99%E5%8E%BB%E5%8F%96%E5%80%BC%EF%BC%8C%E4%B8%BA%E7%A9%BA%E8%AF%B4%E6%98%8E%E6%B2%A1%E6%9C%89%E8%A7%A3%E6%9E%90%E4%BB%BB%E5%8A%A1%E4%BA%86%0A%23%20%20%20%20%20while%20not%20data_queue.empty()%3A%0A%23%20%20%20%20%20%20%20%20%20html%20%3D%20etree.HTML(data_queue.get())%0A%23%20%20%20%20%20%20%20%20%20articles%20%3D%20html.xpath('%2F%2Fdiv%5B%40class%3D%22post%20floated-thumb%22%5D')%0A%23%20%20%20%20%20%20%20%20%20for%20item%20in%20articles%3A%0A%23%20%20%20%20%20%20%20%20%20%20%20%20%20title%20%3D%20item.xpath('.%2F%2Fa%5B%40class%3D%22archive-title%22%5D%2Ftext()')%5B0%5D%0A%23%20%20%20%20%20%20%20%20%20%20%20%20%20print(title)%0A%0Adef%20spider()%3A%0A%20%20%20%20%23%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E4%BB%BB%E5%8A%A1%E9%98%9F%E5%88%97%EF%BC%9A%E9%87%8C%E9%9D%A2%E7%9A%84%E5%8F%82%E6%95%B0maxsize%E8%A1%A8%E7%A4%BA%E6%9C%80%E5%A4%A7%E7%9A%84%E5%AD%98%E5%82%A8%E9%87%8F%0A%20%20%20%20page_queue%20%3D%20queue.Queue(40)%0A%20%20%20%20%23http%3A%2F%2Fblog.jobbole.com%2Fall-posts%2Fpage%2F2%2F%20%20(2%E8%A1%A8%E7%A4%BA%E9%A1%B5%E7%A0%81)%0A%20%20%20%20for%20i%20in%20range(1%2C30)%3A%0A%20%20%20%20%20%20%20%20page_queue.put(i)%0A%0A%20%20%20%20%23%E5%B0%86%E8%A7%A3%E6%9E%90%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE%E6%94%BE%E5%9C%A8%E8%BF%99%E4%B8%AA%E9%98%9F%E5%88%97%E4%B8%AD%EF%BC%8C%E4%BE%9B%E5%90%8E%E5%90%8E%E9%9D%A2%E7%9A%84%E8%A7%A3%E6%9E%90%E7%BA%BF%E7%A8%8B%E5%8E%BB%E5%81%9A%E8%A7%A3%E6%9E%90%0A%20%20%20%20data_queue%20%3D%20queue.Queue()%0A%0A%20%20%20%20%23%E5%88%9B%E5%BB%BA%E7%BA%BF%E7%A8%8B%E5%8F%96%E4%B8%8B%E8%BD%BD%E4%BB%BB%E5%8A%A1%0A%20%20%20%20lock%20%3D%20threading.Lock()%0A%20%20%20%20crawlThreadName%20%3D%20%5B'crawl1%E5%8F%B7'%2C'crawl2%E5%8F%B7'%2C'crawl3%E5%8F%B7'%2C'crawl4%E5%8F%B7'%5D%0A%20%20%20%20thread_list%20%3D%20%5B%5D%0A%20%20%20%20for%20threadName%20in%20crawlThreadName%3A%0A%20%20%20%20%20%20%20%20%23%20thread%20%3D%20threading.Thread(target%3Dcrawl_data%2Cname%3DthreadName%2Cargs%3D(page_queue%2Cdata_queue))%0A%20%20%20%20%20%20%20%20thread%20%3D%20crawlThread(threadName%2Cpage_queue%2Cdata_queue)%0A%20%20%20%20%20%20%20%20thread.start()%0A%20%20%20%20%20%20%20%20thread_list.append(thread)%0A%20%20%20%20%20%20%20%20%23%20thread.join()%20%E4%B8%8D%E8%83%BD%E7%9B%B4%E6%8E%A5%E5%86%99%E5%9C%A8%E8%BF%99%E9%87%8C%0A%0A%20%20%20%20for%20thread%20in%20thread_list%3A%0A%20%20%20%20%20%20%20%20thread.join()%0A%0A%20%20%20%20%23%E5%88%9B%E5%BB%BA%E8%A7%A3%E6%9E%90%E7%BA%BF%E7%A8%8B%EF%BC%9A%0A%20%20%20%20parseThreadName%20%3D%20%5B'parse1%E5%8F%B7'%2C'parse2%E5%8F%B7'%2C'parse3%E5%8F%B7'%2C'parse4%E5%8F%B7'%5D%0A%20%20%20%20parseThread_list%20%3D%20%5B%5D%0A%20%20%20%20for%20threadName%20in%20parseThreadName%3A%0A%20%20%20%20%20%20%20%20%23%20thread%20%3D%20threading.Thread(target%3Dparse_data%2Cname%3DthreadName%2Cargs%3D(data_queue%2C))%0A%20%20%20%20%20%20%20%20thread%20%3D%20parseThread(threadName%2Cdata_queue%2Clock)%0A%20%20%20%20%20%20%20%20thread.start()%0A%20%20%20%20%20%20%20%20parseThread_list.append(thread)%0A%20%20%20%20%0A%20%20%20%20for%20thread%20in%20parseThread_list%3A%0A%20%20%20%20%20%20%20%20thread.join()%0A%20%20%20%20%0A%20%20%20%20%23%E6%89%93%E5%8D%B0%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%90%8D%E7%A7%B0%0A%20%20%20%20print(threading.current_thread().name)%0A%20%20%20%20%0A%0Aif%20__name__%20%3D%3D%20'__main__'%3A%0A%20%20%20%20spider()%0A%60%60%60%0A%0A--------------------------------------------------------%0A%0A%23%23%23%20%E7%BA%BF%E7%A8%8B%E6%B1%A0%0A%0A%0A%23%23%23%20**%E4%BD%BF%E7%94%A8python3.2%E4%B9%8B%E5%90%8E%E4%B8%BA%E6%88%91%E4%BB%AC%E5%B0%81%E8%A3%85%E7%9A%84%E7%BA%BF%E7%A8%8B%E6%B1%A0**%0A%0A%23%23%23%23%20**(%E6%A1%88%E4%BE%8B%E4%B8%80)%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E6%A0%B7%E4%BE%8B**%0A%0A**%E5%AF%BC%E5%85%A5%E6%A8%A1%E5%9D%97%E5%8C%85**%0A%60%60%60%0Afrom%20concurrent.futures%20import%20ThreadPoolExecutor%0A%60%60%60%0A%0A**%E7%BA%BF%E7%A8%8B%E6%B1%A0%E4%B8%AD%E7%9A%84%E7%BA%BF%E7%A8%8B%E9%9C%80%E8%A6%81%E6%89%A7%E8%A1%8C%E7%9A%84%E4%BB%BB%E5%8A%A1**%0A%60%60%60%0Adef%20get_page_data(page)%3A%0A%20%20%20%20%22%22%22%0A%20%20%20%20%E7%BA%BF%E7%A8%8B%E9%9C%80%E8%A6%81%E6%89%A7%E8%A1%8C%E7%9A%84%E4%BB%BB%E5%8A%A1%0A%20%20%20%20%3Aparam%20url%3A%0A%20%20%20%20%3Areturn%3A%0A%20%20%20%20%22%22%22%0A%20%20%20%20print(page)%0A%0A%20%20%20%20return%20'done%E4%B8%8B%E8%BD%BD%E5%AE%8C%E6%88%90'%0A%60%60%60%0A%0A**%E4%BB%BB%E5%8A%A1%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%AF%95%E4%B9%8B%E5%90%8E%E7%9A%84%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0%EF%BC%8C%E5%8F%AF%E4%BB%A5%E8%8E%B7%E5%8F%96%E5%88%B0%E7%8E%B0%E5%9C%BA%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%AF%95%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC**%0A%60%60%60%0Adef%20done(future)%3A%0A%20%20%20%20print(future.result())%0A%60%60%60%0A%0A**%E5%88%9B%E5%BB%BA%E7%BA%BF%E7%A8%8B%E6%B1%A0%EF%BC%8C%E5%B9%B6%E5%BE%80%E7%BA%BF%E7%A8%8B%E6%B1%A0%E4%B8%AD%E6%B7%BB%E5%8A%A0%E4%BB%BB%E5%8A%A1**%0A%60%60%60%0A%23%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E6%B1%A0%0Apool%20%3D%20ThreadPoolExecutor(10)%0A%23%E5%A6%82%E4%BD%95%E6%8F%90%E4%BA%A4%E4%BB%BB%E5%8A%A1%E7%BB%99%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%91%A2%EF%BC%9F%0A%0A%23%E7%BD%91%E7%BA%BF%E7%A8%8B%E6%B1%A0%E4%B8%AD%E6%B7%BB%E5%8A%A0%E4%BB%BB%E5%8A%A1%0Afor%20pagenum%20in%20range(50)%3A%0A%20%20%20%20%23submit%3A%20%E8%A1%A8%E7%A4%BA%E5%B0%86%E6%88%91%E4%BB%AC%E9%9C%80%E8%A6%81%E6%89%A7%E8%A1%8C%E7%9A%84%E4%BB%BB%E5%8A%A1%E7%BB%99%E8%BF%99%E4%B8%AA%E7%BA%BF%E7%A8%8B%E6%B1%A0%EF%BC%8C%0A%20%20%20%20handler%20%3D%20pool.submit(get_page_data%2Cpagenum)%0A%20%20%20%20%23%E7%BB%99%E7%BA%BF%E7%A8%8B%E6%B1%A0%E8%AE%BE%E7%BD%AE%E4%BB%BB%E5%8A%A1%E4%B9%8B%E5%90%8E%EF%BC%8C%E5%8F%AF%E4%BB%A5%E8%AE%BE%E7%BD%AE%E4%B8%80%E4%B8%AA%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0%EF%BC%8C%0A%20%20%20%20%23%E4%BD%9C%E7%94%A8%E6%98%AF%EF%BC%9A%E5%BD%93%E6%88%91%E4%BB%AC%E6%9F%90%E4%B8%AA%E4%BB%BB%E5%8A%A1%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%AF%95%E4%B9%8B%E5%90%8E%EF%BC%8C%E5%B0%B1%E4%BC%9A%E5%9B%9E%E8%B0%83%E4%BD%A0%E8%AE%BE%E7%BD%AE%E7%9A%84%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0%0A%20%20%20%20handler.add_done_callback(done)%0Apool.shutdown(wait%3DTrue)%0A%60%60%60%0A%0A--------------------------------------------------------%0A%0A%0A%23%23%23%23%20%E8%AF%BE%E5%90%8E%E4%BD%9C%E4%B8%9A%EF%BC%9A%0A%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E7%B1%BB%2C%E5%8F%AF%E4%BB%A5%E8%AE%BE%E7%BD%AE%E4%BB%BB%E6%84%8F%E4%BA%AC%E4%B8%9C%E5%95%86%E5%93%81url%E5%9C%B0%E5%9D%80%EF%BC%8C%E8%8E%B7%E5%8F%96%E8%AF%A5%E5%95%86%E5%93%81%E7%9A%84%E5%85%A8%E9%83%A8%E8%AF%84%E8%AE%BA%E4%BF%A1%E6%81%AF%EF%BC%8C%E5%B0%86%E8%AF%84%E8%AE%BA%E4%BF%A1%E6%81%AF%E6%95%B0%E6%8D%AE%E5%88%86%E5%88%AB%E4%BF%9D%E5%AD%98%E8%87%B3csv%E6%96%87%E4%BB%B6%E5%92%8Cmysql%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8C%E8%A6%81%E6%B1%82%E4%BD%BF%E7%94%A8%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%9D%A5%E5%AE%8C%E6%88%90%0A%0A%0A%23%23%23%23%20%E6%89%A9%E5%B1%95%E4%BD%9C%E4%B8%9A%EF%BC%9A%0A%0A%E4%BD%BF%E7%94%A8%E7%BA%BF%E7%A8%8B%E6%B1%A0%E8%8E%B7%E5%8F%96%E8%B5%B7%E7%82%B9%E7%9A%84%E5%B0%8F%E8%AF%B4%E7%BD%91%E5%B0%8F%E8%AF%B4%E5%92%8C%E7%AB%A0%E8%8A%82%E6%95%B0%E6%8D%AE**%0A%60%60%60%0A%0A%23%201.%E6%80%9D%E8%B7%AF%EF%BC%8C%E9%A6%96%E5%85%88%E8%8E%B7%E5%8F%96%E5%88%86%E7%B1%BB%E7%9A%84url%E5%9C%B0%E5%9D%80%0A%23%202.%E6%A0%B9%E6%8D%AE%E5%88%86%E7%B1%BB%E7%9A%84url%E5%9C%B0%E5%9D%80%E8%8E%B7%E5%8F%96%E5%B0%8F%E8%AF%B4%E5%88%97%E8%A1%A8%0A%23%203.%E6%A0%B9%E6%8D%AE%E5%B0%8F%E8%AF%B4%E5%88%97%E8%A1%A8%EF%BC%8C%E6%8B%BC%E6%8E%A5%E7%AB%A0%E8%8A%82%E5%88%97%E8%A1%A8url%E5%9C%B0%E5%9D%80%0A%23%204.%E6%A0%B9%E6%8D%AE%E7%AB%A0%E8%8A%82%E5%88%97%E8%A1%A8url%E5%9C%B0%E5%9D%80%EF%BC%8C%E8%8E%B7%E5%8F%96%E7%AB%A0%E8%8A%82%E5%88%97%E8%A1%A8%0A%23%205.%E8%8E%B7%E5%8F%96%E7%AB%A0%E8%8A%82%E5%88%97%E8%A1%A8%2C%E9%81%8D%E5%8E%86%E5%BE%97%E5%88%B0%E6%AF%8F%E4%B8%80%E7%AB%A0%E8%8A%82%E7%9A%84url%E5%9C%B0%E5%9D%80%0A%23%206.%E6%A0%B9%E6%8D%AE%E7%AB%A0%E8%8A%82%E7%9A%84url%E5%9C%B0%E5%9D%80%2C%E5%8F%91%E8%B5%B7%E8%AF%B7%E6%B1%82%E8%8E%B7%E5%8F%96%E5%93%8D%E5%BA%94%2C%E8%A7%A3%E6%9E%90%EF%BC%8C%E5%BE%97%E5%88%B0%E6%AF%8F%E4%B8%80%E7%AB%A0%E8%8A%82%E7%9A%84%E6%95%B0%E6%8D%AE</center></div></body></html>