<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.0.5 (458014)"/><meta name="author" content="李居豪"/><meta name="created" content="2019-05-23 08:19:04 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2019-05-29 02:11:50 +0000"/><meta name="content-class" content="yinxiang.markdown"/><title>6.0 Requests的使用</title></head><body><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">Requests的使用</h3>
<h5 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 16px; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">Requests: 让 HTTP 服务人类</strong></h5>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">虽然Python的标准库中 <strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">urllib</strong> 模块已经包含了平常我们使用的大多数功能，但是它的 API 使用起来让人感觉不太好，而 Requests 自称 "HTTP for Humans"，说明使用更简洁方便。</p>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">requests 的底层实现其实就是 urllib</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">Requests的文档非常完备，中文文档也相当不错。Requests能完全满足当前网络的需求，支持Python 2.6--3.5，而且能在PyPy下完美运行。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">开源地址：https://github.com/kennethreitz/requests</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">中文文档 API： http://docs.python-requests.org/zh_CN/latest/index.html</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">安装方式</strong></h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">利用 pip 安装 或者利用 easy_install 都可以完成安装：</p>
<blockquote style="line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;">
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333; margin-top: 0; margin-bottom: 0;">pip3 install requests</p>
</blockquote>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">基本GET请求</strong></h3>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">1. 最基本的GET请求可以直接用get方法</strong></h4>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">response = requests.get("http://www.baidu.com/")

# 也可以这么写
# response = requests.request(
    "get", 
    "http://www.baidu.com/"
)
</code></pre>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">response的常用方法：</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">response.text  返回解码后的字符串</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">respones.content  以字节形式（二进制）返回。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">response.status_code　 响应状态码</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">response.request.headers　 请求的请求头</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">response.headers　 响应头</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">response.encoding = 'utf-8'   可以设置编码类型</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">response.encoding                        获取当前的编码</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">response.json()                           内置的JSON解码器，以json形式返回,前提返回的内容确保是json格式的，不然解析出错会抛异常</li>
</ul>
</li>
</ul>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">2. 添加 headers 和 params查询参数</strong></h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">如果想添加 headers，可以传入headers参数来增加请求头中的headers信息。如果要将参数放在url中传递，可以利用 params 参数。</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">import requests

kw = {'wd':'长城'}

headers = {
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36"
}

# params 接收一个字典或者字符串的查询参数，
# 字典类型自动转换为url编码，不需要urlencode()
response = requests.get(
    "http://www.baidu.com/s?",
    params = kw, 
    headers = headers
)

# 查看响应内容，response.text 返回的是Unicode格式的数据
print (response.text)

</code></pre>
<hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">动手使用Requests获取http://www.sina.com的页面源码观察结果</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">注意有时候我们直接使用response.text会出现乱码，产生问题的原因分析</strong></p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">当收到一个响应时，Requests 会猜测响应的编码方式，用于在你调用response.text 方法时对响应进行解码。Requests 首先在 HTTP 头部检测是否存在指定的编码方式，如果不存在，则会使用<br/>
chardet.detect来尝试猜测编码方式（存在误差）</p>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">故更推荐使用response.content.deocde()</p>
</li>
</ul>
<hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">基本POST请求（data参数）</strong></h3>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">1. 最基本post方法</strong></h4>
<blockquote style="line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;">
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333; margin-top: 0; margin-bottom: 0;">response = requests.post(url=url, data = data)</p>
</blockquote>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">url:post请求的目标url</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">data:post请求的表单数据</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">2. 传入data数据</strong><br/>
对于 POST 请求来说，我们一般需要为它增加一些参数。那么最基本的传参方法可以利用 data 这个参数。</p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">获取世纪佳缘相亲美女信息</h4>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">import requests

form_data = {
    'sex': 'f',
    'key': '',
    'stc': '1:11,2:20.28,23:1',
    'sn': 'default',
    'sv': '1',
    'p': '1',
    'f': 'search',
    'listStyle': 'bigPhoto',
    'pri_uid':'0',
    'jsversion': 'v5',
}

header = {
    'Referer': 'http://search.jiayuan.com/v2/index.php?sex=f&amp;stc=1:11,2:20.28,23:1&amp;f=search',
    'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36',
}

url = 'http://search.jiayuan.com/v2/search_v2.php'

response = requests.post(url,headers=header,data=form_data)

print(response.text)

# 如果是json文件可以直接显示
# print (response.json())
</code></pre>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">post请求上传文件</strong></h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">如果我们想post一个文件怎么办呢？这个时候就需要用到files参数了：</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">url = 'https://httpbin.org/post'
files = {'file': open('image.png', 'rb')}
response = requests.post(url, files=files)
print(response.text)
</code></pre>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">web客户端验证</strong></h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">如果是Web客户端验证，需要添加 auth = (账户名, 密码)</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">import requests

auth=('test', '123456')

response = requests.get(
    'http://192.168.199.107', 
    auth = auth
)

print (response.text)
</code></pre>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">设置代理（proxies参数）</strong></h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">如果需要使用代理，你可以通过为任意请求方法提供 proxies 参数来配置单个请求：</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">import requests

# 根据协议类型，选择不同的代理
proxies = {
    "http": "http://12.34.56.79:9527",
    "https": "http://12.34.56.79:9527",
}

response = requests.get(
    "http://www.baidu.com", 
    proxies = proxies
)
print(response.text)
</code></pre>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">私密代理验证（特定格式） 和 Web客户端验证（auth 参数）</strong></p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">私密代理</strong></p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">import requests

# 如果代理需要使用HTTP Basic Auth，可以使用下面这种格式：
proxy = { 
    "http": "name:pwd@61.158.163.130:16816" 
}

response = requests.get(
    "http://www.baidu.com",
     proxies = proxy
)

print (response.text)
</code></pre>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">Cookies</strong></h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">如果一个响应中包含了cookie，那么我们可以利用 cookies参数拿到：</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">import requests

response = requests.get("https://www.kuaidaili.com/login/")

# 返回CookieJar对象:
cookiejar = response.cookies

# 将CookieJar转为字典：
cookiedict = requests.utils.dict_from_cookiejar(
    cookiejar
)

print (cookiejar)

print (cookiedict)
</code></pre>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">结果如下：<br/>
<code style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;">&lt;RequestsCookieJar[&lt;Cookie channelid=0 for www.kuaidaili.com/&gt;, &lt;Cookie sid=1558602341809465 for www.kuaidaili.com/&gt;]&gt; {'channelid': '0', 'sid': '1558602341809465'}</code></p>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">这里可以使用requests模拟登录快代理，获取登录后的cookies信息，并打印</h4>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">import requests

def kdl_login(url,data):

    headers = {
        'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.157 Safari/537.36',
    }

    try:
        #表示不允许重定向allow_redirects=False
        login_response = requests.post(url=url, data=data, headers=headers,allow_redirects=False)
        if login_response.status_code == 302:
            print(login_response.headers,login_response.cookies)
            # 将CookieJar转为字典：
            logincookie = requests.utils.dict_from_cookiejar(
                login_response.cookies
            )
            print("登录后的cookies",logincookie)

            # 拿到cookies后获取个人主页的信息
            response = requests.get(
                url='https://www.kuaidaili.com/usercenter/',
                headers=headers,
                cookies=logincookie
            )

            if response.status_code == 200:
                html = response.text
                if '2295808193' in html:
                    print('登录成功')

    except Exception as err:
        print(err)

if __name__ == '__main__':

    data = {
        'next':'',
        'kf5_return_to':'',
        'username': '18518753265',
        'passwd': 'ljh123456',
    }

    url = 'https://www.kuaidaili.com/login/'

    kdl_login(url,data)
</code></pre>
<hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">session的使用</strong></h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">在 requests 里，session对象是一个非常常用的对象，这个对象代表一次用户会话：从客户端浏览器连接服务器开始，到客户端浏览器与服务器断开。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">会话能让我们在跨请求时候保持某些参数，比如在同一个 Session 实例发出的所有请求之间保持 cookie 。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><strong style="line-height: 160%; box-sizing: content-box; font-weight: 700;">为了对比这里同样使用快代理进行模拟登录实现</strong><br/>
在之前代码的基础上稍作修改</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">import requests

def kdl_login(url,data):
    # 1.创建session对象，可以保存Cookie值
    session = requests.session()
    # 2. 处理 headers
    headers = {
        'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.157 Safari/537.36',
    }

    try:
        #表示不允许重定向allow_redirects=False
        # 3.模拟登录发起请求，获取cookies
        login_response = session.post(url=url, data=data, headers=headers,allow_redirects=False)
        if login_response.status_code == 302:
            print(login_response.headers,login_response.cookies)
            # 将CookieJar转为字典：
            logincookie = requests.utils.dict_from_cookiejar(
                login_response.cookies
            )
            print("登录后的cookies",logincookie)
            # 4.拿到cookies后获取个人主页的信息
            response = session.get(
                url='https://www.kuaidaili.com/usercenter/',
                headers=headers,
            )
            if response.status_code == 200:
                html = response.text
                if '2295808193' in html:
                    print('登录成功')

    except Exception as err:
        print(err)

if __name__ == '__main__':
    data = {
        'next':'',
        'kf5_return_to':'',
        'username': '18518753265',
        'passwd': 'ljh123456',
    }
    url = 'https://www.kuaidaili.com/login/'
    kdl_login(url,data)
</code></pre>
<hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">处理HTTPS请求 SSL证书验证</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">Requests也可以为HTTPS请求验证SSL证书：<br/>
要想检查某个主机的SSL证书，你可以使用 verify 参数（Defaults to True）</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">import requests
response = requests.get("https://www.baidu.com/", verify=True)
</code></pre>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">如果出现以下错误，表示验证证书出错：<br/>
<code style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;">SSLError: ("bad handshake: Error([('SSL routines', 'ssl3_get_server_certificate', 'certificate verify failed')],)",)</code><br/>
要想跳过书验证，把 verify 设置为 False 就可以正常请求了。</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">import requests
response = requests.get("https://www.12306.cn/mormhweb/", verify = False)
print (response.text)
</code></pre>
<hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">当天作业: 获取雪球网股票资讯数据</h4>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">网站地址：https://xueqiu.com/</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><img src="6.0%20Requests%E7%9A%84%E4%BD%BF%E7%94%A8.resources/Snip20190525_7.png" height="549" width="771"/></p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">需要获取的列表数据如上图，存储数据的时候需要把改条数据所属分类的字段也添加到数据库</p>
</div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%23%23%23%20Requests%E7%9A%84%E4%BD%BF%E7%94%A8%0A%0A%23%23%23%23%23%20**Requests%3A%20%E8%AE%A9%20HTTP%20%E6%9C%8D%E5%8A%A1%E4%BA%BA%E7%B1%BB**%0A%0A%E8%99%BD%E7%84%B6Python%E7%9A%84%E6%A0%87%E5%87%86%E5%BA%93%E4%B8%AD%20**urllib**%20%E6%A8%A1%E5%9D%97%E5%B7%B2%E7%BB%8F%E5%8C%85%E5%90%AB%E4%BA%86%E5%B9%B3%E5%B8%B8%E6%88%91%E4%BB%AC%E4%BD%BF%E7%94%A8%E7%9A%84%E5%A4%A7%E5%A4%9A%E6%95%B0%E5%8A%9F%E8%83%BD%EF%BC%8C%E4%BD%86%E6%98%AF%E5%AE%83%E7%9A%84%20API%20%E4%BD%BF%E7%94%A8%E8%B5%B7%E6%9D%A5%E8%AE%A9%E4%BA%BA%E6%84%9F%E8%A7%89%E4%B8%8D%E5%A4%AA%E5%A5%BD%EF%BC%8C%E8%80%8C%20Requests%20%E8%87%AA%E7%A7%B0%20%22HTTP%20for%20Humans%22%EF%BC%8C%E8%AF%B4%E6%98%8E%E4%BD%BF%E7%94%A8%E6%9B%B4%E7%AE%80%E6%B4%81%E6%96%B9%E4%BE%BF%E3%80%82%0A%0A%0A%23%23%23%20requests%20%E7%9A%84%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E5%85%B6%E5%AE%9E%E5%B0%B1%E6%98%AF%20urllib%0ARequests%E7%9A%84%E6%96%87%E6%A1%A3%E9%9D%9E%E5%B8%B8%E5%AE%8C%E5%A4%87%EF%BC%8C%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3%E4%B9%9F%E7%9B%B8%E5%BD%93%E4%B8%8D%E9%94%99%E3%80%82Requests%E8%83%BD%E5%AE%8C%E5%85%A8%E6%BB%A1%E8%B6%B3%E5%BD%93%E5%89%8D%E7%BD%91%E7%BB%9C%E7%9A%84%E9%9C%80%E6%B1%82%EF%BC%8C%E6%94%AF%E6%8C%81Python%202.6--3.5%EF%BC%8C%E8%80%8C%E4%B8%94%E8%83%BD%E5%9C%A8PyPy%E4%B8%8B%E5%AE%8C%E7%BE%8E%E8%BF%90%E8%A1%8C%E3%80%82%0A%0A%E5%BC%80%E6%BA%90%E5%9C%B0%E5%9D%80%EF%BC%9Ahttps%3A%2F%2Fgithub.com%2Fkennethreitz%2Frequests%0A%0A%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3%20API%EF%BC%9A%20http%3A%2F%2Fdocs.python-requests.org%2Fzh_CN%2Flatest%2Findex.html%0A%0A%23%23%23%23%20**%E5%AE%89%E8%A3%85%E6%96%B9%E5%BC%8F**%0A%E5%88%A9%E7%94%A8%20pip%20%E5%AE%89%E8%A3%85%20%E6%88%96%E8%80%85%E5%88%A9%E7%94%A8%20easy_install%20%E9%83%BD%E5%8F%AF%E4%BB%A5%E5%AE%8C%E6%88%90%E5%AE%89%E8%A3%85%EF%BC%9A%0A%0A%3E%20pip3%20install%20requests%0A%0A%0A%23%23%23%20**%E5%9F%BA%E6%9C%ACGET%E8%AF%B7%E6%B1%82**%0A%0A%23%23%23%23%20**1.%20%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9A%84GET%E8%AF%B7%E6%B1%82%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E7%94%A8get%E6%96%B9%E6%B3%95**%0A%60%60%60%0Aresponse%20%3D%20requests.get(%22http%3A%2F%2Fwww.baidu.com%2F%22)%0A%0A%23%20%E4%B9%9F%E5%8F%AF%E4%BB%A5%E8%BF%99%E4%B9%88%E5%86%99%0A%23%20response%20%3D%20requests.request(%0A%20%20%20%20%22get%22%2C%20%0A%20%20%20%20%22http%3A%2F%2Fwww.baidu.com%2F%22%0A)%0A%60%60%60%0A%0A-%20response%E7%9A%84%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95%EF%BC%9A%0A%0A%20%20%20%20-%20response.text%20%20%E8%BF%94%E5%9B%9E%E8%A7%A3%E7%A0%81%E5%90%8E%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%0A%20%20%20%20-%20respones.content%20%20%E4%BB%A5%E5%AD%97%E8%8A%82%E5%BD%A2%E5%BC%8F%EF%BC%88%E4%BA%8C%E8%BF%9B%E5%88%B6%EF%BC%89%E8%BF%94%E5%9B%9E%E3%80%82%0A%20%20%20%20-%20response.status_code%E3%80%80%20%E5%93%8D%E5%BA%94%E7%8A%B6%E6%80%81%E7%A0%81%0A%20%20%20%20-%20response.request.headers%E3%80%80%20%E8%AF%B7%E6%B1%82%E7%9A%84%E8%AF%B7%E6%B1%82%E5%A4%B4%0A%20%20%20%20-%20response.headers%E3%80%80%20%E5%93%8D%E5%BA%94%E5%A4%B4%0A%20%20%20%20-%20response.encoding%20%3D%20'utf-8'%20%20%20%E5%8F%AF%E4%BB%A5%E8%AE%BE%E7%BD%AE%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B%0A%20%20%20%20-%20response.encoding%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%9A%84%E7%BC%96%E7%A0%81%0A%20%20%20%20-%20response.json()%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E5%86%85%E7%BD%AE%E7%9A%84JSON%E8%A7%A3%E7%A0%81%E5%99%A8%EF%BC%8C%E4%BB%A5json%E5%BD%A2%E5%BC%8F%E8%BF%94%E5%9B%9E%2C%E5%89%8D%E6%8F%90%E8%BF%94%E5%9B%9E%E7%9A%84%E5%86%85%E5%AE%B9%E7%A1%AE%E4%BF%9D%E6%98%AFjson%E6%A0%BC%E5%BC%8F%E7%9A%84%EF%BC%8C%E4%B8%8D%E7%84%B6%E8%A7%A3%E6%9E%90%E5%87%BA%E9%94%99%E4%BC%9A%E6%8A%9B%E5%BC%82%E5%B8%B8%0A%0A%0A%23%23%23%23%20**2.%20%E6%B7%BB%E5%8A%A0%20headers%20%E5%92%8C%20params%E6%9F%A5%E8%AF%A2%E5%8F%82%E6%95%B0**%0A%0A%E5%A6%82%E6%9E%9C%E6%83%B3%E6%B7%BB%E5%8A%A0%20headers%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%BC%A0%E5%85%A5headers%E5%8F%82%E6%95%B0%E6%9D%A5%E5%A2%9E%E5%8A%A0%E8%AF%B7%E6%B1%82%E5%A4%B4%E4%B8%AD%E7%9A%84headers%E4%BF%A1%E6%81%AF%E3%80%82%E5%A6%82%E6%9E%9C%E8%A6%81%E5%B0%86%E5%8F%82%E6%95%B0%E6%94%BE%E5%9C%A8url%E4%B8%AD%E4%BC%A0%E9%80%92%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%88%A9%E7%94%A8%20params%20%E5%8F%82%E6%95%B0%E3%80%82%0A%60%60%60%0Aimport%20requests%0A%0Akw%20%3D%20%7B'wd'%3A'%E9%95%BF%E5%9F%8E'%7D%0A%0Aheaders%20%3D%20%7B%0A%20%20%20%20%22User-Agent%22%3A%20%22Mozilla%2F5.0%20(Windows%20NT%2010.0%3B%20Win64%3B%20x64)%20AppleWebKit%2F537.36%20(KHTML%2C%20like%20Gecko)%20Chrome%2F54.0.2840.99%20Safari%2F537.36%22%0A%7D%0A%0A%23%20params%20%E6%8E%A5%E6%94%B6%E4%B8%80%E4%B8%AA%E5%AD%97%E5%85%B8%E6%88%96%E8%80%85%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%9F%A5%E8%AF%A2%E5%8F%82%E6%95%B0%EF%BC%8C%0A%23%20%E5%AD%97%E5%85%B8%E7%B1%BB%E5%9E%8B%E8%87%AA%E5%8A%A8%E8%BD%AC%E6%8D%A2%E4%B8%BAurl%E7%BC%96%E7%A0%81%EF%BC%8C%E4%B8%8D%E9%9C%80%E8%A6%81urlencode()%0Aresponse%20%3D%20requests.get(%0A%20%20%20%20%22http%3A%2F%2Fwww.baidu.com%2Fs%3F%22%2C%0A%20%20%20%20params%20%3D%20kw%2C%20%0A%20%20%20%20headers%20%3D%20headers%0A)%0A%0A%23%20%E6%9F%A5%E7%9C%8B%E5%93%8D%E5%BA%94%E5%86%85%E5%AE%B9%EF%BC%8Cresponse.text%20%E8%BF%94%E5%9B%9E%E7%9A%84%E6%98%AFUnicode%E6%A0%BC%E5%BC%8F%E7%9A%84%E6%95%B0%E6%8D%AE%0Aprint%20(response.text)%0A%0A%60%60%60%0A%0A---------------------%0A%0A%23%23%23%23%20%E5%8A%A8%E6%89%8B%E4%BD%BF%E7%94%A8Requests%E8%8E%B7%E5%8F%96http%3A%2F%2Fwww.sina.com%E7%9A%84%E9%A1%B5%E9%9D%A2%E6%BA%90%E7%A0%81%E8%A7%82%E5%AF%9F%E7%BB%93%E6%9E%9C%0A%0A**%E6%B3%A8%E6%84%8F%E6%9C%89%E6%97%B6%E5%80%99%E6%88%91%E4%BB%AC%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8response.text%E4%BC%9A%E5%87%BA%E7%8E%B0%E4%B9%B1%E7%A0%81%EF%BC%8C%E4%BA%A7%E7%94%9F%E9%97%AE%E9%A2%98%E7%9A%84%E5%8E%9F%E5%9B%A0%E5%88%86%E6%9E%90**%0A%0A%0A-%20%E5%BD%93%E6%94%B6%E5%88%B0%E4%B8%80%E4%B8%AA%E5%93%8D%E5%BA%94%E6%97%B6%EF%BC%8CRequests%20%E4%BC%9A%E7%8C%9C%E6%B5%8B%E5%93%8D%E5%BA%94%E7%9A%84%E7%BC%96%E7%A0%81%E6%96%B9%E5%BC%8F%EF%BC%8C%E7%94%A8%E4%BA%8E%E5%9C%A8%E4%BD%A0%E8%B0%83%E7%94%A8response.text%20%E6%96%B9%E6%B3%95%E6%97%B6%E5%AF%B9%E5%93%8D%E5%BA%94%E8%BF%9B%E8%A1%8C%E8%A7%A3%E7%A0%81%E3%80%82Requests%20%E9%A6%96%E5%85%88%E5%9C%A8%20HTTP%20%E5%A4%B4%E9%83%A8%E6%A3%80%E6%B5%8B%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%E6%8C%87%E5%AE%9A%E7%9A%84%E7%BC%96%E7%A0%81%E6%96%B9%E5%BC%8F%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%B8%8D%E5%AD%98%E5%9C%A8%EF%BC%8C%E5%88%99%E4%BC%9A%E4%BD%BF%E7%94%A8%20%0Achardet.detect%E6%9D%A5%E5%B0%9D%E8%AF%95%E7%8C%9C%E6%B5%8B%E7%BC%96%E7%A0%81%E6%96%B9%E5%BC%8F%EF%BC%88%E5%AD%98%E5%9C%A8%E8%AF%AF%E5%B7%AE%EF%BC%89%0A%0A-%20%E6%95%85%E6%9B%B4%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8response.content.deocde()%0A%0A%0A%0A%0A----------------------------------------------------%0A%0A%23%23%23%20**%E5%9F%BA%E6%9C%ACPOST%E8%AF%B7%E6%B1%82%EF%BC%88data%E5%8F%82%E6%95%B0%EF%BC%89**%0A%23%23%23%23%20**1.%20%E6%9C%80%E5%9F%BA%E6%9C%ACpost%E6%96%B9%E6%B3%95**%0A%0A%3Eresponse%20%3D%20requests.post(url%3Durl%2C%20data%20%3D%20data)%0A-%20url%3Apost%E8%AF%B7%E6%B1%82%E7%9A%84%E7%9B%AE%E6%A0%87url%0A-%20data%3Apost%E8%AF%B7%E6%B1%82%E7%9A%84%E8%A1%A8%E5%8D%95%E6%95%B0%E6%8D%AE%0A%0A**2.%20%E4%BC%A0%E5%85%A5data%E6%95%B0%E6%8D%AE**%0A%E5%AF%B9%E4%BA%8E%20POST%20%E8%AF%B7%E6%B1%82%E6%9D%A5%E8%AF%B4%EF%BC%8C%E6%88%91%E4%BB%AC%E4%B8%80%E8%88%AC%E9%9C%80%E8%A6%81%E4%B8%BA%E5%AE%83%E5%A2%9E%E5%8A%A0%E4%B8%80%E4%BA%9B%E5%8F%82%E6%95%B0%E3%80%82%E9%82%A3%E4%B9%88%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9A%84%E4%BC%A0%E5%8F%82%E6%96%B9%E6%B3%95%E5%8F%AF%E4%BB%A5%E5%88%A9%E7%94%A8%20data%20%E8%BF%99%E4%B8%AA%E5%8F%82%E6%95%B0%E3%80%82%0A%0A%23%23%23%23%20%E8%8E%B7%E5%8F%96%E4%B8%96%E7%BA%AA%E4%BD%B3%E7%BC%98%E7%9B%B8%E4%BA%B2%E7%BE%8E%E5%A5%B3%E4%BF%A1%E6%81%AF%0A%60%60%60%0Aimport%20requests%0A%0Aform_data%20%3D%20%7B%0A%20%20%20%20'sex'%3A%20'f'%2C%0A%20%20%20%20'key'%3A%20''%2C%0A%20%20%20%20'stc'%3A%20'1%3A11%2C2%3A20.28%2C23%3A1'%2C%0A%20%20%20%20'sn'%3A%20'default'%2C%0A%20%20%20%20'sv'%3A%20'1'%2C%0A%20%20%20%20'p'%3A%20'1'%2C%0A%20%20%20%20'f'%3A%20'search'%2C%0A%20%20%20%20'listStyle'%3A%20'bigPhoto'%2C%0A%20%20%20%20'pri_uid'%3A'0'%2C%0A%20%20%20%20'jsversion'%3A%20'v5'%2C%0A%7D%0A%0Aheader%20%3D%20%7B%0A%20%20%20%20'Referer'%3A%20'http%3A%2F%2Fsearch.jiayuan.com%2Fv2%2Findex.php%3Fsex%3Df%26stc%3D1%3A11%2C2%3A20.28%2C23%3A1%26f%3Dsearch'%2C%0A%20%20%20%20'User-Agent'%3A%20'Mozilla%2F5.0%20(X11%3B%20Linux%20x86_64)%20AppleWebKit%2F537.36%20(KHTML%2C%20like%20Gecko)%20Chrome%2F67.0.3396.99%20Safari%2F537.36'%2C%0A%7D%0A%0Aurl%20%3D%20'http%3A%2F%2Fsearch.jiayuan.com%2Fv2%2Fsearch_v2.php'%0A%0Aresponse%20%3D%20requests.post(url%2Cheaders%3Dheader%2Cdata%3Dform_data)%0A%0Aprint(response.text)%0A%0A%23%20%E5%A6%82%E6%9E%9C%E6%98%AFjson%E6%96%87%E4%BB%B6%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E6%98%BE%E7%A4%BA%0A%23%20print%20(response.json())%0A%60%60%60%0A%0A%23%23%23%20**post%E8%AF%B7%E6%B1%82%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6**%0A%0A%E5%A6%82%E6%9E%9C%E6%88%91%E4%BB%AC%E6%83%B3post%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E6%80%8E%E4%B9%88%E5%8A%9E%E5%91%A2%EF%BC%9F%E8%BF%99%E4%B8%AA%E6%97%B6%E5%80%99%E5%B0%B1%E9%9C%80%E8%A6%81%E7%94%A8%E5%88%B0files%E5%8F%82%E6%95%B0%E4%BA%86%EF%BC%9A%0A%60%60%60%0Aurl%20%3D%20'https%3A%2F%2Fhttpbin.org%2Fpost'%0Afiles%20%3D%20%7B'file'%3A%20open('image.png'%2C%20'rb')%7D%0Aresponse%20%3D%20requests.post(url%2C%20files%3Dfiles)%0Aprint(response.text)%0A%60%60%60%0A%0A%0A%23%23%23%20**web%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%AA%8C%E8%AF%81**%0A%0A%E5%A6%82%E6%9E%9C%E6%98%AFWeb%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%AA%8C%E8%AF%81%EF%BC%8C%E9%9C%80%E8%A6%81%E6%B7%BB%E5%8A%A0%20auth%20%3D%20(%E8%B4%A6%E6%88%B7%E5%90%8D%2C%20%E5%AF%86%E7%A0%81)%0A%60%60%60%0Aimport%20requests%0A%0Aauth%3D('test'%2C%20'123456')%0A%0Aresponse%20%3D%20requests.get(%0A%20%20%20%20'http%3A%2F%2F192.168.199.107'%2C%20%0A%20%20%20%20auth%20%3D%20auth%0A)%0A%0Aprint%20(response.text)%0A%60%60%60%0A%0A%0A%23%23%23%20**%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86%EF%BC%88proxies%E5%8F%82%E6%95%B0%EF%BC%89**%0A%0A%E5%A6%82%E6%9E%9C%E9%9C%80%E8%A6%81%E4%BD%BF%E7%94%A8%E4%BB%A3%E7%90%86%EF%BC%8C%E4%BD%A0%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E4%B8%BA%E4%BB%BB%E6%84%8F%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95%E6%8F%90%E4%BE%9B%20proxies%20%E5%8F%82%E6%95%B0%E6%9D%A5%E9%85%8D%E7%BD%AE%E5%8D%95%E4%B8%AA%E8%AF%B7%E6%B1%82%EF%BC%9A%0A%60%60%60%0Aimport%20requests%0A%0A%23%20%E6%A0%B9%E6%8D%AE%E5%8D%8F%E8%AE%AE%E7%B1%BB%E5%9E%8B%EF%BC%8C%E9%80%89%E6%8B%A9%E4%B8%8D%E5%90%8C%E7%9A%84%E4%BB%A3%E7%90%86%0Aproxies%20%3D%20%7B%0A%20%20%20%20%22http%22%3A%20%22http%3A%2F%2F12.34.56.79%3A9527%22%2C%0A%20%20%20%20%22https%22%3A%20%22http%3A%2F%2F12.34.56.79%3A9527%22%2C%0A%7D%0A%0Aresponse%20%3D%20requests.get(%0A%20%20%20%20%22http%3A%2F%2Fwww.baidu.com%22%2C%20%0A%20%20%20%20proxies%20%3D%20proxies%0A)%0Aprint(response.text)%0A%60%60%60%0A%0A**%E7%A7%81%E5%AF%86%E4%BB%A3%E7%90%86%E9%AA%8C%E8%AF%81%EF%BC%88%E7%89%B9%E5%AE%9A%E6%A0%BC%E5%BC%8F%EF%BC%89%20%E5%92%8C%20Web%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%AA%8C%E8%AF%81%EF%BC%88auth%20%E5%8F%82%E6%95%B0%EF%BC%89**%0A%0A**%E7%A7%81%E5%AF%86%E4%BB%A3%E7%90%86**%0A%60%60%60%0Aimport%20requests%0A%0A%23%20%E5%A6%82%E6%9E%9C%E4%BB%A3%E7%90%86%E9%9C%80%E8%A6%81%E4%BD%BF%E7%94%A8HTTP%20Basic%20Auth%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E4%B8%8B%E9%9D%A2%E8%BF%99%E7%A7%8D%E6%A0%BC%E5%BC%8F%EF%BC%9A%0Aproxy%20%3D%20%7B%20%0A%20%20%20%20%22http%22%3A%20%22name%3Apwd%4061.158.163.130%3A16816%22%20%0A%7D%0A%0Aresponse%20%3D%20requests.get(%0A%20%20%20%20%22http%3A%2F%2Fwww.baidu.com%22%2C%0A%20%20%20%20%20proxies%20%3D%20proxy%0A)%0A%0Aprint%20(response.text)%0A%60%60%60%0A%0A%23%23%23%20**Cookies**%0A%0A%E5%A6%82%E6%9E%9C%E4%B8%80%E4%B8%AA%E5%93%8D%E5%BA%94%E4%B8%AD%E5%8C%85%E5%90%AB%E4%BA%86cookie%EF%BC%8C%E9%82%A3%E4%B9%88%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E5%88%A9%E7%94%A8%20cookies%E5%8F%82%E6%95%B0%E6%8B%BF%E5%88%B0%EF%BC%9A%0A%0A%60%60%60%0Aimport%20requests%0A%0Aresponse%20%3D%20requests.get(%22https%3A%2F%2Fwww.kuaidaili.com%2Flogin%2F%22)%0A%0A%23%20%E8%BF%94%E5%9B%9ECookieJar%E5%AF%B9%E8%B1%A1%3A%0Acookiejar%20%3D%20response.cookies%0A%0A%23%20%E5%B0%86CookieJar%E8%BD%AC%E4%B8%BA%E5%AD%97%E5%85%B8%EF%BC%9A%0Acookiedict%20%3D%20requests.utils.dict_from_cookiejar(%0A%20%20%20%20cookiejar%0A)%0A%0Aprint%20(cookiejar)%0A%0Aprint%20(cookiedict)%0A%60%60%60%0A%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8B%EF%BC%9A%0A%60%3CRequestsCookieJar%5B%3CCookie%20channelid%3D0%20for%20www.kuaidaili.com%2F%3E%2C%20%3CCookie%20sid%3D1558602341809465%20for%20www.kuaidaili.com%2F%3E%5D%3E%0A%7B'channelid'%3A%20'0'%2C%20'sid'%3A%20'1558602341809465'%7D%60%0A%0A%0A%23%23%23%23%20%E8%BF%99%E9%87%8C%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8requests%E6%A8%A1%E6%8B%9F%E7%99%BB%E5%BD%95%E5%BF%AB%E4%BB%A3%E7%90%86%EF%BC%8C%E8%8E%B7%E5%8F%96%E7%99%BB%E5%BD%95%E5%90%8E%E7%9A%84cookies%E4%BF%A1%E6%81%AF%EF%BC%8C%E5%B9%B6%E6%89%93%E5%8D%B0%0A%0A%60%60%60%0Aimport%20requests%0A%0Adef%20kdl_login(url%2Cdata)%3A%0A%0A%20%20%20%20headers%20%3D%20%7B%0A%20%20%20%20%20%20%20%20'User-Agent'%3A'Mozilla%2F5.0%20(Macintosh%3B%20Intel%20Mac%20OS%20X%2010_13_6)%20AppleWebKit%2F537.36%20(KHTML%2C%20like%20Gecko)%20Chrome%2F74.0.3729.157%20Safari%2F537.36'%2C%0A%20%20%20%20%7D%0A%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%23%E8%A1%A8%E7%A4%BA%E4%B8%8D%E5%85%81%E8%AE%B8%E9%87%8D%E5%AE%9A%E5%90%91allow_redirects%3DFalse%0A%20%20%20%20%20%20%20%20login_response%20%3D%20requests.post(url%3Durl%2C%20data%3Ddata%2C%20headers%3Dheaders%2Callow_redirects%3DFalse)%0A%20%20%20%20%20%20%20%20if%20login_response.status_code%20%3D%3D%20302%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(login_response.headers%2Clogin_response.cookies)%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20%E5%B0%86CookieJar%E8%BD%AC%E4%B8%BA%E5%AD%97%E5%85%B8%EF%BC%9A%0A%20%20%20%20%20%20%20%20%20%20%20%20logincookie%20%3D%20requests.utils.dict_from_cookiejar(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20login_response.cookies%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(%22%E7%99%BB%E5%BD%95%E5%90%8E%E7%9A%84cookies%22%2Clogincookie)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20%E6%8B%BF%E5%88%B0cookies%E5%90%8E%E8%8E%B7%E5%8F%96%E4%B8%AA%E4%BA%BA%E4%B8%BB%E9%A1%B5%E7%9A%84%E4%BF%A1%E6%81%AF%0A%20%20%20%20%20%20%20%20%20%20%20%20response%20%3D%20requests.get(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20url%3D'https%3A%2F%2Fwww.kuaidaili.com%2Fusercenter%2F'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20headers%3Dheaders%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cookies%3Dlogincookie%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20response.status_code%20%3D%3D%20200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20html%20%3D%20response.text%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20'2295808193'%20in%20html%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print('%E7%99%BB%E5%BD%95%E6%88%90%E5%8A%9F')%0A%0A%20%20%20%20except%20Exception%20as%20err%3A%0A%20%20%20%20%20%20%20%20print(err)%0A%0Aif%20__name__%20%3D%3D%20'__main__'%3A%0A%0A%20%20%20%20data%20%3D%20%7B%0A%20%20%20%20%20%20%20%20'next'%3A''%2C%0A%20%20%20%20%20%20%20%20'kf5_return_to'%3A''%2C%0A%20%20%20%20%20%20%20%20'username'%3A%20'18518753265'%2C%0A%20%20%20%20%20%20%20%20'passwd'%3A%20'ljh123456'%2C%0A%20%20%20%20%7D%0A%0A%20%20%20%20url%20%3D%20'https%3A%2F%2Fwww.kuaidaili.com%2Flogin%2F'%0A%0A%20%20%20%20kdl_login(url%2Cdata)%0A%60%60%60%0A%0A------------------------------------%0A%0A%23%23%23%20**session%E7%9A%84%E4%BD%BF%E7%94%A8**%0A%0A%E5%9C%A8%20requests%20%E9%87%8C%EF%BC%8Csession%E5%AF%B9%E8%B1%A1%E6%98%AF%E4%B8%80%E4%B8%AA%E9%9D%9E%E5%B8%B8%E5%B8%B8%E7%94%A8%E7%9A%84%E5%AF%B9%E8%B1%A1%EF%BC%8C%E8%BF%99%E4%B8%AA%E5%AF%B9%E8%B1%A1%E4%BB%A3%E8%A1%A8%E4%B8%80%E6%AC%A1%E7%94%A8%E6%88%B7%E4%BC%9A%E8%AF%9D%EF%BC%9A%E4%BB%8E%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BF%9E%E6%8E%A5%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BC%80%E5%A7%8B%EF%BC%8C%E5%88%B0%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%96%AD%E5%BC%80%E3%80%82%0A%0A%E4%BC%9A%E8%AF%9D%E8%83%BD%E8%AE%A9%E6%88%91%E4%BB%AC%E5%9C%A8%E8%B7%A8%E8%AF%B7%E6%B1%82%E6%97%B6%E5%80%99%E4%BF%9D%E6%8C%81%E6%9F%90%E4%BA%9B%E5%8F%82%E6%95%B0%EF%BC%8C%E6%AF%94%E5%A6%82%E5%9C%A8%E5%90%8C%E4%B8%80%E4%B8%AA%20Session%20%E5%AE%9E%E4%BE%8B%E5%8F%91%E5%87%BA%E7%9A%84%E6%89%80%E6%9C%89%E8%AF%B7%E6%B1%82%E4%B9%8B%E9%97%B4%E4%BF%9D%E6%8C%81%20cookie%20%E3%80%82%0A%0A**%E4%B8%BA%E4%BA%86%E5%AF%B9%E6%AF%94%E8%BF%99%E9%87%8C%E5%90%8C%E6%A0%B7%E4%BD%BF%E7%94%A8%E5%BF%AB%E4%BB%A3%E7%90%86%E8%BF%9B%E8%A1%8C%E6%A8%A1%E6%8B%9F%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0**%0A%E5%9C%A8%E4%B9%8B%E5%89%8D%E4%BB%A3%E7%A0%81%E7%9A%84%E5%9F%BA%E7%A1%80%E4%B8%8A%E7%A8%8D%E4%BD%9C%E4%BF%AE%E6%94%B9%0A%0A%60%60%60%0Aimport%20requests%0A%0Adef%20kdl_login(url%2Cdata)%3A%0A%20%20%20%20%23%201.%E5%88%9B%E5%BB%BAsession%E5%AF%B9%E8%B1%A1%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%BF%9D%E5%AD%98Cookie%E5%80%BC%0A%20%20%20%20session%20%3D%20requests.session()%0A%20%20%20%20%23%202.%20%E5%A4%84%E7%90%86%20headers%0A%20%20%20%20headers%20%3D%20%7B%0A%20%20%20%20%20%20%20%20'User-Agent'%3A'Mozilla%2F5.0%20(Macintosh%3B%20Intel%20Mac%20OS%20X%2010_13_6)%20AppleWebKit%2F537.36%20(KHTML%2C%20like%20Gecko)%20Chrome%2F74.0.3729.157%20Safari%2F537.36'%2C%0A%20%20%20%20%7D%0A%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%23%E8%A1%A8%E7%A4%BA%E4%B8%8D%E5%85%81%E8%AE%B8%E9%87%8D%E5%AE%9A%E5%90%91allow_redirects%3DFalse%0A%20%20%20%20%20%20%20%20%23%203.%E6%A8%A1%E6%8B%9F%E7%99%BB%E5%BD%95%E5%8F%91%E8%B5%B7%E8%AF%B7%E6%B1%82%EF%BC%8C%E8%8E%B7%E5%8F%96cookies%0A%20%20%20%20%20%20%20%20login_response%20%3D%20session.post(url%3Durl%2C%20data%3Ddata%2C%20headers%3Dheaders%2Callow_redirects%3DFalse)%0A%20%20%20%20%20%20%20%20if%20login_response.status_code%20%3D%3D%20302%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(login_response.headers%2Clogin_response.cookies)%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20%E5%B0%86CookieJar%E8%BD%AC%E4%B8%BA%E5%AD%97%E5%85%B8%EF%BC%9A%0A%20%20%20%20%20%20%20%20%20%20%20%20logincookie%20%3D%20requests.utils.dict_from_cookiejar(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20login_response.cookies%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(%22%E7%99%BB%E5%BD%95%E5%90%8E%E7%9A%84cookies%22%2Clogincookie)%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%204.%E6%8B%BF%E5%88%B0cookies%E5%90%8E%E8%8E%B7%E5%8F%96%E4%B8%AA%E4%BA%BA%E4%B8%BB%E9%A1%B5%E7%9A%84%E4%BF%A1%E6%81%AF%0A%20%20%20%20%20%20%20%20%20%20%20%20response%20%3D%20session.get(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20url%3D'https%3A%2F%2Fwww.kuaidaili.com%2Fusercenter%2F'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20headers%3Dheaders%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20response.status_code%20%3D%3D%20200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20html%20%3D%20response.text%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20'2295808193'%20in%20html%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print('%E7%99%BB%E5%BD%95%E6%88%90%E5%8A%9F')%0A%0A%20%20%20%20except%20Exception%20as%20err%3A%0A%20%20%20%20%20%20%20%20print(err)%0A%0Aif%20__name__%20%3D%3D%20'__main__'%3A%0A%20%20%20%20data%20%3D%20%7B%0A%20%20%20%20%20%20%20%20'next'%3A''%2C%0A%20%20%20%20%20%20%20%20'kf5_return_to'%3A''%2C%0A%20%20%20%20%20%20%20%20'username'%3A%20'18518753265'%2C%0A%20%20%20%20%20%20%20%20'passwd'%3A%20'ljh123456'%2C%0A%20%20%20%20%7D%0A%20%20%20%20url%20%3D%20'https%3A%2F%2Fwww.kuaidaili.com%2Flogin%2F'%0A%20%20%20%20kdl_login(url%2Cdata)%0A%60%60%60%0A%0A---------------------------------------------%0A%0A%0A%23%23%23%20%E5%A4%84%E7%90%86HTTPS%E8%AF%B7%E6%B1%82%20SSL%E8%AF%81%E4%B9%A6%E9%AA%8C%E8%AF%81%0ARequests%E4%B9%9F%E5%8F%AF%E4%BB%A5%E4%B8%BAHTTPS%E8%AF%B7%E6%B1%82%E9%AA%8C%E8%AF%81SSL%E8%AF%81%E4%B9%A6%EF%BC%9A%0A%E8%A6%81%E6%83%B3%E6%A3%80%E6%9F%A5%E6%9F%90%E4%B8%AA%E4%B8%BB%E6%9C%BA%E7%9A%84SSL%E8%AF%81%E4%B9%A6%EF%BC%8C%E4%BD%A0%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%20verify%20%E5%8F%82%E6%95%B0%EF%BC%88Defaults%20to%20True%EF%BC%89%0A%60%60%60%0Aimport%20requests%0Aresponse%20%3D%20requests.get(%22https%3A%2F%2Fwww.baidu.com%2F%22%2C%20verify%3DTrue)%0A%60%60%60%0A%0A%E5%A6%82%E6%9E%9C%E5%87%BA%E7%8E%B0%E4%BB%A5%E4%B8%8B%E9%94%99%E8%AF%AF%EF%BC%8C%E8%A1%A8%E7%A4%BA%E9%AA%8C%E8%AF%81%E8%AF%81%E4%B9%A6%E5%87%BA%E9%94%99%EF%BC%9A%0A%60SSLError%3A%20(%22bad%20handshake%3A%20Error(%5B('SSL%20routines'%2C%20'ssl3_get_server_certificate'%2C%20'certificate%20verify%20failed')%5D%2C)%22%2C)%60%0A%E8%A6%81%E6%83%B3%E8%B7%B3%E8%BF%87%E4%B9%A6%E9%AA%8C%E8%AF%81%EF%BC%8C%E6%8A%8A%20verify%20%E8%AE%BE%E7%BD%AE%E4%B8%BA%20False%20%E5%B0%B1%E5%8F%AF%E4%BB%A5%E6%AD%A3%E5%B8%B8%E8%AF%B7%E6%B1%82%E4%BA%86%E3%80%82%0A%0A%60%60%60%0Aimport%20requests%0Aresponse%20%3D%20requests.get(%22https%3A%2F%2Fwww.12306.cn%2Fmormhweb%2F%22%2C%20verify%20%3D%20False)%0Aprint%20(response.text)%0A%60%60%60%0A%0A%0A-----------------------------------%0A%0A%23%23%23%23%20%E5%BD%93%E5%A4%A9%E4%BD%9C%E4%B8%9A%3A%20%E8%8E%B7%E5%8F%96%E9%9B%AA%E7%90%83%E7%BD%91%E8%82%A1%E7%A5%A8%E8%B5%84%E8%AE%AF%E6%95%B0%E6%8D%AE%20%0A%0A%E7%BD%91%E7%AB%99%E5%9C%B0%E5%9D%80%EF%BC%9Ahttps%3A%2F%2Fxueqiu.com%2F%0A%0A!%5B2d586e0acac7649f782e907c34b057b5.png%5D(en-resource%3A%2F%2Fdatabase%2F3900%3A1)%0A%0A%E9%9C%80%E8%A6%81%E8%8E%B7%E5%8F%96%E7%9A%84%E5%88%97%E8%A1%A8%E6%95%B0%E6%8D%AE%E5%A6%82%E4%B8%8A%E5%9B%BE%EF%BC%8C%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE%E7%9A%84%E6%97%B6%E5%80%99%E9%9C%80%E8%A6%81%E6%8A%8A%E6%94%B9%E6%9D%A1%E6%95%B0%E6%8D%AE%E6%89%80%E5%B1%9E%E5%88%86%E7%B1%BB%E7%9A%84%E5%AD%97%E6%AE%B5%E4%B9%9F%E6%B7%BB%E5%8A%A0%E5%88%B0%E6%95%B0%E6%8D%AE%E5%BA%93</center></body></html>