<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.0.5 (458014)"/><meta name="author" content="李居豪"/><meta name="created" content="2019-05-25 05:51:22 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2019-05-30 02:28:28 +0000"/><meta name="content-class" content="yinxiang.markdown"/><title>8.0 XPath选择器</title></head><body><div><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">正则用的不好，处理HTML文档很累，有没有其他的方法？</span></div><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">什么是XPath？</span></h3><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">XPath (XML Path Language) 是一门在 XML 文档中查找信息的语言，可用来在 XML 文档中对元素和属性进行遍历。</span></div></li></ul><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">什么是XML?</span></h4><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">XML 指可扩展标记语言（EXtensible Markup Language）</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">XML 是一种标记语言，很类似 HTML</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">XML 的设计宗旨是传输数据，而非显示数据</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">XML 的标签需要我们自行定义。</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">XML 被设计为具有自我描述性。</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">XML 是 W3C 的推荐标准</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">XML 和 HTML 的区别</span></div><table style="margin: 2px 0px 14px; width: auto; border-collapse: collapse; box-sizing: border-box;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody style="box-sizing: content-box;"><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 6px 14px 5px 12px; border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(114, 119, 123); border-bottom-color: rgb(114, 119, 123); border-left-color: rgb(114, 119, 123); border-image: initial; border-top-style: initial; border-top-color: initial; background-color: rgb(123, 129, 132);"><span style="font-size: 14px; color: rgb(255, 255, 255); font-weight: 300; line-height: 160%;">数据格式</span></td><td style="box-sizing: content-box; padding: 6px 14px 5px 12px; border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(114, 119, 123); border-bottom-color: rgb(114, 119, 123); border-left-color: rgb(114, 119, 123); border-image: initial; border-top-style: initial; border-top-color: initial; background-color: rgb(123, 129, 132);"><span style="font-size: 14px; color: rgb(255, 255, 255); font-weight: 300; line-height: 160%;">描述</span></td><td style="box-sizing: content-box; padding: 6px 14px 5px 12px; border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(114, 119, 123); border-bottom-color: rgb(114, 119, 123); border-left-color: rgb(114, 119, 123); border-image: initial; border-top-style: initial; border-top-color: initial; background-color: rgb(123, 129, 132);"><span style="font-size: 14px; color: rgb(255, 255, 255); font-weight: 300; line-height: 160%;">设计目标</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">XML</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">Extensible Markup Language （可扩展标记语言）</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">被设计为传输和存储数据，其焦点是数据的内容。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">HTML</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">HyperText Markup Language （超文本标记语言）</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">显示数据以及如何更好显示数据。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">HTML DOM</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">Document Object Model for HTML (文档对象模型)</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">通过 HTML DOM，可以访问所有的 HTML 元素，连同它们所包含的文本和属性。可以对其中的内容进行修改和删除，同时也可以创建新的元素。</span></td></tr></tbody></table><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">XML文档示例</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">&lt;xml version="1.0" encoding="utf-8"?&gt;</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">&lt;bookstore&gt;</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">&lt;book category="cooking"&gt;</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">&lt;title lang="en"&gt;Everyday Italian&lt;/title&gt;</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">&lt;author&gt;Giada De Laurentiis&lt;/author&gt;</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">&lt;year&gt;2005&lt;/year&gt;</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">&lt;price&gt;30.00&lt;/price&gt;</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">&lt;/book&gt;</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">&lt;book category="children"&gt;</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">&lt;title lang="en"&gt;Harry Potter&lt;/title&gt;</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">&lt;author&gt;J K. Rowling&lt;/author&gt;</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">&lt;year&gt;2005&lt;/year&gt;</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">&lt;price&gt;29.99&lt;/price&gt;</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">&lt;/book&gt;</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">&lt;/bookstore&gt;</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">HTML DOM 模型示例</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">HTML DOM 定义了访问和操作 HTML 文档的标准方法，以树结构方式表达 HTML 文档。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;"><img src="8.0%20XPath%E9%80%89%E6%8B%A9%E5%99%A8.resources/232CA652-CE00-4066-8360-8EF5044B5BA0.gif" height="266" width="486"/></span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">什么是XPath？</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">XPath (XML Path Language) 是一门在 XML 文档中查找信息的语言，可用来在 XML 文档中对元素和属性进行遍历。</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">W3School官方文档：http://www.w3school.com.cn/xpath/index.asp</span></div><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">XPath 开发工具</span></h4><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">Chrome插件 XPath Helper</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">Firefox插件 XPath Checker</span></div></li></ul><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">选取节点</span></h4><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">XPath 使用路径表达式来选取 XML 文档中的节点或者节点集。这些路径表达式和我们在常规的电脑文件系统中看到的表达式非常相似。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">下面列出了最常用的路径表达式：</span></div><table style="margin: 2px 0px 14px; width: auto; border-collapse: collapse; box-sizing: border-box;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody style="box-sizing: content-box;"><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 6px 14px 5px 12px; border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(114, 119, 123); border-bottom-color: rgb(114, 119, 123); border-left-color: rgb(114, 119, 123); border-image: initial; border-top-style: initial; border-top-color: initial; background-color: rgb(123, 129, 132);"><span style="font-size: 14px; color: rgb(255, 255, 255); font-weight: 300; line-height: 160%;">表达式</span></td><td style="box-sizing: content-box; padding: 6px 14px 5px 12px; border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(114, 119, 123); border-bottom-color: rgb(114, 119, 123); border-left-color: rgb(114, 119, 123); border-image: initial; border-top-style: initial; border-top-color: initial; background-color: rgb(123, 129, 132);"><span style="font-size: 14px; color: rgb(255, 255, 255); font-weight: 300; line-height: 160%;">描述</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">nodename</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取此节点的所有子节点。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">/</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">从根节点选取。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">//</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">从匹配选择的当前节点选择文档中的节点，而不考虑它们的位置。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">.</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取当前节点。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">..</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取当前节点的父节点。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">@</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取属性。</span></td></tr></tbody></table><div><br/></div><hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">在下面的表格中，我们已列出了一些路径表达式以及表达式的结果：</span></div><table style="margin: 2px 0px 14px; width: auto; border-collapse: collapse; box-sizing: border-box;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody style="box-sizing: content-box;"><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 6px 14px 5px 12px; border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(114, 119, 123); border-bottom-color: rgb(114, 119, 123); border-left-color: rgb(114, 119, 123); border-image: initial; border-top-style: initial; border-top-color: initial; background-color: rgb(123, 129, 132);"><span style="font-size: 14px; color: rgb(255, 255, 255); font-weight: 300; line-height: 160%;">路径表达式</span></td><td style="box-sizing: content-box; padding: 6px 14px 5px 12px; border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(114, 119, 123); border-bottom-color: rgb(114, 119, 123); border-left-color: rgb(114, 119, 123); border-image: initial; border-top-style: initial; border-top-color: initial; background-color: rgb(123, 129, 132);"><span style="font-size: 14px; color: rgb(255, 255, 255); font-weight: 300; line-height: 160%;">结果</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">bookstore</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取 bookstore 元素的所有子节点。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">/bookstore</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取根元素 bookstore。注释：假如路径起始于正斜杠( / )，则此路径始终代表到某元素的绝对路径！</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">bookstore/book</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取属于 bookstore 的子元素的所有 book 元素。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">//book</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取所有 book 子元素，而不管它们在文档中的位置。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">bookstore//book</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选择属于 bookstore 元素的后代的所有 book 元素，而不管它们位于 bookstore 之下的什么位置。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">//@lang</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取名为 lang 的所有属性。</span></td></tr></tbody></table><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">谓语（Predicates）</span></h4><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">谓语用来查找某个特定的节点或者包含某个指定的值的节点，被嵌在方括号中。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">在下面的表格中，我们列出了带有谓语的一些路径表达式，以及表达式的结果：</span></div><table style="margin: 2px 0px 14px; width: auto; border-collapse: collapse; box-sizing: border-box;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody style="box-sizing: content-box;"><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 6px 14px 5px 12px; border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(114, 119, 123); border-bottom-color: rgb(114, 119, 123); border-left-color: rgb(114, 119, 123); border-image: initial; border-top-style: initial; border-top-color: initial; background-color: rgb(123, 129, 132);"><span style="font-size: 14px; color: rgb(255, 255, 255); font-weight: 300; line-height: 160%;">路径表达式</span></td><td style="box-sizing: content-box; padding: 6px 14px 5px 12px; border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(114, 119, 123); border-bottom-color: rgb(114, 119, 123); border-left-color: rgb(114, 119, 123); border-image: initial; border-top-style: initial; border-top-color: initial; background-color: rgb(123, 129, 132);"><span style="font-size: 14px; color: rgb(255, 255, 255); font-weight: 300; line-height: 160%;">结果</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">/bookstore/book[1]</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取属于 bookstore 子元素的第一个 book 元素。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">/bookstore/book[last()]</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取属于 bookstore 子元素的最后一个 book 元素。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">/bookstore/book[last()-1]</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取属于 bookstore 子元素的倒数第二个 book 元素。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">/bookstore/book[position() &lt; 3]</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取最前面的两个属于 bookstore 元素的子元素的 book 元素。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">//title[@lang]</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取所有拥有名为 lang 的属性的 title 元素。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">//title[@lang=’eng’]</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取所有 title 元素，且这些元素拥有值为 eng 的 lang 属性。</span></td></tr></tbody></table><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">选取未知节点</span></h4><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">XPath 通配符可用来选取未知的 XML 元素。</span></div><table style="margin: 2px 0px 14px; width: auto; border-collapse: collapse; box-sizing: border-box;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody style="box-sizing: content-box;"><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 6px 14px 5px 12px; border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(114, 119, 123); border-bottom-color: rgb(114, 119, 123); border-left-color: rgb(114, 119, 123); border-image: initial; border-top-style: initial; border-top-color: initial; background-color: rgb(123, 129, 132);"><span style="font-size: 14px; color: rgb(255, 255, 255); font-weight: 300; line-height: 160%;">通配符</span></td><td style="box-sizing: content-box; padding: 6px 14px 5px 12px; border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(114, 119, 123); border-bottom-color: rgb(114, 119, 123); border-left-color: rgb(114, 119, 123); border-image: initial; border-top-style: initial; border-top-color: initial; background-color: rgb(123, 129, 132);"><span style="font-size: 14px; color: rgb(255, 255, 255); font-weight: 300; line-height: 160%;">描述</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">*</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">匹配任何元素节点。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">@*</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">匹配任何属性节点。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">node()</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">匹配任何类型的节点。</span></td></tr></tbody></table><table style="margin: 2px 0px 14px; width: auto; border-collapse: collapse; box-sizing: border-box;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody style="box-sizing: content-box;"><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 6px 14px 5px 12px; border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(114, 119, 123); border-bottom-color: rgb(114, 119, 123); border-left-color: rgb(114, 119, 123); border-image: initial; border-top-style: initial; border-top-color: initial; background-color: rgb(123, 129, 132);"><span style="font-size: 14px; color: rgb(255, 255, 255); font-weight: 300; line-height: 160%;">路径表达式</span></td><td style="box-sizing: content-box; padding: 6px 14px 5px 12px; border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(114, 119, 123); border-bottom-color: rgb(114, 119, 123); border-left-color: rgb(114, 119, 123); border-image: initial; border-top-style: initial; border-top-color: initial; background-color: rgb(123, 129, 132);"><span style="font-size: 14px; color: rgb(255, 255, 255); font-weight: 300; line-height: 160%;">结果</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">/bookstore/*</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取 bookstore 元素的所有子元素。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">//*</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取文档中的所有元素。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">html/node()/meta/@*</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选择html下面任意节点下的meta节点的所有属性</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">//title[@*]</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取所有带有属性的 title 元素。</span></td></tr></tbody></table><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">选取若干路径</span></h4><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">通过在路径表达式中使用“|”运算符，您可以选取若干个路径。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">实例</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">在下面的表格中，我们列出了一些路径表达式，以及这些表达式的结果：</span></div><table style="margin: 2px 0px 14px; width: auto; border-collapse: collapse; box-sizing: border-box;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody style="box-sizing: content-box;"><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 6px 14px 5px 12px; border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(114, 119, 123); border-bottom-color: rgb(114, 119, 123); border-left-color: rgb(114, 119, 123); border-image: initial; border-top-style: initial; border-top-color: initial; background-color: rgb(123, 129, 132);"><span style="font-size: 14px; color: rgb(255, 255, 255); font-weight: 300; line-height: 160%;">路径表达式</span></td><td style="box-sizing: content-box; padding: 6px 14px 5px 12px; border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(114, 119, 123); border-bottom-color: rgb(114, 119, 123); border-left-color: rgb(114, 119, 123); border-image: initial; border-top-style: initial; border-top-color: initial; background-color: rgb(123, 129, 132);"><span style="font-size: 14px; color: rgb(255, 255, 255); font-weight: 300; line-height: 160%;">结果</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">//book/title | //book/price</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取 book 元素的所有 title 和 price 元素。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">//title | //price</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取文档中的所有 title 和 price 元素。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">/bookstore/book/title | //price</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">选取属于 bookstore 元素的 book 元素的所有 title 元素，以及文档中所有的 price 元素。</span></td></tr></tbody></table><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">这些就是XPath的语法的常用内容</span></div><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; color: rgb(51, 51, 51); line-height: 160%;">XPath使用</span></h4><blockquote style="box-sizing: content-box; margin: 15px 0px; border-left: 4px solid rgb(221, 221, 221); padding: 0px 15px;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">pip3 install lxml</span></div></blockquote><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">之前我们使用正则提取到了百度贴吧美女吧的图片,现在我们使用xpath来试着做同样的事情</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">案例1</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：使用XPath的爬虫 现在我们用XPath来做一个简单的爬虫，我们尝试爬取某个贴吧里的所有帖子，并且将该这个帖子里每个楼层发布的图片下载到本地。</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">import requests</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">from lxml import etree</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">import json</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">class Tieba:</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">def __init__(self,tieba_name):</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">self.tieba_name = tieba_name #接收贴吧名</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#设置为手机端的UA,也可以是指为浏览器的UA</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">self.headers = {"User-Agent": "Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"}</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">def get_total_url_list(self):</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">'''获取所有的urllist'''</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">url = "https://tieba.baidu.com/f?kw="+self.tieba_name+"&amp;ie=utf-8&amp;pn={}&amp;"</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">url_list = []</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">for i in range(100): #通过循环拼接100个url</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">url_list.append(url.format(i*50))</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">return url_list #返回100个url的urllist</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">def parse_url(self,url):</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">'''一个发送请求，获取响应，同时etree处理html'''</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print("parsing url:",url)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">response = requests.get(url,headers=self.headers,timeout=10) #发送请求</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">html = response.content.decode() #获取html字符串</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">html = etree.HTML(html) #获取element 类型的html</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">return html</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">def get_title_href(self,url):</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">'''获取一个页面的title和href'''</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">html = self.parse_url(url)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">li_temp_list = html.xpath("//li[@]") #分组，按照li标签分组</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">total_items = []</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">for i in li_temp_list: #遍历分组</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">href = "https:"+i.xpath("./a/@href")[0] if len(i.xpath("./a/@href"))&gt;0 else None</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">text = i.xpath("./a/div[1]/span[1]/text()")</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">text = text[0] if len(text)&gt;0 else None</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">item = dict( #放入字典</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">href = href,</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">text = text</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">total_items.append(item)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">return total_items #返回一个页面所有的item</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">def get_img(self,url):</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">'''获取一个帖子里面的所有图片'''</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">html = self.parse_url(url) #返回elemet累心的html，具有xpath方法</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">img_list = html.xpath('//div[@data-]/@data-url')</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">img_list = [i.split("src=")[-1] for i in img_list] #提取图片的url</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">img_list = [requests.utils.unquote(i) for i in img_list]</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">return img_list</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">def save_item(self,item):</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">'''保存一个item'''</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">with open("teibatupian.txt","a") as f:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">f.write(json.dumps(item,ensure_ascii=False,indent=2))</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">f.write("\n")</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">def run(self):</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#1、找到了url规律，url list</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">url_list = self.get_total_url_list()</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">for url in url_list:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#2、遍历urllist 发送请求，获得响应，etree处理html</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;"># 3、提取title，href</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">total_item = self.get_title_href(url)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">for item in total_item:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">href = item["href"]</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">img_list = self.get_img(href) #获取到了帖子的图片列表</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">item["img"] = img_list</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;"># 4、保存到本地</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print(item)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">self.save_item(item)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">if __name__ == "__main__":</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">tieba = Tieba("美女")</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">tieba.run()</span></div><div><br/></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;"><img src="8.0%20XPath%E9%80%89%E6%8B%A9%E5%99%A8.resources/9AE8ABF8-067F-4D8E-801F-6B070FAEC9F5.png"/></span></div><hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; color: rgb(51, 51, 51); line-height: 160%;">作业练习一 ：</span></h4><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">获取微博 ‘成都七中食品’ 下所有的微博帖子，并将结果存储到mysql数据库</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;"><img src="8.0%20XPath%E9%80%89%E6%8B%A9%E5%99%A8.resources/Snip20190526_9.png" height="236" width="702"/></span></div><hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">案例2: 全站获取起点中文网所有书籍信息和章节内容</span></h3><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">主要流程思路如下：</span></div><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">step1</span></h3><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">请求书籍列表，获取书籍信息，提取书籍详情url地址</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">将书籍信息存入mysql数据库</span></div></li></ul><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">step2</span></h3><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">提取书籍写的章节列表，获取章节详情url地址，发起请求，解析提取章节详情内容</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">将章节信息存入mysql数据库</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">代码如下：</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">class QidianSpider(object):</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">def __init__(self):</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">pass</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">def start_request(self,url):</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">"""开始起始任务"""</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">headers = {</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.109 Safari/537.36',</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">}</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">response = requests.get(url,headers=headers)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">if response.status_code == 200:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print('请求成功')</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">self.parse_noval_data(response.text)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">def parse_noval_data(self,htmlData):</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">"""解析书籍详情内容"""</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">x_html = etree.HTML(htmlData)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">li_list = x_html.xpath('//ul[@]/li')</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print(len(li_list))</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">for li in li_list:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">book_info = {}</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#封面图片</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">book_info['coverImage'] = 'https:'+li.xpath('./div[@]//img/@src')[0]</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#标题</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">book_info['title'] = li.xpath('./div[@]/h4/a/text()')[0]</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#作者</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">book_info['author'] = li.xpath('.//p[@]/a[@][1]/text()')[0]</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#分类</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">book_info['type'] = li.xpath('.//p[@]/a[2]/text()')[0] + '|' + li.xpath('.//a[@]/text()')[0]</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#状态</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">book_info['status'] = li.xpath('.//p[@]/span/text()')[0]</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#描述</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">book_info['content'] = li.xpath('.//p[@]/text()')[0].replace(' ','').replace('\r','')</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print(book_info)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">insert_sql = """</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">INSERT INTO qi (%s)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">VALUES (%s)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">""" % (','.join(book_info.keys()), ','.join(['%s'] * len(book_info)))</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">try:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">cursor.execute(insert_sql,list(book_info.values()))</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">mysql_client.commit()</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">except Exception as err:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print(err)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">mysql_client.rollback()</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">detail_url = li.xpath('./div[@]/h4/a/@href')[0]</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">detail_url = 'https:'+detail_url+'#Catalog'</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">response_text = self.send_request(detail_url)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">self.parse_chpater_list(response_text)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">next_page = x_html.xpath('//a[@]/@href')</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">if len(next_page) &gt; 0:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#提取下一页，继续发起请求</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">next_page = 'https:' + next_page[0]</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">self.start_request(next_page)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">else:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print('获取完毕')</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">def send_request(self,url):</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">"""发送请求"""</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">headers = {</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.109 Safari/537.36',</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">}</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">response = requests.get(url=url,headers=headers,verify=True)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">if response.status_code == 200:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print('请求成功')</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">return response.text</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">def parse_chpater_list(self, html):</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">"""获取章节列表"""</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">x_html = etree.HTML(html)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">div_volume = x_html.xpath('.//div[@]')</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">if len(div_volume) &gt; 0:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print('静态')</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">for div in div_volume:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">isFree = div.xpath('./h3/span/text()')[0].replace(' ','')</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">if '免费' in isFree:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">chpater_lis = div.xpath('./ul[@]/li')</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">for chpater_li in chpater_lis:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">chpater_url = 'https:'+chpater_li.xpath('./a/@href')[0]</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">response_text = self.send_request(chpater_url)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">self.parse_chpater_detail(response_text)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">else:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print('动态加载,自己完成这部分代码')</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">def parse_chpater_detail(self, html):</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">"""解析章节详情内容"""</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">x_html = etree.HTML(html)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">chpaterInfo = {}</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;"># 章节标题</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">chpaterInfo['title'] = x_html.xpath('//h3[@]/text()')[0]</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#书籍名称</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">chpaterInfo['novalTitle'] = x_html.xpath('//div[@]/a[1]/text()')[0]</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#字数</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">chpaterInfo['number'] = x_html.xpath('//div[@]/i[1]/span/text()')[0]</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#发布时间</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">chpaterInfo['time'] = x_html.xpath('//div[@]/i[2]/span/text()')[0]</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#书籍内容</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">chpaterInfo['content'] = ''.join(x_html.xpath('//div[@]/p/text()')).replace('\u3000','').replace('\n','')</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print(chpaterInfo)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">insert_sql = """</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">INSERT INTO dian (%s)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">VALUES (%s)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">""" % (','.join(chpaterInfo.keys()), ','.join(['%s'] * len(chpaterInfo)))</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">try:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">cursor.execute(insert_sql, list(chpaterInfo.values()))</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">mysql_client.commit()</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">except Exception as err:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print(err)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">mysql_client.rollback()</span></div><div><br/></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">if __name__ == '__main__':</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#创建数据库链接</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">mysql_client = pymysql.Connect(</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">'localhost', 'root', 'wangshibo',</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">'qd', charset='utf8'</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#创建游标</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">cursor = mysql_client.cursor()</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#设置起始url</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">start_url = 'https://www.qidian.com/all?orderId=&amp;style=1&amp;pageSize=20&amp;siteid=1&amp;pubflag=0&amp;hiddenField=0&amp;page=1'</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">qidianspider = QidianSpider()</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">qidianspider.start_request(start_url)</span></div></div></div><hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">作业练习二 ：</span></h3><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">获取小说阅读网所有小说数据：</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">网址如下：</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">https://www.readnovel.com/all</span></div></div><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; color: rgb(51, 51, 51); line-height: 160%;">要求</span></h4><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">1.将小说信息存入一张表</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">2.小说的章节信息存入一张表，（添加外键，外键为书籍id）</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">获取数据字段如下：</span></div><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; color: rgb(51, 51, 51); line-height: 160%;">书籍信息：</span></h4><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;"><img src="8.0%20XPath%E9%80%89%E6%8B%A9%E5%99%A8.resources/Snip20190526_10.png" height="303" width="807"/></span></div><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; color: rgb(51, 51, 51); line-height: 160%;">章节信息</span></h4><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;"><img src="8.0%20XPath%E9%80%89%E6%8B%A9%E5%99%A8.resources/Snip20190526_13.png" height="469" width="849"/></span></div></div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%E6%AD%A3%E5%88%99%E7%94%A8%E7%9A%84%E4%B8%8D%E5%A5%BD%EF%BC%8C%E5%A4%84%E7%90%86HTML%E6%96%87%E6%A1%A3%E5%BE%88%E7%B4%AF%EF%BC%8C%E6%9C%89%E6%B2%A1%E6%9C%89%E5%85%B6%E4%BB%96%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%9F%0A%0A%23%23%23%20**%E4%BB%80%E4%B9%88%E6%98%AFXPath%EF%BC%9F**%0A-%20XPath%20(XML%20Path%20Language)%20%E6%98%AF%E4%B8%80%E9%97%A8%E5%9C%A8%20XML%20%E6%96%87%E6%A1%A3%E4%B8%AD%E6%9F%A5%E6%89%BE%E4%BF%A1%E6%81%AF%E7%9A%84%E8%AF%AD%E8%A8%80%EF%BC%8C%E5%8F%AF%E7%94%A8%E6%9D%A5%E5%9C%A8%20XML%20%E6%96%87%E6%A1%A3%E4%B8%AD%E5%AF%B9%E5%85%83%E7%B4%A0%E5%92%8C%E5%B1%9E%E6%80%A7%E8%BF%9B%E8%A1%8C%E9%81%8D%E5%8E%86%E3%80%82%0A%0A%23%23%23%23%20**%E4%BB%80%E4%B9%88%E6%98%AFXML%3F**%0A-%20XML%20%E6%8C%87%E5%8F%AF%E6%89%A9%E5%B1%95%E6%A0%87%E8%AE%B0%E8%AF%AD%E8%A8%80%EF%BC%88EXtensible%20Markup%20Language%EF%BC%89%0A-%20XML%20%E6%98%AF%E4%B8%80%E7%A7%8D%E6%A0%87%E8%AE%B0%E8%AF%AD%E8%A8%80%EF%BC%8C%E5%BE%88%E7%B1%BB%E4%BC%BC%20HTML%0A-%20XML%20%E7%9A%84%E8%AE%BE%E8%AE%A1%E5%AE%97%E6%97%A8%E6%98%AF%E4%BC%A0%E8%BE%93%E6%95%B0%E6%8D%AE%EF%BC%8C%E8%80%8C%E9%9D%9E%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%0A-%20XML%20%E7%9A%84%E6%A0%87%E7%AD%BE%E9%9C%80%E8%A6%81%E6%88%91%E4%BB%AC%E8%87%AA%E8%A1%8C%E5%AE%9A%E4%B9%89%E3%80%82%0A-%20XML%20%E8%A2%AB%E8%AE%BE%E8%AE%A1%E4%B8%BA%E5%85%B7%E6%9C%89%E8%87%AA%E6%88%91%E6%8F%8F%E8%BF%B0%E6%80%A7%E3%80%82%0A-%20XML%20%E6%98%AF%20W3C%20%E7%9A%84%E6%8E%A8%E8%8D%90%E6%A0%87%E5%87%86%0A%0A%0A**XML%20%E5%92%8C%20HTML%20%E7%9A%84%E5%8C%BA%E5%88%AB**%0A%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%09%7C%E6%8F%8F%E8%BF%B0%09%7C%E8%AE%BE%E8%AE%A1%E7%9B%AE%E6%A0%87%0A------%7C------%7C-----%0AXML%09%7CExtensible%20Markup%20Language%20%EF%BC%88%E5%8F%AF%E6%89%A9%E5%B1%95%E6%A0%87%E8%AE%B0%E8%AF%AD%E8%A8%80%EF%BC%89%7C%09%E8%A2%AB%E8%AE%BE%E8%AE%A1%E4%B8%BA%E4%BC%A0%E8%BE%93%E5%92%8C%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%85%B6%E7%84%A6%E7%82%B9%E6%98%AF%E6%95%B0%E6%8D%AE%E7%9A%84%E5%86%85%E5%AE%B9%E3%80%82%0AHTML%7C%09HyperText%20Markup%20Language%20%EF%BC%88%E8%B6%85%E6%96%87%E6%9C%AC%E6%A0%87%E8%AE%B0%E8%AF%AD%E8%A8%80%EF%BC%89%09%7C%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E6%9B%B4%E5%A5%BD%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E3%80%82%0AHTML%20DOM%7C%09Document%20Object%20Model%20for%20HTML%20(%E6%96%87%E6%A1%A3%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B)%09%7C%E9%80%9A%E8%BF%87%20HTML%20DOM%EF%BC%8C%E5%8F%AF%E4%BB%A5%E8%AE%BF%E9%97%AE%E6%89%80%E6%9C%89%E7%9A%84%20HTML%20%E5%85%83%E7%B4%A0%EF%BC%8C%E8%BF%9E%E5%90%8C%E5%AE%83%E4%BB%AC%E6%89%80%E5%8C%85%E5%90%AB%E7%9A%84%E6%96%87%E6%9C%AC%E5%92%8C%E5%B1%9E%E6%80%A7%E3%80%82%E5%8F%AF%E4%BB%A5%E5%AF%B9%E5%85%B6%E4%B8%AD%E7%9A%84%E5%86%85%E5%AE%B9%E8%BF%9B%E8%A1%8C%E4%BF%AE%E6%94%B9%E5%92%8C%E5%88%A0%E9%99%A4%EF%BC%8C%E5%90%8C%E6%97%B6%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E5%85%83%E7%B4%A0%E3%80%82%0A%0A%0A**XML%E6%96%87%E6%A1%A3%E7%A4%BA%E4%BE%8B**%0A%60%60%60%0A%3Cxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%0A%0A%3Cbookstore%3E%0A%0A%3Cbook%20category%3D%22cooking%22%3E%0A%20%20%20%20%3Ctitle%20lang%3D%22en%22%3EEveryday%20Italian%3C%2Ftitle%3E%20%20%0A%20%20%20%20%3Cauthor%3EGiada%20De%20Laurentiis%3C%2Fauthor%3E%20%20%0A%20%20%20%20%3Cyear%3E2005%3C%2Fyear%3E%20%20%0A%20%20%20%20%3Cprice%3E30.00%3C%2Fprice%3E%0A%3C%2Fbook%3E%20%20%0A%0A%3Cbook%20category%3D%22children%22%3E%0A%20%20%20%20%3Ctitle%20lang%3D%22en%22%3EHarry%20Potter%3C%2Ftitle%3E%20%20%0A%20%20%20%20%3Cauthor%3EJ%20K.%20Rowling%3C%2Fauthor%3E%20%20%0A%20%20%20%20%3Cyear%3E2005%3C%2Fyear%3E%20%20%0A%20%20%20%20%3Cprice%3E29.99%3C%2Fprice%3E%0A%3C%2Fbook%3E%20%0A%0A%3C%2Fbookstore%3E%0A%60%60%60%0A%0A**HTML%20DOM%20%E6%A8%A1%E5%9E%8B%E7%A4%BA%E4%BE%8B**%0A%0AHTML%20DOM%20%E5%AE%9A%E4%B9%89%E4%BA%86%E8%AE%BF%E9%97%AE%E5%92%8C%E6%93%8D%E4%BD%9C%20HTML%20%E6%96%87%E6%A1%A3%E7%9A%84%E6%A0%87%E5%87%86%E6%96%B9%E6%B3%95%EF%BC%8C%E4%BB%A5%E6%A0%91%E7%BB%93%E6%9E%84%E6%96%B9%E5%BC%8F%E8%A1%A8%E8%BE%BE%20HTML%20%E6%96%87%E6%A1%A3%E3%80%82%0A%0A!%5B2a3c0ab8-6e84-4049-8924-98d1e6b2ea5a%5D(https%3A%2F%2Fi.loli.net%2F2018%2F09%2F09%2F5b94707691609.gif)%0A%0A**%E4%BB%80%E4%B9%88%E6%98%AFXPath%EF%BC%9F**%0A-%20XPath%20(XML%20Path%20Language)%20%E6%98%AF%E4%B8%80%E9%97%A8%E5%9C%A8%20XML%20%E6%96%87%E6%A1%A3%E4%B8%AD%E6%9F%A5%E6%89%BE%E4%BF%A1%E6%81%AF%E7%9A%84%E8%AF%AD%E8%A8%80%EF%BC%8C%E5%8F%AF%E7%94%A8%E6%9D%A5%E5%9C%A8%20XML%20%E6%96%87%E6%A1%A3%E4%B8%AD%E5%AF%B9%E5%85%83%E7%B4%A0%E5%92%8C%E5%B1%9E%E6%80%A7%E8%BF%9B%E8%A1%8C%E9%81%8D%E5%8E%86%E3%80%82%0A%0AW3School%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%EF%BC%9Ahttp%3A%2F%2Fwww.w3school.com.cn%2Fxpath%2Findex.asp%0A%0A%0A%23%23%23%23%20**XPath%20%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7**%0A%0A-%20Chrome%E6%8F%92%E4%BB%B6%20XPath%20Helper%0A-%20Firefox%E6%8F%92%E4%BB%B6%20XPath%20Checker%0A%0A%23%23%23%23%20**%E9%80%89%E5%8F%96%E8%8A%82%E7%82%B9**%0A%0AXPath%20%E4%BD%BF%E7%94%A8%E8%B7%AF%E5%BE%84%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%9D%A5%E9%80%89%E5%8F%96%20XML%20%E6%96%87%E6%A1%A3%E4%B8%AD%E7%9A%84%E8%8A%82%E7%82%B9%E6%88%96%E8%80%85%E8%8A%82%E7%82%B9%E9%9B%86%E3%80%82%E8%BF%99%E4%BA%9B%E8%B7%AF%E5%BE%84%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%92%8C%E6%88%91%E4%BB%AC%E5%9C%A8%E5%B8%B8%E8%A7%84%E7%9A%84%E7%94%B5%E8%84%91%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9C%8B%E5%88%B0%E7%9A%84%E8%A1%A8%E8%BE%BE%E5%BC%8F%E9%9D%9E%E5%B8%B8%E7%9B%B8%E4%BC%BC%E3%80%82%0A%0A%0A%E4%B8%8B%E9%9D%A2%E5%88%97%E5%87%BA%E4%BA%86%E6%9C%80%E5%B8%B8%E7%94%A8%E7%9A%84%E8%B7%AF%E5%BE%84%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%9A%0A%0A%E8%A1%A8%E8%BE%BE%E5%BC%8F%7C%09%E6%8F%8F%E8%BF%B0%0A----%7C----%0Anodename%7C%09%E9%80%89%E5%8F%96%E6%AD%A4%E8%8A%82%E7%82%B9%E7%9A%84%E6%89%80%E6%9C%89%E5%AD%90%E8%8A%82%E7%82%B9%E3%80%82%0A%2F%09%7C%E4%BB%8E%E6%A0%B9%E8%8A%82%E7%82%B9%E9%80%89%E5%8F%96%E3%80%82%0A%2F%2F%09%7C%E4%BB%8E%E5%8C%B9%E9%85%8D%E9%80%89%E6%8B%A9%E7%9A%84%E5%BD%93%E5%89%8D%E8%8A%82%E7%82%B9%E9%80%89%E6%8B%A9%E6%96%87%E6%A1%A3%E4%B8%AD%E7%9A%84%E8%8A%82%E7%82%B9%EF%BC%8C%E8%80%8C%E4%B8%8D%E8%80%83%E8%99%91%E5%AE%83%E4%BB%AC%E7%9A%84%E4%BD%8D%E7%BD%AE%E3%80%82%0A.%09%7C%E9%80%89%E5%8F%96%E5%BD%93%E5%89%8D%E8%8A%82%E7%82%B9%E3%80%82%0A..%09%7C%E9%80%89%E5%8F%96%E5%BD%93%E5%89%8D%E8%8A%82%E7%82%B9%E7%9A%84%E7%88%B6%E8%8A%82%E7%82%B9%E3%80%82%0A%40%09%7C%E9%80%89%E5%8F%96%E5%B1%9E%E6%80%A7%E3%80%82%0A%0A-------------------------------%0A%0A%E5%9C%A8%E4%B8%8B%E9%9D%A2%E7%9A%84%E8%A1%A8%E6%A0%BC%E4%B8%AD%EF%BC%8C%E6%88%91%E4%BB%AC%E5%B7%B2%E5%88%97%E5%87%BA%E4%BA%86%E4%B8%80%E4%BA%9B%E8%B7%AF%E5%BE%84%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%BB%A5%E5%8F%8A%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E7%BB%93%E6%9E%9C%EF%BC%9A%0A%0A%E8%B7%AF%E5%BE%84%E8%A1%A8%E8%BE%BE%E5%BC%8F%7C%09%E7%BB%93%E6%9E%9C%0A-----%7C----%0Abookstore%09%7C%E9%80%89%E5%8F%96%20bookstore%20%E5%85%83%E7%B4%A0%E7%9A%84%E6%89%80%E6%9C%89%E5%AD%90%E8%8A%82%E7%82%B9%E3%80%82%0A%2Fbookstore%7C%09%E9%80%89%E5%8F%96%E6%A0%B9%E5%85%83%E7%B4%A0%20bookstore%E3%80%82%E6%B3%A8%E9%87%8A%EF%BC%9A%E5%81%87%E5%A6%82%E8%B7%AF%E5%BE%84%E8%B5%B7%E5%A7%8B%E4%BA%8E%E6%AD%A3%E6%96%9C%E6%9D%A0(%20%2F%20)%EF%BC%8C%E5%88%99%E6%AD%A4%E8%B7%AF%E5%BE%84%E5%A7%8B%E7%BB%88%E4%BB%A3%E8%A1%A8%E5%88%B0%E6%9F%90%E5%85%83%E7%B4%A0%E7%9A%84%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84%EF%BC%81%0Abookstore%2Fbook%09%7C%E9%80%89%E5%8F%96%E5%B1%9E%E4%BA%8E%20bookstore%20%E7%9A%84%E5%AD%90%E5%85%83%E7%B4%A0%E7%9A%84%E6%89%80%E6%9C%89%20book%20%E5%85%83%E7%B4%A0%E3%80%82%0A%2F%2Fbook%09%7C%E9%80%89%E5%8F%96%E6%89%80%E6%9C%89%20book%20%E5%AD%90%E5%85%83%E7%B4%A0%EF%BC%8C%E8%80%8C%E4%B8%8D%E7%AE%A1%E5%AE%83%E4%BB%AC%E5%9C%A8%E6%96%87%E6%A1%A3%E4%B8%AD%E7%9A%84%E4%BD%8D%E7%BD%AE%E3%80%82%0Abookstore%2F%2Fbook%09%7C%E9%80%89%E6%8B%A9%E5%B1%9E%E4%BA%8E%20bookstore%20%E5%85%83%E7%B4%A0%E7%9A%84%E5%90%8E%E4%BB%A3%E7%9A%84%E6%89%80%E6%9C%89%20book%20%E5%85%83%E7%B4%A0%EF%BC%8C%E8%80%8C%E4%B8%8D%E7%AE%A1%E5%AE%83%E4%BB%AC%E4%BD%8D%E4%BA%8E%20bookstore%20%E4%B9%8B%E4%B8%8B%E7%9A%84%E4%BB%80%E4%B9%88%E4%BD%8D%E7%BD%AE%E3%80%82%0A%2F%2F%40lang%09%7C%E9%80%89%E5%8F%96%E5%90%8D%E4%B8%BA%20lang%20%E7%9A%84%E6%89%80%E6%9C%89%E5%B1%9E%E6%80%A7%E3%80%82%0A%0A%0A%23%23%23%23%20**%E8%B0%93%E8%AF%AD%EF%BC%88Predicates%EF%BC%89**%0A%E8%B0%93%E8%AF%AD%E7%94%A8%E6%9D%A5%E6%9F%A5%E6%89%BE%E6%9F%90%E4%B8%AA%E7%89%B9%E5%AE%9A%E7%9A%84%E8%8A%82%E7%82%B9%E6%88%96%E8%80%85%E5%8C%85%E5%90%AB%E6%9F%90%E4%B8%AA%E6%8C%87%E5%AE%9A%E7%9A%84%E5%80%BC%E7%9A%84%E8%8A%82%E7%82%B9%EF%BC%8C%E8%A2%AB%E5%B5%8C%E5%9C%A8%E6%96%B9%E6%8B%AC%E5%8F%B7%E4%B8%AD%E3%80%82%0A%0A%E5%9C%A8%E4%B8%8B%E9%9D%A2%E7%9A%84%E8%A1%A8%E6%A0%BC%E4%B8%AD%EF%BC%8C%E6%88%91%E4%BB%AC%E5%88%97%E5%87%BA%E4%BA%86%E5%B8%A6%E6%9C%89%E8%B0%93%E8%AF%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E8%B7%AF%E5%BE%84%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%8C%E4%BB%A5%E5%8F%8A%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E7%BB%93%E6%9E%9C%EF%BC%9A%0A%0A%E8%B7%AF%E5%BE%84%E8%A1%A8%E8%BE%BE%E5%BC%8F%7C%09%E7%BB%93%E6%9E%9C%0A-----%7C-----%0A%2Fbookstore%2Fbook%5B1%5D%09%7C%E9%80%89%E5%8F%96%E5%B1%9E%E4%BA%8E%20bookstore%20%E5%AD%90%E5%85%83%E7%B4%A0%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%20book%20%E5%85%83%E7%B4%A0%E3%80%82%0A%2Fbookstore%2Fbook%5Blast()%5D%09%7C%E9%80%89%E5%8F%96%E5%B1%9E%E4%BA%8E%20bookstore%20%E5%AD%90%E5%85%83%E7%B4%A0%E7%9A%84%E6%9C%80%E5%90%8E%E4%B8%80%E4%B8%AA%20book%20%E5%85%83%E7%B4%A0%E3%80%82%0A%2Fbookstore%2Fbook%5Blast()-1%5D%09%7C%E9%80%89%E5%8F%96%E5%B1%9E%E4%BA%8E%20bookstore%20%E5%AD%90%E5%85%83%E7%B4%A0%E7%9A%84%E5%80%92%E6%95%B0%E7%AC%AC%E4%BA%8C%E4%B8%AA%20book%20%E5%85%83%E7%B4%A0%E3%80%82%0A%2Fbookstore%2Fbook%5Bposition()%20%3C%203%5D%7C%09%E9%80%89%E5%8F%96%E6%9C%80%E5%89%8D%E9%9D%A2%E7%9A%84%E4%B8%A4%E4%B8%AA%E5%B1%9E%E4%BA%8E%20bookstore%20%E5%85%83%E7%B4%A0%E7%9A%84%E5%AD%90%E5%85%83%E7%B4%A0%E7%9A%84%20book%20%E5%85%83%E7%B4%A0%E3%80%82%0A%2F%2Ftitle%5B%40lang%5D%7C%09%E9%80%89%E5%8F%96%E6%89%80%E6%9C%89%E6%8B%A5%E6%9C%89%E5%90%8D%E4%B8%BA%20lang%20%E7%9A%84%E5%B1%9E%E6%80%A7%E7%9A%84%20title%20%E5%85%83%E7%B4%A0%E3%80%82%0A%2F%2Ftitle%5B%40lang%3D%E2%80%99eng%E2%80%99%5D%7C%09%E9%80%89%E5%8F%96%E6%89%80%E6%9C%89%20title%20%E5%85%83%E7%B4%A0%EF%BC%8C%E4%B8%94%E8%BF%99%E4%BA%9B%E5%85%83%E7%B4%A0%E6%8B%A5%E6%9C%89%E5%80%BC%E4%B8%BA%20eng%20%E7%9A%84%20lang%20%E5%B1%9E%E6%80%A7%E3%80%82%0A%0A%0A%23%23%23%23%20**%E9%80%89%E5%8F%96%E6%9C%AA%E7%9F%A5%E8%8A%82%E7%82%B9**%0AXPath%20%E9%80%9A%E9%85%8D%E7%AC%A6%E5%8F%AF%E7%94%A8%E6%9D%A5%E9%80%89%E5%8F%96%E6%9C%AA%E7%9F%A5%E7%9A%84%20XML%20%E5%85%83%E7%B4%A0%E3%80%82%0A%0A%E9%80%9A%E9%85%8D%E7%AC%A6%7C%09%E6%8F%8F%E8%BF%B0%0A------%7C-----%0A*%09%7C%E5%8C%B9%E9%85%8D%E4%BB%BB%E4%BD%95%E5%85%83%E7%B4%A0%E8%8A%82%E7%82%B9%E3%80%82%0A%40*%7C%09%E5%8C%B9%E9%85%8D%E4%BB%BB%E4%BD%95%E5%B1%9E%E6%80%A7%E8%8A%82%E7%82%B9%E3%80%82%0Anode()%7C%09%E5%8C%B9%E9%85%8D%E4%BB%BB%E4%BD%95%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%8A%82%E7%82%B9%E3%80%82%0A%0A%E8%B7%AF%E5%BE%84%E8%A1%A8%E8%BE%BE%E5%BC%8F%7C%09%E7%BB%93%E6%9E%9C%0A-----%7C-----%0A%2Fbookstore%2F*%09%7C%E9%80%89%E5%8F%96%20bookstore%20%E5%85%83%E7%B4%A0%E7%9A%84%E6%89%80%E6%9C%89%E5%AD%90%E5%85%83%E7%B4%A0%E3%80%82%0A%2F%2F*%09%7C%E9%80%89%E5%8F%96%E6%96%87%E6%A1%A3%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E5%85%83%E7%B4%A0%E3%80%82%0Ahtml%2Fnode()%2Fmeta%2F%40*%09%7C%E9%80%89%E6%8B%A9html%E4%B8%8B%E9%9D%A2%E4%BB%BB%E6%84%8F%E8%8A%82%E7%82%B9%E4%B8%8B%E7%9A%84meta%E8%8A%82%E7%82%B9%E7%9A%84%E6%89%80%E6%9C%89%E5%B1%9E%E6%80%A7%0A%2F%2Ftitle%5B%40*%5D%09%7C%E9%80%89%E5%8F%96%E6%89%80%E6%9C%89%E5%B8%A6%E6%9C%89%E5%B1%9E%E6%80%A7%E7%9A%84%20title%20%E5%85%83%E7%B4%A0%E3%80%82%0A%0A%23%23%23%23%20**%E9%80%89%E5%8F%96%E8%8B%A5%E5%B9%B2%E8%B7%AF%E5%BE%84**%0A%E9%80%9A%E8%BF%87%E5%9C%A8%E8%B7%AF%E5%BE%84%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%AD%E4%BD%BF%E7%94%A8%E2%80%9C%7C%E2%80%9D%E8%BF%90%E7%AE%97%E7%AC%A6%EF%BC%8C%E6%82%A8%E5%8F%AF%E4%BB%A5%E9%80%89%E5%8F%96%E8%8B%A5%E5%B9%B2%E4%B8%AA%E8%B7%AF%E5%BE%84%E3%80%82%0A%0A%E5%AE%9E%E4%BE%8B%0A%0A%E5%9C%A8%E4%B8%8B%E9%9D%A2%E7%9A%84%E8%A1%A8%E6%A0%BC%E4%B8%AD%EF%BC%8C%E6%88%91%E4%BB%AC%E5%88%97%E5%87%BA%E4%BA%86%E4%B8%80%E4%BA%9B%E8%B7%AF%E5%BE%84%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%8C%E4%BB%A5%E5%8F%8A%E8%BF%99%E4%BA%9B%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E7%BB%93%E6%9E%9C%EF%BC%9A%0A%0A%E8%B7%AF%E5%BE%84%E8%A1%A8%E8%BE%BE%E5%BC%8F%7C%09%E7%BB%93%E6%9E%9C%0A-----%7C-----%0A%2F%2Fbook%2Ftitle%20%5C%7C%20%2F%2Fbook%2Fprice%09%7C%E9%80%89%E5%8F%96%20book%20%E5%85%83%E7%B4%A0%E7%9A%84%E6%89%80%E6%9C%89%20title%20%E5%92%8C%20price%20%E5%85%83%E7%B4%A0%E3%80%82%0A%2F%2Ftitle%20%5C%7C%20%2F%2Fprice%09%7C%E9%80%89%E5%8F%96%E6%96%87%E6%A1%A3%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%20title%20%E5%92%8C%20price%20%E5%85%83%E7%B4%A0%E3%80%82%0A%2Fbookstore%2Fbook%2Ftitle%20%5C%7C%20%2F%2Fprice%09%7C%E9%80%89%E5%8F%96%E5%B1%9E%E4%BA%8E%20bookstore%20%E5%85%83%E7%B4%A0%E7%9A%84%20book%20%E5%85%83%E7%B4%A0%E7%9A%84%E6%89%80%E6%9C%89%20title%20%E5%85%83%E7%B4%A0%EF%BC%8C%E4%BB%A5%E5%8F%8A%E6%96%87%E6%A1%A3%E4%B8%AD%E6%89%80%E6%9C%89%E7%9A%84%20price%20%E5%85%83%E7%B4%A0%E3%80%82%0A%0A%E8%BF%99%E4%BA%9B%E5%B0%B1%E6%98%AFXPath%E7%9A%84%E8%AF%AD%E6%B3%95%E7%9A%84%E5%B8%B8%E7%94%A8%E5%86%85%E5%AE%B9%0A%0A%0A%23%23%23%23%20XPath%E4%BD%BF%E7%94%A8%0A%0A%3E%20pip3%20install%20lxml%0A%0A%E4%B9%8B%E5%89%8D%E6%88%91%E4%BB%AC%E4%BD%BF%E7%94%A8%E6%AD%A3%E5%88%99%E6%8F%90%E5%8F%96%E5%88%B0%E4%BA%86%E7%99%BE%E5%BA%A6%E8%B4%B4%E5%90%A7%E7%BE%8E%E5%A5%B3%E5%90%A7%E7%9A%84%E5%9B%BE%E7%89%87%2C%E7%8E%B0%E5%9C%A8%E6%88%91%E4%BB%AC%E4%BD%BF%E7%94%A8xpath%E6%9D%A5%E8%AF%95%E7%9D%80%E5%81%9A%E5%90%8C%E6%A0%B7%E7%9A%84%E4%BA%8B%E6%83%85%0A%0A**%E6%A1%88%E4%BE%8B1**%EF%BC%9A%E4%BD%BF%E7%94%A8XPath%E7%9A%84%E7%88%AC%E8%99%AB%20%E7%8E%B0%E5%9C%A8%E6%88%91%E4%BB%AC%E7%94%A8XPath%E6%9D%A5%E5%81%9A%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E7%88%AC%E8%99%AB%EF%BC%8C%E6%88%91%E4%BB%AC%E5%B0%9D%E8%AF%95%E7%88%AC%E5%8F%96%E6%9F%90%E4%B8%AA%E8%B4%B4%E5%90%A7%E9%87%8C%E7%9A%84%E6%89%80%E6%9C%89%E5%B8%96%E5%AD%90%EF%BC%8C%E5%B9%B6%E4%B8%94%E5%B0%86%E8%AF%A5%E8%BF%99%E4%B8%AA%E5%B8%96%E5%AD%90%E9%87%8C%E6%AF%8F%E4%B8%AA%E6%A5%BC%E5%B1%82%E5%8F%91%E5%B8%83%E7%9A%84%E5%9B%BE%E7%89%87%E4%B8%8B%E8%BD%BD%E5%88%B0%E6%9C%AC%E5%9C%B0%E3%80%82%0A%0A%60%60%60%0Aimport%20requests%0Afrom%20lxml%20import%20etree%0Aimport%20json%0A%0Aclass%20Tieba%3A%0A%0A%20%20%20%20def%20__init__(self%2Ctieba_name)%3A%0A%20%20%20%20%20%20%20%20self.tieba_name%20%3D%20tieba_name%20%23%E6%8E%A5%E6%94%B6%E8%B4%B4%E5%90%A7%E5%90%8D%0A%20%20%20%20%20%20%20%20%23%E8%AE%BE%E7%BD%AE%E4%B8%BA%E6%89%8B%E6%9C%BA%E7%AB%AF%E7%9A%84UA%2C%E4%B9%9F%E5%8F%AF%E4%BB%A5%E6%98%AF%E6%8C%87%E4%B8%BA%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84UA%0A%20%20%20%20%20%20%20%20self.headers%20%3D%20%7B%22User-Agent%22%3A%20%22Mozilla%2F5.0%20(iPhone%3B%20CPU%20iPhone%20OS%209_1%20like%20Mac%20OS%20X)%20AppleWebKit%2F601.1.46%20(KHTML%2C%20like%20Gecko)%20Version%2F9.0%20Mobile%2F13B143%20Safari%2F601.1%22%7D%0A%0A%20%20%20%20def%20get_total_url_list(self)%3A%0A%20%20%20%20%20%20%20%20'''%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E7%9A%84urllist'''%0A%20%20%20%20%20%20%20%20url%20%3D%20%22https%3A%2F%2Ftieba.baidu.com%2Ff%3Fkw%3D%22%2Bself.tieba_name%2B%22%26ie%3Dutf-8%26pn%3D%7B%7D%26%22%0A%20%20%20%20%20%20%20%20url_list%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20i%20in%20range(100)%3A%20%23%E9%80%9A%E8%BF%87%E5%BE%AA%E7%8E%AF%E6%8B%BC%E6%8E%A5100%E4%B8%AAurl%0A%20%20%20%20%20%20%20%20%20%20%20%20url_list.append(url.format(i*50))%0A%20%20%20%20%20%20%20%20return%20url_list%20%23%E8%BF%94%E5%9B%9E100%E4%B8%AAurl%E7%9A%84urllist%0A%0A%20%20%20%20def%20parse_url(self%2Curl)%3A%0A%20%20%20%20%20%20%20%20'''%E4%B8%80%E4%B8%AA%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82%EF%BC%8C%E8%8E%B7%E5%8F%96%E5%93%8D%E5%BA%94%EF%BC%8C%E5%90%8C%E6%97%B6etree%E5%A4%84%E7%90%86html'''%0A%20%20%20%20%20%20%20%20print(%22parsing%20url%3A%22%2Curl)%0A%20%20%20%20%20%20%20%20response%20%3D%20requests.get(url%2Cheaders%3Dself.headers%2Ctimeout%3D10)%20%23%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82%0A%20%20%20%20%20%20%20%20html%20%3D%20response.content.decode()%20%23%E8%8E%B7%E5%8F%96html%E5%AD%97%E7%AC%A6%E4%B8%B2%0A%20%20%20%20%20%20%20%20html%20%3D%20etree.HTML(html)%20%23%E8%8E%B7%E5%8F%96element%20%E7%B1%BB%E5%9E%8B%E7%9A%84html%0A%20%20%20%20%20%20%20%20return%20html%0A%0A%20%20%20%20def%20get_title_href(self%2Curl)%3A%0A%20%20%20%20%20%20%20%20'''%E8%8E%B7%E5%8F%96%E4%B8%80%E4%B8%AA%E9%A1%B5%E9%9D%A2%E7%9A%84title%E5%92%8Chref'''%0A%20%20%20%20%20%20%20%20html%20%3D%20self.parse_url(url)%0A%20%20%20%20%20%20%20%20li_temp_list%20%3D%20html.xpath(%22%2F%2Fli%5B%40class%3D'tl_shadow'%5D%22)%20%23%E5%88%86%E7%BB%84%EF%BC%8C%E6%8C%89%E7%85%A7li%E6%A0%87%E7%AD%BE%E5%88%86%E7%BB%84%0A%20%20%20%20%20%20%20%20total_items%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20i%20in%20li_temp_list%3A%20%23%E9%81%8D%E5%8E%86%E5%88%86%E7%BB%84%0A%20%20%20%20%20%20%20%20%20%20%20%20href%20%3D%20%22https%3A%22%2Bi.xpath(%22.%2Fa%2F%40href%22)%5B0%5D%20if%20len(i.xpath(%22.%2Fa%2F%40href%22))%3E0%20else%20None%0A%20%20%20%20%20%20%20%20%20%20%20%20text%20%3D%20i.xpath(%22.%2Fa%2Fdiv%5B1%5D%2Fspan%5B1%5D%2Ftext()%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20text%20%3D%20text%5B0%5D%20if%20len(text)%3E0%20else%20None%0A%20%20%20%20%20%20%20%20%20%20%20%20item%20%3D%20dict(%20%20%23%E6%94%BE%E5%85%A5%E5%AD%97%E5%85%B8%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20href%20%3D%20href%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%20%3D%20text%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20total_items.append(item)%0A%20%20%20%20%20%20%20%20return%20total_items%20%23%E8%BF%94%E5%9B%9E%E4%B8%80%E4%B8%AA%E9%A1%B5%E9%9D%A2%E6%89%80%E6%9C%89%E7%9A%84item%0A%0A%20%20%20%20def%20get_img(self%2Curl)%3A%0A%20%20%20%20%20%20%20%20'''%E8%8E%B7%E5%8F%96%E4%B8%80%E4%B8%AA%E5%B8%96%E5%AD%90%E9%87%8C%E9%9D%A2%E7%9A%84%E6%89%80%E6%9C%89%E5%9B%BE%E7%89%87'''%0A%20%20%20%20%20%20%20%20html%20%3D%20self.parse_url(url)%20%23%E8%BF%94%E5%9B%9Eelemet%E7%B4%AF%E5%BF%83%E7%9A%84html%EF%BC%8C%E5%85%B7%E6%9C%89xpath%E6%96%B9%E6%B3%95%0A%20%20%20%20%20%20%20%20img_list%20%3D%20html.xpath('%2F%2Fdiv%5B%40data-class%3D%22BDE_Image%22%5D%2F%40data-url')%0A%20%20%20%20%20%20%20%20img_list%20%3D%20%5Bi.split(%22src%3D%22)%5B-1%5D%20for%20i%20in%20img_list%5D%20%23%E6%8F%90%E5%8F%96%E5%9B%BE%E7%89%87%E7%9A%84url%0A%20%20%20%20%20%20%20%20img_list%20%3D%20%5Brequests.utils.unquote(i)%20for%20i%20in%20img_list%5D%0A%20%20%20%20%20%20%20%20return%20img_list%0A%0A%20%20%20%20def%20save_item(self%2Citem)%3A%0A%20%20%20%20%20%20%20%20'''%E4%BF%9D%E5%AD%98%E4%B8%80%E4%B8%AAitem'''%0A%20%20%20%20%20%20%20%20with%20open(%22teibatupian.txt%22%2C%22a%22)%20as%20f%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20f.write(json.dumps(item%2Censure_ascii%3DFalse%2Cindent%3D2))%0A%20%20%20%20%20%20%20%20%20%20%20%20f.write(%22%5Cn%22)%0A%0A%20%20%20%20def%20run(self)%3A%0A%20%20%20%20%20%20%20%20%231%E3%80%81%E6%89%BE%E5%88%B0%E4%BA%86url%E8%A7%84%E5%BE%8B%EF%BC%8Curl%20list%0A%20%20%20%20%20%20%20%20url_list%20%3D%20self.get_total_url_list()%0A%20%20%20%20%20%20%20%20for%20url%20in%20url_list%3A%0A%20%20%20%20%20%20%20%20%232%E3%80%81%E9%81%8D%E5%8E%86urllist%20%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82%EF%BC%8C%E8%8E%B7%E5%BE%97%E5%93%8D%E5%BA%94%EF%BC%8Cetree%E5%A4%84%E7%90%86html%0A%20%20%20%20%20%20%20%20%23%203%E3%80%81%E6%8F%90%E5%8F%96title%EF%BC%8Chref%0A%20%20%20%20%20%20%20%20%20%20%20%20total_item%20%3D%20self.get_title_href(url)%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20item%20in%20total_item%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20href%20%3D%20item%5B%22href%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20img_list%20%3D%20self.get_img(href)%20%23%E8%8E%B7%E5%8F%96%E5%88%B0%E4%BA%86%E5%B8%96%E5%AD%90%E7%9A%84%E5%9B%BE%E7%89%87%E5%88%97%E8%A1%A8%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20item%5B%22img%22%5D%20%3D%20img_list%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%204%E3%80%81%E4%BF%9D%E5%AD%98%E5%88%B0%E6%9C%AC%E5%9C%B0%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(item)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.save_item(item)%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20%20%20%20%20tieba%20%3D%20Tieba(%22%E7%BE%8E%E5%A5%B3%22)%0A%20%20%20%20%20%20%20%20tieba.run()%0A%0A%60%60%60%0A%0A!%5Bmeinvba_links.png%5D(https%3A%2F%2Fi.loli.net%2F2018%2F09%2F09%2F5b9484d1dbf86.png)%0A%0A%0A-----------------------------------%0A%0A%0A%23%23%23%23%20%E4%BD%9C%E4%B8%9A%E7%BB%83%E4%B9%A0%E4%B8%80%20%EF%BC%9A%0A%0A%E8%8E%B7%E5%8F%96%E5%BE%AE%E5%8D%9A%20%E2%80%98%E6%88%90%E9%83%BD%E4%B8%83%E4%B8%AD%E9%A3%9F%E5%93%81%E2%80%99%20%E4%B8%8B%E6%89%80%E6%9C%89%E7%9A%84%E5%BE%AE%E5%8D%9A%E5%B8%96%E5%AD%90%EF%BC%8C%E5%B9%B6%E5%B0%86%E7%BB%93%E6%9E%9C%E5%AD%98%E5%82%A8%E5%88%B0mysql%E6%95%B0%E6%8D%AE%E5%BA%93%0A%0A!%5B5f15a1a1158b12a0506e5ddf9e6748e2.png%5D(evernotecid%3A%2F%2FDE21829F-6D00-46F2-8456-1D207C38642D%2Fappyinxiangcom%2F19277208%2FENResource%2Fp2325)%0A%0A%0A-----------------------------------%0A%0A%23%23%23%20%E6%A1%88%E4%BE%8B2%3A%20%E5%85%A8%E7%AB%99%E8%8E%B7%E5%8F%96%E8%B5%B7%E7%82%B9%E4%B8%AD%E6%96%87%E7%BD%91%E6%89%80%E6%9C%89%E4%B9%A6%E7%B1%8D%E4%BF%A1%E6%81%AF%E5%92%8C%E7%AB%A0%E8%8A%82%E5%86%85%E5%AE%B9%0A%E4%B8%BB%E8%A6%81%E6%B5%81%E7%A8%8B%E6%80%9D%E8%B7%AF%E5%A6%82%E4%B8%8B%EF%BC%9A%0A%0A%23%23%23%20step1%0A-%20%E8%AF%B7%E6%B1%82%E4%B9%A6%E7%B1%8D%E5%88%97%E8%A1%A8%EF%BC%8C%E8%8E%B7%E5%8F%96%E4%B9%A6%E7%B1%8D%E4%BF%A1%E6%81%AF%EF%BC%8C%E6%8F%90%E5%8F%96%E4%B9%A6%E7%B1%8D%E8%AF%A6%E6%83%85url%E5%9C%B0%E5%9D%80%0A-%20%E5%B0%86%E4%B9%A6%E7%B1%8D%E4%BF%A1%E6%81%AF%E5%AD%98%E5%85%A5mysql%E6%95%B0%E6%8D%AE%E5%BA%93%0A%0A%23%23%23%20step2%0A-%20%E6%8F%90%E5%8F%96%E4%B9%A6%E7%B1%8D%E5%86%99%E7%9A%84%E7%AB%A0%E8%8A%82%E5%88%97%E8%A1%A8%EF%BC%8C%E8%8E%B7%E5%8F%96%E7%AB%A0%E8%8A%82%E8%AF%A6%E6%83%85url%E5%9C%B0%E5%9D%80%EF%BC%8C%E5%8F%91%E8%B5%B7%E8%AF%B7%E6%B1%82%EF%BC%8C%E8%A7%A3%E6%9E%90%E6%8F%90%E5%8F%96%E7%AB%A0%E8%8A%82%E8%AF%A6%E6%83%85%E5%86%85%E5%AE%B9%0A-%20%E5%B0%86%E7%AB%A0%E8%8A%82%E4%BF%A1%E6%81%AF%E5%AD%98%E5%85%A5mysql%E6%95%B0%E6%8D%AE%E5%BA%93%0A%0A%0A%0A%E4%BB%A3%E7%A0%81%E5%A6%82%E4%B8%8B%EF%BC%9A%0A%0A%60%60%60%0Aclass%20QidianSpider(object)%3A%0A%0A%20%20%20%20def%20__init__(self)%3A%0A%20%20%20%20%20%20%20%20pass%0A%0A%20%20%20%20def%20start_request(self%2Curl)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%E5%BC%80%E5%A7%8B%E8%B5%B7%E5%A7%8B%E4%BB%BB%E5%8A%A1%22%22%22%0A%20%20%20%20%20%20%20%20headers%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20'User-Agent'%3A'Mozilla%2F5.0%20(Macintosh%3B%20Intel%20Mac%20OS%20X%2010_13_6)%20AppleWebKit%2F537.36%20(KHTML%2C%20like%20Gecko)%20Chrome%2F72.0.3626.109%20Safari%2F537.36'%2C%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20response%20%3D%20requests.get(url%2Cheaders%3Dheaders)%0A%20%20%20%20%20%20%20%20if%20response.status_code%20%3D%3D%20200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print('%E8%AF%B7%E6%B1%82%E6%88%90%E5%8A%9F')%0A%20%20%20%20%20%20%20%20%20%20%20%20self.parse_noval_data(response.text)%0A%0A%20%20%20%20def%20parse_noval_data(self%2ChtmlData)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%E8%A7%A3%E6%9E%90%E4%B9%A6%E7%B1%8D%E8%AF%A6%E6%83%85%E5%86%85%E5%AE%B9%22%22%22%0A%20%20%20%20%20%20%20%20x_html%20%3D%20etree.HTML(htmlData)%0A%20%20%20%20%20%20%20%20li_list%20%3D%20x_html.xpath('%2F%2Ful%5B%40class%3D%22all-img-list%20cf%22%5D%2Fli')%0A%20%20%20%20%20%20%20%20print(len(li_list))%0A%20%20%20%20%20%20%20%20for%20li%20in%20li_list%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20book_info%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%E5%B0%81%E9%9D%A2%E5%9B%BE%E7%89%87%0A%20%20%20%20%20%20%20%20%20%20%20%20book_info%5B'coverImage'%5D%20%3D%20'https%3A'%2Bli.xpath('.%2Fdiv%5B%40class%3D%22book-img-box%22%5D%2F%2Fimg%2F%40src')%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%E6%A0%87%E9%A2%98%0A%20%20%20%20%20%20%20%20%20%20%20%20book_info%5B'title'%5D%20%3D%20li.xpath('.%2Fdiv%5B%40class%3D%22book-mid-info%22%5D%2Fh4%2Fa%2Ftext()')%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%E4%BD%9C%E8%80%85%0A%20%20%20%20%20%20%20%20%20%20%20%20book_info%5B'author'%5D%20%3D%20li.xpath('.%2F%2Fp%5B%40class%3D%22author%22%5D%2Fa%5B%40class%3D%22name%22%5D%5B1%5D%2Ftext()')%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%E5%88%86%E7%B1%BB%0A%20%20%20%20%20%20%20%20%20%20%20%20book_info%5B'type'%5D%20%3D%20li.xpath('.%2F%2Fp%5B%40class%3D%22author%22%5D%2Fa%5B2%5D%2Ftext()')%5B0%5D%20%2B%20'%7C'%20%2B%20li.xpath('.%2F%2Fa%5B%40class%3D%22go-sub-type%22%5D%2Ftext()')%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%E7%8A%B6%E6%80%81%0A%20%20%20%20%20%20%20%20%20%20%20%20book_info%5B'status'%5D%20%3D%20li.xpath('.%2F%2Fp%5B%40class%3D%22author%22%5D%2Fspan%2Ftext()')%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%E6%8F%8F%E8%BF%B0%0A%20%20%20%20%20%20%20%20%20%20%20%20book_info%5B'content'%5D%20%3D%20li.xpath('.%2F%2Fp%5B%40class%3D%22intro%22%5D%2Ftext()')%5B0%5D.replace('%20'%2C'').replace('%5Cr'%2C'')%0A%20%20%20%20%20%20%20%20%20%20%20%20print(book_info)%0A%20%20%20%20%20%20%20%20%20%20%20%20insert_sql%20%3D%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20INSERT%20INTO%20qi%20(%25s)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20VALUES%20(%25s)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%20%25%20('%2C'.join(book_info.keys())%2C%20'%2C'.join(%5B'%25s'%5D%20*%20len(book_info)))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cursor.execute(insert_sql%2Clist(book_info.values()))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mysql_client.commit()%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%20as%20err%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(err)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mysql_client.rollback()%0A%20%20%20%20%20%20%20%20%20%20%20%20detail_url%20%3D%20li.xpath('.%2Fdiv%5B%40class%3D%22book-mid-info%22%5D%2Fh4%2Fa%2F%40href')%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20detail_url%20%3D%20'https%3A'%2Bdetail_url%2B'%23Catalog'%0A%20%20%20%20%20%20%20%20%20%20%20%20response_text%20%3D%20self.send_request(detail_url)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.parse_chpater_list(response_text)%0A%20%20%20%20%20%20%20%20next_page%20%3D%20x_html.xpath('%2F%2Fa%5B%40class%3D%22lbf-pagination-next%20%22%5D%2F%40href')%0A%0A%20%20%20%20%20%20%20%20if%20len(next_page)%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%E6%8F%90%E5%8F%96%E4%B8%8B%E4%B8%80%E9%A1%B5%EF%BC%8C%E7%BB%A7%E7%BB%AD%E5%8F%91%E8%B5%B7%E8%AF%B7%E6%B1%82%0A%20%20%20%20%20%20%20%20%20%20%20%20next_page%20%3D%20'https%3A'%20%2B%20next_page%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20self.start_request(next_page)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print('%E8%8E%B7%E5%8F%96%E5%AE%8C%E6%AF%95')%0A%0A%20%20%20%20def%20send_request(self%2Curl)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82%22%22%22%0A%20%20%20%20%20%20%20%20headers%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20'User-Agent'%3A'Mozilla%2F5.0%20(Macintosh%3B%20Intel%20Mac%20OS%20X%2010_13_6)%20AppleWebKit%2F537.36%20(KHTML%2C%20like%20Gecko)%20Chrome%2F72.0.3626.109%20Safari%2F537.36'%2C%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20response%20%3D%20requests.get(url%3Durl%2Cheaders%3Dheaders%2Cverify%3DTrue)%0A%20%20%20%20%20%20%20%20if%20response.status_code%20%3D%3D%20200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print('%E8%AF%B7%E6%B1%82%E6%88%90%E5%8A%9F')%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20response.text%0A%0A%20%20%20%20def%20parse_chpater_list(self%2C%20html)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%E8%8E%B7%E5%8F%96%E7%AB%A0%E8%8A%82%E5%88%97%E8%A1%A8%22%22%22%0A%20%20%20%20%20%20%20%20x_html%20%3D%20etree.HTML(html)%0A%20%20%20%20%20%20%20%20div_volume%20%3D%20x_html.xpath('.%2F%2Fdiv%5B%40class%3D%22volume%22%5D')%0A%20%20%20%20%20%20%20%20if%20len(div_volume)%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print('%E9%9D%99%E6%80%81')%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20div%20in%20div_volume%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20isFree%20%3D%20div.xpath('.%2Fh3%2Fspan%2Ftext()')%5B0%5D.replace('%20'%2C'')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20'%E5%85%8D%E8%B4%B9'%20in%20isFree%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20chpater_lis%20%3D%20div.xpath('.%2Ful%5B%40class%3D%22cf%22%5D%2Fli')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20chpater_li%20in%20chpater_lis%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20chpater_url%20%3D%20'https%3A'%2Bchpater_li.xpath('.%2Fa%2F%40href')%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20response_text%20%3D%20self.send_request(chpater_url)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.parse_chpater_detail(response_text)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print('%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%2C%E8%87%AA%E5%B7%B1%E5%AE%8C%E6%88%90%E8%BF%99%E9%83%A8%E5%88%86%E4%BB%A3%E7%A0%81')%0A%0A%20%20%20%20def%20parse_chpater_detail(self%2C%20html)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%E8%A7%A3%E6%9E%90%E7%AB%A0%E8%8A%82%E8%AF%A6%E6%83%85%E5%86%85%E5%AE%B9%22%22%22%0A%20%20%20%20%20%20%20%20x_html%20%3D%20etree.HTML(html)%0A%20%20%20%20%20%20%20%20chpaterInfo%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20%23%20%E7%AB%A0%E8%8A%82%E6%A0%87%E9%A2%98%0A%20%20%20%20%20%20%20%20chpaterInfo%5B'title'%5D%20%3D%20x_html.xpath('%2F%2Fh3%5B%40class%3D%22j_chapterName%22%5D%2Ftext()')%5B0%5D%0A%20%20%20%20%20%20%20%20%23%E4%B9%A6%E7%B1%8D%E5%90%8D%E7%A7%B0%0A%20%20%20%20%20%20%20%20chpaterInfo%5B'novalTitle'%5D%20%3D%20x_html.xpath('%2F%2Fdiv%5B%40class%3D%22info%20fl%22%5D%2Fa%5B1%5D%2Ftext()')%5B0%5D%0A%20%20%20%20%20%20%20%20%23%E5%AD%97%E6%95%B0%0A%20%20%20%20%20%20%20%20chpaterInfo%5B'number'%5D%20%3D%20x_html.xpath('%2F%2Fdiv%5B%40class%3D%22info%20fl%22%5D%2Fi%5B1%5D%2Fspan%2Ftext()')%5B0%5D%0A%20%20%20%20%20%20%20%20%23%E5%8F%91%E5%B8%83%E6%97%B6%E9%97%B4%0A%20%20%20%20%20%20%20%20chpaterInfo%5B'time'%5D%20%3D%20x_html.xpath('%2F%2Fdiv%5B%40class%3D%22info%20fl%22%5D%2Fi%5B2%5D%2Fspan%2Ftext()')%5B0%5D%0A%20%20%20%20%20%20%20%20%23%E4%B9%A6%E7%B1%8D%E5%86%85%E5%AE%B9%0A%20%20%20%20%20%20%20%20chpaterInfo%5B'content'%5D%20%3D%20''.join(x_html.xpath('%2F%2Fdiv%5B%40class%3D%22read-content%20j_readContent%22%5D%2Fp%2Ftext()')).replace('%5Cu3000'%2C'').replace('%5Cn'%2C'')%0A%0A%20%20%20%20%20%20%20%20print(chpaterInfo)%0A%20%20%20%20%20%20%20%20insert_sql%20%3D%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20INSERT%20INTO%20dian%20(%25s)%0A%20%20%20%20%20%20%20%20%20%20%20%20VALUES%20(%25s)%0A%20%20%20%20%20%20%20%20%22%22%22%20%25%20('%2C'.join(chpaterInfo.keys())%2C%20'%2C'.join(%5B'%25s'%5D%20*%20len(chpaterInfo)))%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cursor.execute(insert_sql%2C%20list(chpaterInfo.values()))%0A%20%20%20%20%20%20%20%20%20%20%20%20mysql_client.commit()%0A%20%20%20%20%20%20%20%20except%20Exception%20as%20err%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(err)%0A%20%20%20%20%20%20%20%20%20%20%20%20mysql_client.rollback()%0A%0A%0Aif%20__name__%20%3D%3D%20'__main__'%3A%0A%20%20%20%20%0A%20%20%20%20%23%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E9%93%BE%E6%8E%A5%0A%20%20%20%20mysql_client%20%3D%20pymysql.Connect(%0A%20%20%20%20%20%20%20%20'localhost'%2C%20'root'%2C%20'wangshibo'%2C%0A%20%20%20%20%20%20%20%20'qd'%2C%20charset%3D'utf8'%0A%20%20%20%20)%0A%20%20%20%20%23%E5%88%9B%E5%BB%BA%E6%B8%B8%E6%A0%87%0A%20%20%20%20cursor%20%3D%20mysql_client.cursor()%0A%20%20%20%20%23%E8%AE%BE%E7%BD%AE%E8%B5%B7%E5%A7%8Burl%0A%20%20%20%20start_url%20%3D%20'https%3A%2F%2Fwww.qidian.com%2Fall%3ForderId%3D%26style%3D1%26pageSize%3D20%26siteid%3D1%26pubflag%3D0%26hiddenField%3D0%26page%3D1'%0A%20%20%20%20qidianspider%20%3D%20QidianSpider()%0A%20%20%20%20qidianspider.start_request(start_url)%0A%60%60%60%0A%0A%0A----------------------------------%0A%0A%23%23%23%20%E4%BD%9C%E4%B8%9A%E7%BB%83%E4%B9%A0%E4%BA%8C%20%EF%BC%9A%20%0A%0A%E8%8E%B7%E5%8F%96%E5%B0%8F%E8%AF%B4%E9%98%85%E8%AF%BB%E7%BD%91%E6%89%80%E6%9C%89%E5%B0%8F%E8%AF%B4%E6%95%B0%E6%8D%AE%EF%BC%9A%0A%E7%BD%91%E5%9D%80%E5%A6%82%E4%B8%8B%EF%BC%9A%0Ahttps%3A%2F%2Fwww.readnovel.com%2Fall%0A%0A%23%23%23%23%20%E8%A6%81%E6%B1%82%0A1.%E5%B0%86%E5%B0%8F%E8%AF%B4%E4%BF%A1%E6%81%AF%E5%AD%98%E5%85%A5%E4%B8%80%E5%BC%A0%E8%A1%A8%0A2.%E5%B0%8F%E8%AF%B4%E7%9A%84%E7%AB%A0%E8%8A%82%E4%BF%A1%E6%81%AF%E5%AD%98%E5%85%A5%E4%B8%80%E5%BC%A0%E8%A1%A8%EF%BC%8C%EF%BC%88%E6%B7%BB%E5%8A%A0%E5%A4%96%E9%94%AE%EF%BC%8C%E5%A4%96%E9%94%AE%E4%B8%BA%E4%B9%A6%E7%B1%8Did%EF%BC%89%0A%0A%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%E5%AD%97%E6%AE%B5%E5%A6%82%E4%B8%8B%EF%BC%9A%0A%23%23%23%23%20%E4%B9%A6%E7%B1%8D%E4%BF%A1%E6%81%AF%EF%BC%9A%0A!%5B4b579549525568c448e142c4e0611307.png%5D(evernotecid%3A%2F%2FDE21829F-6D00-46F2-8456-1D207C38642D%2Fappyinxiangcom%2F19277208%2FENResource%2Fp2326)%0A%23%23%23%23%20%E7%AB%A0%E8%8A%82%E4%BF%A1%E6%81%AF%0A!%5B960d18f2dcfce90208bd79801af57c2b.png%5D(evernotecid%3A%2F%2FDE21829F-6D00-46F2-8456-1D207C38642D%2Fappyinxiangcom%2F19277208%2FENResource%2Fp2327)%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A</center></div><div><br/></div></body></html>