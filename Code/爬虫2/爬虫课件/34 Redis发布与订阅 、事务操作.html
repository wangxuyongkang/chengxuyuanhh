<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.0.5 (458014)"/><meta name="altitude" content="36"/><meta name="author" content="李居豪"/><meta name="created" content="2019-05-29 14:27:49 +0000"/><meta name="latitude" content="39.63154866728316"/><meta name="longitude" content="116.0504686934716"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2019-06-17 06:29:58 +0000"/><meta name="content-class" content="yinxiang.markdown"/><title>34 Redis发布与订阅 、事务操作</title></head><body><div><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><h2 style="box-sizing: content-box; font-size: 34px; border-bottom: 1px solid rgb(219, 219, 219);"><span style="font-size: 34px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%; box-sizing: content-box;">Redis 发布订阅</span></h2><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">Redis 发布订阅(pub/sub)是一种消息通信模式：发送者(pub)发送消息，订阅者(sub)接收消息。</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">发布者不是计划发送消息给特定的接收者（订阅者），而是发布的消息分到不同的频道，不需要知道什么样的订阅者订阅</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">订阅者对一个或多个频道感兴趣，只需接收感兴趣的消息，不需要知道什么样的发布者发布的</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">发布者和订阅者的解耦合可以带来更大的扩展性和更加动态的网络拓扑</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">客户端发到频道的消息，将会被推送到所有订阅此频道的客户端</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">客户端不需要主动去获取消息，只需要订阅频道，这个频道的内容就会被推送过来</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">消息的格式：</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">推送消息的格式包含三部分</span></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">part1:消息类型，包含三种类型</span></div></li><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 0px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">subscribe，表示订阅成功</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">unsubscribe，表示取消订阅成功</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">message，表示其它终端发布消息</span></div></li></ul><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">如果第一部分的值为subscribe，则第二部分是频道，第三部分是现在订阅的频道的数量</span></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">如果第一部分的值为unsubscribe，则第二部分是频道，第三部分是现在订阅的频道的数量，如果为0则表示当前没有订阅任何频道，当在Pub/Sub以外状态，客户端可以发出任何redis命令</span></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">如果第一部分的值为message，则第二部分是来源频道的名称，第三部分是消息的内容</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">命令：</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">订阅</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">（监听频道发布的消息）</span></div></li></ul><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">SUBSCRIBE channel(频道名称) [channel]</span></div></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">取消订阅，停止频道的监听</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">（如果不写参数，表示取消所有订阅）</span></div></li></ul><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">UNSUBSCRIBE 频道名称　[channel ...]</span></div></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">发布：</span></div></li></ul><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">PUBLISH 频道 消息</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">补充redis默认有15个数据库我们可以进行切换使用select进行选择</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">select 1</span></div></div><ol style="box-sizing: content-box; padding-left: 30px; margin: 6px 0px 10px; list-style-type: decimal;"><li style="box-sizing: content-box;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">首先启动redis-server服务器</span></div></li><li style="box-sizing: content-box;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">分别开启两个redis-cli</span></div></li><li style="box-sizing: content-box;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">然后输入订阅命令</span></div></li></ol><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">订阅</span></div></li></ul><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">SUBSCRIBE py111</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;"><img src="34%20Redis%E5%8F%91%E5%B8%83%E4%B8%8E%E8%AE%A2%E9%98%85%20%E3%80%81%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C.resources/E166DE51-0235-42BF-ADDF-08BD93F2B0F7.png" height="187" width="416"/></span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">向订阅号发布消息</span></div></li></ul><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">PUBLISH py111 wode</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;"><img src="34%20Redis%E5%8F%91%E5%B8%83%E4%B8%8E%E8%AE%A2%E9%98%85%20%E3%80%81%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C.resources/B33F36A9-3221-4330-B44B-996983A9B894.png" height="35" width="429"/></span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">取消订阅</span></div></li></ul><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">UNSUBSCRIBE py111</span></div></div><h1 style="box-sizing: content-box; font-size: 41px; border-bottom: 3px double rgb(153, 153, 153); margin-top: 14px;"><span style="font-size: 41px; color: rgb(0, 0, 0); font-weight: 700; line-height: 160%; box-sizing: content-box;">Redis事务</span></h1><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">Redis 事务可以一次执行多个命令， 并且带有以下两个重要的保证：</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">事务是一个单独的隔离操作：事务中的所有命令都会序列化、按顺序地执行。事务在执行的过程中，不会被其他客户端发送来的命令请求所打断。</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">事务是一个原子操作：事务中的命令要么全部被执行，要么全部都不执行。</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">一个事务从开始到执行会经历以下三个阶段：</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">开始事务。</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">命令入队。</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">执行事务。</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">实例</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">以下是一个事务的例子， 它先以 MULTI 开始一个事务， 然后将多个命令入队到事务中， 最后由 EXEC 命令触发事务， 一并执行事务中的所有命令：</span></div></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">redis 127.0.0.1:6379&gt; MULTI</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">OK</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">redis 127.0.0.1:6379&gt; SET book-name "Mastering C++ in 21 days"</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">QUEUED</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">redis 127.0.0.1:6379&gt; GET book-name</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">QUEUED</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">redis 127.0.0.1:6379&gt; SADD tag "C++" "Programming" "Mastering Series"</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">QUEUED</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">redis 127.0.0.1:6379&gt; SMEMBERS tag</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">QUEUED</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">redis 127.0.0.1:6379&gt; EXEC</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">1) OK</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">2) "Mastering C++ in 21 days"</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">3) (integer) 3</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">4) 1) "Mastering Series"</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">2) "C++"</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">3) "Programming"</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">Redis 事务命令</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">下表列出了 redis 事务的常用命令：</span></div></div><table style="margin: 2px 0px 14px; width: auto; border-collapse: collapse; box-sizing: border-box;"><colgroup><col/><col/></colgroup><tbody style="box-sizing: content-box;"><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 6px 14px 5px 12px; border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(114, 119, 123); border-bottom-color: rgb(114, 119, 123); border-left-color: rgb(114, 119, 123); border-image: initial; border-top-style: initial; border-top-color: initial; background-color: rgb(123, 129, 132);"><span style="font-size: 14px; color: rgb(255, 255, 255); line-height: 160%; font-weight: 300;">序号</span></td><td style="box-sizing: content-box; padding: 6px 14px 5px 12px; border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(114, 119, 123); border-bottom-color: rgb(114, 119, 123); border-left-color: rgb(114, 119, 123); border-image: initial; border-top-style: initial; border-top-color: initial; background-color: rgb(123, 129, 132);"><span style="font-size: 14px; color: rgb(255, 255, 255); line-height: 160%; font-weight: 300;">命令及描述</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">1</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">DISCARD 取消事务，放弃执行事务块内的所有命令。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">2</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">EXEC 执行所有事务块内的命令。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">3</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">MULTI 标记一个事务块的开始。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">4</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">UNWATCH 取消 WATCH 命令对所有 key 的监视。</span></td></tr><tr style="box-sizing: content-box;"><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">5</span></td><td style="box-sizing: content-box; padding: 5px 14px 5px 12px; border: 1px solid rgb(234, 234, 234);"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">WATCH key [key ...] 监视一个(或多个) key ，如果在事务执行之前这个(或这些) key 被其他命令所改动，那么事务将被打断。</span></td></tr></tbody></table><div><br/></div></div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%23%23%20**Redis%20%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85**%0A%0ARedis%20%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85(pub%2Fsub)%E6%98%AF%E4%B8%80%E7%A7%8D%E6%B6%88%E6%81%AF%E9%80%9A%E4%BF%A1%E6%A8%A1%E5%BC%8F%EF%BC%9A%E5%8F%91%E9%80%81%E8%80%85(pub)%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF%EF%BC%8C%E8%AE%A2%E9%98%85%E8%80%85(sub)%E6%8E%A5%E6%94%B6%E6%B6%88%E6%81%AF%E3%80%82%0A%0A-%20%E5%8F%91%E5%B8%83%E8%80%85%E4%B8%8D%E6%98%AF%E8%AE%A1%E5%88%92%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF%E7%BB%99%E7%89%B9%E5%AE%9A%E7%9A%84%E6%8E%A5%E6%94%B6%E8%80%85%EF%BC%88%E8%AE%A2%E9%98%85%E8%80%85%EF%BC%89%EF%BC%8C%E8%80%8C%E6%98%AF%E5%8F%91%E5%B8%83%E7%9A%84%E6%B6%88%E6%81%AF%E5%88%86%E5%88%B0%E4%B8%8D%E5%90%8C%E7%9A%84%E9%A2%91%E9%81%93%EF%BC%8C%E4%B8%8D%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84%E8%AE%A2%E9%98%85%E8%80%85%E8%AE%A2%E9%98%85%0A-%20%E8%AE%A2%E9%98%85%E8%80%85%E5%AF%B9%E4%B8%80%E4%B8%AA%E6%88%96%E5%A4%9A%E4%B8%AA%E9%A2%91%E9%81%93%E6%84%9F%E5%85%B4%E8%B6%A3%EF%BC%8C%E5%8F%AA%E9%9C%80%E6%8E%A5%E6%94%B6%E6%84%9F%E5%85%B4%E8%B6%A3%E7%9A%84%E6%B6%88%E6%81%AF%EF%BC%8C%E4%B8%8D%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84%E5%8F%91%E5%B8%83%E8%80%85%E5%8F%91%E5%B8%83%E7%9A%84%0A-%20%E5%8F%91%E5%B8%83%E8%80%85%E5%92%8C%E8%AE%A2%E9%98%85%E8%80%85%E7%9A%84%E8%A7%A3%E8%80%A6%E5%90%88%E5%8F%AF%E4%BB%A5%E5%B8%A6%E6%9D%A5%E6%9B%B4%E5%A4%A7%E7%9A%84%E6%89%A9%E5%B1%95%E6%80%A7%E5%92%8C%E6%9B%B4%E5%8A%A0%E5%8A%A8%E6%80%81%E7%9A%84%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91%0A-%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%8F%91%E5%88%B0%E9%A2%91%E9%81%93%E7%9A%84%E6%B6%88%E6%81%AF%EF%BC%8C%E5%B0%86%E4%BC%9A%E8%A2%AB%E6%8E%A8%E9%80%81%E5%88%B0%E6%89%80%E6%9C%89%E8%AE%A2%E9%98%85%E6%AD%A4%E9%A2%91%E9%81%93%E7%9A%84%E5%AE%A2%E6%88%B7%E7%AB%AF%0A-%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%B8%8D%E9%9C%80%E8%A6%81%E4%B8%BB%E5%8A%A8%E5%8E%BB%E8%8E%B7%E5%8F%96%E6%B6%88%E6%81%AF%EF%BC%8C%E5%8F%AA%E9%9C%80%E8%A6%81%E8%AE%A2%E9%98%85%E9%A2%91%E9%81%93%EF%BC%8C%E8%BF%99%E4%B8%AA%E9%A2%91%E9%81%93%E7%9A%84%E5%86%85%E5%AE%B9%E5%B0%B1%E4%BC%9A%E8%A2%AB%E6%8E%A8%E9%80%81%E8%BF%87%E6%9D%A5%0A%0A**%E6%B6%88%E6%81%AF%E7%9A%84%E6%A0%BC%E5%BC%8F%EF%BC%9A**%0A%0A-%20%E6%8E%A8%E9%80%81%E6%B6%88%E6%81%AF%E7%9A%84%E6%A0%BC%E5%BC%8F%E5%8C%85%E5%90%AB%E4%B8%89%E9%83%A8%E5%88%86%0A-%20part1%3A%E6%B6%88%E6%81%AF%E7%B1%BB%E5%9E%8B%EF%BC%8C%E5%8C%85%E5%90%AB%E4%B8%89%E7%A7%8D%E7%B1%BB%E5%9E%8B%0A%0A-%20-%20subscribe%EF%BC%8C%E8%A1%A8%E7%A4%BA%E8%AE%A2%E9%98%85%E6%88%90%E5%8A%9F%0A%0A-%20-%20unsubscribe%EF%BC%8C%E8%A1%A8%E7%A4%BA%E5%8F%96%E6%B6%88%E8%AE%A2%E9%98%85%E6%88%90%E5%8A%9F%0A%0A-%20-%20message%EF%BC%8C%E8%A1%A8%E7%A4%BA%E5%85%B6%E5%AE%83%E7%BB%88%E7%AB%AF%E5%8F%91%E5%B8%83%E6%B6%88%E6%81%AF%0A%0A-%20%E5%A6%82%E6%9E%9C%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%E7%9A%84%E5%80%BC%E4%B8%BAsubscribe%EF%BC%8C%E5%88%99%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%E6%98%AF%E9%A2%91%E9%81%93%EF%BC%8C%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%E6%98%AF%E7%8E%B0%E5%9C%A8%E8%AE%A2%E9%98%85%E7%9A%84%E9%A2%91%E9%81%93%E7%9A%84%E6%95%B0%E9%87%8F%0A-%20%E5%A6%82%E6%9E%9C%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%E7%9A%84%E5%80%BC%E4%B8%BAunsubscribe%EF%BC%8C%E5%88%99%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%E6%98%AF%E9%A2%91%E9%81%93%EF%BC%8C%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%E6%98%AF%E7%8E%B0%E5%9C%A8%E8%AE%A2%E9%98%85%E7%9A%84%E9%A2%91%E9%81%93%E7%9A%84%E6%95%B0%E9%87%8F%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%B8%BA0%E5%88%99%E8%A1%A8%E7%A4%BA%E5%BD%93%E5%89%8D%E6%B2%A1%E6%9C%89%E8%AE%A2%E9%98%85%E4%BB%BB%E4%BD%95%E9%A2%91%E9%81%93%EF%BC%8C%E5%BD%93%E5%9C%A8Pub%2FSub%E4%BB%A5%E5%A4%96%E7%8A%B6%E6%80%81%EF%BC%8C%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%8F%AF%E4%BB%A5%E5%8F%91%E5%87%BA%E4%BB%BB%E4%BD%95redis%E5%91%BD%E4%BB%A4%0A-%20%E5%A6%82%E6%9E%9C%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%E7%9A%84%E5%80%BC%E4%B8%BAmessage%EF%BC%8C%E5%88%99%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%E6%98%AF%E6%9D%A5%E6%BA%90%E9%A2%91%E9%81%93%E7%9A%84%E5%90%8D%E7%A7%B0%EF%BC%8C%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%E6%98%AF%E6%B6%88%E6%81%AF%E7%9A%84%E5%86%85%E5%AE%B9%0A%0A**%E5%91%BD%E4%BB%A4%EF%BC%9A**%0A%0A-%20**%E8%AE%A2%E9%98%85**%EF%BC%88%E7%9B%91%E5%90%AC%E9%A2%91%E9%81%93%E5%8F%91%E5%B8%83%E7%9A%84%E6%B6%88%E6%81%AF%EF%BC%89%0A%60%60%60%0ASUBSCRIBE%20channel(%E9%A2%91%E9%81%93%E5%90%8D%E7%A7%B0)%20%5Bchannel%5D%0A%60%60%60%0A-%20**%E5%8F%96%E6%B6%88%E8%AE%A2%E9%98%85%EF%BC%8C%E5%81%9C%E6%AD%A2%E9%A2%91%E9%81%93%E7%9A%84%E7%9B%91%E5%90%AC**%EF%BC%88%E5%A6%82%E6%9E%9C%E4%B8%8D%E5%86%99%E5%8F%82%E6%95%B0%EF%BC%8C%E8%A1%A8%E7%A4%BA%E5%8F%96%E6%B6%88%E6%89%80%E6%9C%89%E8%AE%A2%E9%98%85%EF%BC%89%0A%60%60%60%0AUNSUBSCRIBE%20%20%E9%A2%91%E9%81%93%E5%90%8D%E7%A7%B0%E3%80%80%5Bchannel%20...%5D%0A%60%60%60%0A%0A-%20**%E5%8F%91%E5%B8%83%EF%BC%9A**%0A%60%60%60%0APUBLISH%20%20%E9%A2%91%E9%81%93%20%E6%B6%88%E6%81%AF%0A%60%60%60%0A%0A%E8%A1%A5%E5%85%85redis%E9%BB%98%E8%AE%A4%E6%9C%8915%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E8%BF%9B%E8%A1%8C%E5%88%87%E6%8D%A2%E4%BD%BF%E7%94%A8select%E8%BF%9B%E8%A1%8C%E9%80%89%E6%8B%A9%0A%60%60%60%0Aselect%201%0A%60%60%60%0A%0A1.%20%E9%A6%96%E5%85%88%E5%90%AF%E5%8A%A8redis-server%E6%9C%8D%E5%8A%A1%E5%99%A8%0A2.%20%E5%88%86%E5%88%AB%E5%BC%80%E5%90%AF%E4%B8%A4%E4%B8%AAredis-cli%0A3.%20%E7%84%B6%E5%90%8E%E8%BE%93%E5%85%A5%E8%AE%A2%E9%98%85%E5%91%BD%E4%BB%A4%0A%0A-%20%E8%AE%A2%E9%98%85%0A%60%60%60%0ASUBSCRIBE%20%20py111%0A%60%60%60%0A%0A!%5B951BE958-B540-4B51-A3F3-AC029F5641AC%5D(https%3A%2F%2Fi.loli.net%2F2018%2F08%2F25%2F5b815249653ae.png)%0A%0A-%20%E5%90%91%E8%AE%A2%E9%98%85%E5%8F%B7%E5%8F%91%E5%B8%83%E6%B6%88%E6%81%AF%0A%0A%60%60%60%0APUBLISH%20%20py111%20%20wode%0A%60%60%60%0A%0A!%5BE5BDC17A-C9CE-4FCA-AC5E-930B9BA2EFD3%5D(https%3A%2F%2Fi.loli.net%2F2018%2F08%2F25%2F5b81525bb1dd5.png)%0A%0A-%20%E5%8F%96%E6%B6%88%E8%AE%A2%E9%98%85%0A%60%60%60%0AUNSUBSCRIBE%20%20py111%0A%60%60%60%0A%0A%0A%23%20**Redis%E4%BA%8B%E5%8A%A1**%0A%0ARedis%20%E4%BA%8B%E5%8A%A1%E5%8F%AF%E4%BB%A5%E4%B8%80%E6%AC%A1%E6%89%A7%E8%A1%8C%E5%A4%9A%E4%B8%AA%E5%91%BD%E4%BB%A4%EF%BC%8C%20%E5%B9%B6%E4%B8%94%E5%B8%A6%E6%9C%89%E4%BB%A5%E4%B8%8B%E4%B8%A4%E4%B8%AA%E9%87%8D%E8%A6%81%E7%9A%84%E4%BF%9D%E8%AF%81%EF%BC%9A%0A%0A-%20%E4%BA%8B%E5%8A%A1%E6%98%AF%E4%B8%80%E4%B8%AA%E5%8D%95%E7%8B%AC%E7%9A%84%E9%9A%94%E7%A6%BB%E6%93%8D%E4%BD%9C%EF%BC%9A%E4%BA%8B%E5%8A%A1%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E5%91%BD%E4%BB%A4%E9%83%BD%E4%BC%9A%E5%BA%8F%E5%88%97%E5%8C%96%E3%80%81%E6%8C%89%E9%A1%BA%E5%BA%8F%E5%9C%B0%E6%89%A7%E8%A1%8C%E3%80%82%E4%BA%8B%E5%8A%A1%E5%9C%A8%E6%89%A7%E8%A1%8C%E7%9A%84%E8%BF%87%E7%A8%8B%E4%B8%AD%EF%BC%8C%E4%B8%8D%E4%BC%9A%E8%A2%AB%E5%85%B6%E4%BB%96%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%8F%91%E9%80%81%E6%9D%A5%E7%9A%84%E5%91%BD%E4%BB%A4%E8%AF%B7%E6%B1%82%E6%89%80%E6%89%93%E6%96%AD%E3%80%82%0A-%20%E4%BA%8B%E5%8A%A1%E6%98%AF%E4%B8%80%E4%B8%AA%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C%EF%BC%9A%E4%BA%8B%E5%8A%A1%E4%B8%AD%E7%9A%84%E5%91%BD%E4%BB%A4%E8%A6%81%E4%B9%88%E5%85%A8%E9%83%A8%E8%A2%AB%E6%89%A7%E8%A1%8C%EF%BC%8C%E8%A6%81%E4%B9%88%E5%85%A8%E9%83%A8%E9%83%BD%E4%B8%8D%E6%89%A7%E8%A1%8C%E3%80%82%0A%0A%E4%B8%80%E4%B8%AA%E4%BA%8B%E5%8A%A1%E4%BB%8E%E5%BC%80%E5%A7%8B%E5%88%B0%E6%89%A7%E8%A1%8C%E4%BC%9A%E7%BB%8F%E5%8E%86%E4%BB%A5%E4%B8%8B%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5%EF%BC%9A%0A%0A-%20%E5%BC%80%E5%A7%8B%E4%BA%8B%E5%8A%A1%E3%80%82%0A-%20%E5%91%BD%E4%BB%A4%E5%85%A5%E9%98%9F%E3%80%82%0A-%20%E6%89%A7%E8%A1%8C%E4%BA%8B%E5%8A%A1%E3%80%82%0A%0A%E5%AE%9E%E4%BE%8B%0A%E4%BB%A5%E4%B8%8B%E6%98%AF%E4%B8%80%E4%B8%AA%E4%BA%8B%E5%8A%A1%E7%9A%84%E4%BE%8B%E5%AD%90%EF%BC%8C%20%E5%AE%83%E5%85%88%E4%BB%A5%20MULTI%20%E5%BC%80%E5%A7%8B%E4%B8%80%E4%B8%AA%E4%BA%8B%E5%8A%A1%EF%BC%8C%20%E7%84%B6%E5%90%8E%E5%B0%86%E5%A4%9A%E4%B8%AA%E5%91%BD%E4%BB%A4%E5%85%A5%E9%98%9F%E5%88%B0%E4%BA%8B%E5%8A%A1%E4%B8%AD%EF%BC%8C%20%E6%9C%80%E5%90%8E%E7%94%B1%20EXEC%20%E5%91%BD%E4%BB%A4%E8%A7%A6%E5%8F%91%E4%BA%8B%E5%8A%A1%EF%BC%8C%20%E4%B8%80%E5%B9%B6%E6%89%A7%E8%A1%8C%E4%BA%8B%E5%8A%A1%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E5%91%BD%E4%BB%A4%EF%BC%9A%0A%0A%20%20%20%20redis%20127.0.0.1%3A6379%3E%20MULTI%0A%20%20%20%20OK%0A%20%20%20%20%0A%20%20%20%20redis%20127.0.0.1%3A6379%3E%20SET%20book-name%20%22Mastering%20C%2B%2B%20in%2021%20days%22%0A%20%20%20%20QUEUED%0A%20%20%20%20%0A%20%20%20%20redis%20127.0.0.1%3A6379%3E%20GET%20book-name%0A%20%20%20%20QUEUED%0A%20%20%20%20%0A%20%20%20%20redis%20127.0.0.1%3A6379%3E%20SADD%20tag%20%22C%2B%2B%22%20%22Programming%22%20%22Mastering%20Series%22%0A%20%20%20%20QUEUED%0A%20%20%20%20%0A%20%20%20%20redis%20127.0.0.1%3A6379%3E%20SMEMBERS%20tag%0A%20%20%20%20QUEUED%0A%20%20%20%20%0A%20%20%20%20redis%20127.0.0.1%3A6379%3E%20EXEC%0A%20%20%20%201)%20OK%0A%20%20%20%202)%20%22Mastering%20C%2B%2B%20in%2021%20days%22%0A%20%20%20%203)%20(integer)%203%0A%20%20%20%204)%201)%20%22Mastering%20Series%22%0A%20%20%20%202)%20%22C%2B%2B%22%0A%20%20%20%203)%20%22Programming%22%0A%0A**Redis%20%E4%BA%8B%E5%8A%A1%E5%91%BD%E4%BB%A4**%0A%E4%B8%8B%E8%A1%A8%E5%88%97%E5%87%BA%E4%BA%86%20redis%20%E4%BA%8B%E5%8A%A1%E7%9A%84%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%EF%BC%9A%0A%0A%E5%BA%8F%E5%8F%B7%20%7C%09%E5%91%BD%E4%BB%A4%E5%8F%8A%E6%8F%8F%E8%BF%B0%0A----%7C----%0A1%09%7C%20DISCARD%20%E5%8F%96%E6%B6%88%E4%BA%8B%E5%8A%A1%EF%BC%8C%E6%94%BE%E5%BC%83%E6%89%A7%E8%A1%8C%E4%BA%8B%E5%8A%A1%E5%9D%97%E5%86%85%E7%9A%84%E6%89%80%E6%9C%89%E5%91%BD%E4%BB%A4%E3%80%82%0A2%09%7C%20EXEC%20%E6%89%A7%E8%A1%8C%E6%89%80%E6%9C%89%E4%BA%8B%E5%8A%A1%E5%9D%97%E5%86%85%E7%9A%84%E5%91%BD%E4%BB%A4%E3%80%82%0A3%09%7C%20MULTI%20%E6%A0%87%E8%AE%B0%E4%B8%80%E4%B8%AA%E4%BA%8B%E5%8A%A1%E5%9D%97%E7%9A%84%E5%BC%80%E5%A7%8B%E3%80%82%0A4%20%20%7C%20UNWATCH%20%E5%8F%96%E6%B6%88%20WATCH%20%E5%91%BD%E4%BB%A4%E5%AF%B9%E6%89%80%E6%9C%89%20key%20%E7%9A%84%E7%9B%91%E8%A7%86%E3%80%82%0A5%20%20%7C%09WATCH%20key%20%5Bkey%20...%5D%20%E7%9B%91%E8%A7%86%E4%B8%80%E4%B8%AA(%E6%88%96%E5%A4%9A%E4%B8%AA)%20key%20%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%9C%A8%E4%BA%8B%E5%8A%A1%E6%89%A7%E8%A1%8C%E4%B9%8B%E5%89%8D%E8%BF%99%E4%B8%AA(%E6%88%96%E8%BF%99%E4%BA%9B)%20key%20%E8%A2%AB%E5%85%B6%E4%BB%96%E5%91%BD%E4%BB%A4%E6%89%80%E6%94%B9%E5%8A%A8%EF%BC%8C%E9%82%A3%E4%B9%88%E4%BA%8B%E5%8A%A1%E5%B0%86%E8%A2%AB%E6%89%93%E6%96%AD%E3%80%82%0A</center></div></body></html>