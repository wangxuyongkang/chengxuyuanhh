<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.0.5 (458014)"/><meta name="altitude" content="36.00742340087891"/><meta name="author" content="李居豪"/><meta name="created" content="2019-05-27 15:04:28 +0000"/><meta name="latitude" content="39.63153355111113"/><meta name="longitude" content="116.0503985913381"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2019-06-11 01:50:57 +0000"/><meta name="content-class" content="yinxiang.markdown"/><title>16 Tesseract图像识别库及打码平台</title></head><body><div><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">机器视觉</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">从 Google 的无人驾驶汽车到可以识别假钞的自动售卖机，机器视觉一直都是一个应用广 泛且具有深远的影响和雄伟的愿景的领域。</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">我们将重点介绍机器视觉的一个分支：文字识别，介绍如何用一些 Python库来识别和使用在线图片中的文字。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">我们可以很轻松的阅读图片里的文字，但是机器阅读这些图片就会非常困难，利用这种人类用户可以正常读取但是大多数机器人都没法读取的图片，验证码 (CAPTCHA)就出现了。验证码读取的难易程度也大不相同，有些验证码比其他的更加难读。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">将图像翻译成文字一般被称为光学文字识别(Optical Character Recognition, OCR)。可以实现OCR的底层库并不多,目前很多库都是使用共同的几个底层 OCR 库,或者是在上面 进行定制。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">ORC库概述</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">在读取和处理图像、图像相关的机器学习以及创建图像等任务中，Python 一直都是非常出色的语言。虽然有很多库可以进行图像处理，但在这里我们只重点介绍：Tesseract</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">Tesseract</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">Tesseract 是一个 OCR 库,目前由 Google 赞助(Google 也是一家以 OCR 和机器学习技术闻名于世的公司)。Tesseract 是目前公认最优秀、最精确的开源 OCR 系统，除了极高的精确度，Tesseract 也具有很高的灵活性。它可以通过训练识别出任何字体，也可以识别出任何 Unicode 字符。</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">安装Tesseract</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">Windows 系统</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">下载可执行安装文件https://code.google.com/p/tesseract-ocr/downloads/list安装。</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">Mac OS X系统</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">用 Homebrew(http://brew.sh/)等第三方库可以很方便地安装</span></div></div><blockquote style="box-sizing: content-box; margin: 15px 0px; border-left: 4px solid rgb(221, 221, 221); padding: 0px 15px;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">brew install tesseract</span></div></blockquote><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">Linux 系统</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">可以通过 apt-get 安装:</span></div></div><blockquote style="box-sizing: content-box; margin: 15px 0px; border-left: 4px solid rgb(221, 221, 221); padding: 0px 15px;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">sudo apt-get install tesseract-ocr</span></div></blockquote><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">安装pytesseract</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">Tesseract 是一个 Python 的命令行工具，不是通过 import 语句导入的库。安装之后,要用 tesseract 命令在 Python 的外面运行，但我们可以通过 pip 安装支持Python 版本的 Tesseract库：</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">处理给规范的文字</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">处理的大多数文字最好都是比较干净、格式规范的。格式规范的文字通常可以满足一些需求，通常格式规范的文字具有以下特点:</span></div></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">使用一个标准字体(不包含手写体、草书,或者十分“花哨的”字体)</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">即使被复印或拍照，字体还是很清晰，没有多余的痕迹或污点</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">排列整齐，没有歪歪斜斜的字</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">没有超出图片范围，也没有残缺不全，或紧紧贴在图片的边缘</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">文字的一些格式问题在图片预处理时可以进行解决。例如,可以把图片转换成灰度图，调整亮度和对比度，还可以根据需要进行裁剪和旋转（详情需要了解图像与信号处理）等。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;"><img src="16%20Tesseract%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB%E5%BA%93%E5%8F%8A%E6%89%93%E7%A0%81%E5%B9%B3%E5%8F%B0.resources/4DD8E8C8-0E6D-4D2B-9E68-3B3D7EBC1FA6.jpg"/></span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;"><img src="16%20Tesseract%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB%E5%BA%93%E5%8F%8A%E6%89%93%E7%A0%81%E5%B9%B3%E5%8F%B0.resources/61E254BC-7C97-4C5E-862B-65B6D22D83CF.png" height="96" width="865"/></span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;"><img src="16%20Tesseract%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB%E5%BA%93%E5%8F%8A%E6%89%93%E7%A0%81%E5%B9%B3%E5%8F%B0.resources/C6D65F1C-60D0-448A-81B0-167997352A40.png" height="245" width="882"/></span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">cat text.txt 即可显示结果。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">识别结果很准确,不过符号^和*分别被表示成了双引号和单引号。大体上可以让你很舒服地阅读。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">通过Python代码实现</span></div><blockquote style="box-sizing: content-box; margin: 15px 0px; border-left: 4px solid rgb(221, 221, 221); padding: 0px 15px;"><div style="box-sizing: content-box; margin: 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">pip3 install pytesseract</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">pip3 install pillow</span></div></div></blockquote><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">import pytesseract</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">from PIL import Image</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">image = Image.open('test.jpg')</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">text = pytesseract.image_to_string(image)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print (text)</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">运行结果：</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">This is some text, written in Arial, that will be read by</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">Tesseract. Here are some symbols: !@#$%"&amp;*()</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">可以使用下图再测试一下结果：</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;"><img src="16%20Tesseract%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB%E5%BA%93%E5%8F%8A%E6%89%93%E7%A0%81%E5%B9%B3%E5%8F%B0.resources/696C4E0B-8D2A-4D40-B8B7-2B05488B3094.jpg" height="375" width="500"/></span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">对图片进行阈值过滤和降噪处理（了解即可）</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">对于一些稍微复杂一点的图片，会出现干扰来影响我们的识别结果</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">如下图：</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;"><img src="16%20Tesseract%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB%E5%BA%93%E5%8F%8A%E6%89%93%E7%A0%81%E5%B9%B3%E5%8F%B0.resources/01FA95D5-255B-4A5E-A9F7-5BE362D39BEC.jpg" height="25" width="64"/></span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">直接使用之前的方式识别上图：</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">import pytesseract</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">from PIL import Image</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">image2 = Image.open('code.jpg')</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">result = pytesseract.image_to_string(image2)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print(result)</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">结果如下：</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">.ll?42</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">这是因为图片背景的干扰导致的，此时我们需要做图片的过滤和降噪处理</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">import pytesseract</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">from PIL import Image</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">img = Image.open('code.jpg')</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#转化到灰度图</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">imgry = img.convert('L')</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">imgry.save('g'+'code.jpg')</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#二值化，采用阈值分割法，threshold为分割点</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">thrshold = 140</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">table = []</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">for j in range(256):</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">if j &lt; thrshold:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">table.append(0)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">else:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">table.append(1)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">out = imgry.point(table,'1')</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">out.save('b'+'code.jpg')</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#识别</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">text = pytesseract.image_to_string(out)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print(text)</span></div></div></div><hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; box-sizing: content-box; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">对于更复杂的验证码，识别我们一般会借助与打码平台来实现</span></h4><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">例如云打码：下载文件后需要修改部分如下</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;"><img src="16%20Tesseract%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB%E5%BA%93%E5%8F%8A%E6%89%93%E7%A0%81%E5%B9%B3%E5%8F%B0.resources/42D23528-746F-4784-959D-E6F0B52F6C22.png" height="770" width="1324"/></span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;"><img src="16%20Tesseract%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB%E5%BA%93%E5%8F%8A%E6%89%93%E7%A0%81%E5%B9%B3%E5%8F%B0.resources/531A1002-D288-4D54-AD48-BD341F4C5F32.png" height="213" width="967"/></span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">def get_code_result_by_filename(filename,codetype):</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;"># 用户名</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">username = 'wsygfsj'</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;"># 密码</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">password = '_ljh123456'</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;"># 软件ＩＤ，开发者分成必要参数。登录开发者后台【我的软件】获得！</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">appid = 6001</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;"># 软件密钥，开发者分成必要参数。登录开发者后台【我的软件】获得！</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">appkey = '3a22796930bb9fdcac622c46e3abf230'</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;"># 图片文件</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">filename = filename</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;"># 验证码类型，# 例：1004表示4位字母数字，不同类型收费不同。请准确填写，否则影响识别率。在此查询所有类型 http://www.yundama.com/price.html</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">codetype = codetype</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;"># 超时时间，秒</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">timeout = 60</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;"># 检查</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">if (username == 'username'):</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print('请设置好相关参数再测试')</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">else:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;"># 初始化</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">yundama = YDMHttp(username, password, appid, appkey)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;"># 登陆云打码</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">uid = yundama.login();</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print('uid: %s' % uid)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;"># 查询余额</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">balance = yundama.balance();</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print('balance: %s' % balance)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;"># 开始识别，图片路径，验证码类型ID，超时时间（秒），识别结果</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">cid, result = yundama.decode(filename, codetype, timeout);</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print('cid: %s, result: %s' % (cid, result))</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">return result</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">使用：</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">from PythonHTTP.YDMHTTPHandler import get_code_result_by_filename</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">import requests</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">headers = {</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">'User-Agent':'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36',</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">}</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">#获取验证码：</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">url = "https://www.douban.com/misc/captcha?id=tuvjIlLfdVLHQZmnLubDsZ8C:en&amp;size=s"</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">response = requests.get(url,headers=headers)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">if response.status_code == 200:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">with open('image.png','wb') as file:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">file.write(response.content)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">else:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print('下载失败')</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">codetype = 3009</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">result = get_code_result_by_filename('image.png',codetype)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print(result)</span></div></div></div><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; color: rgb(51, 51, 51); line-height: 160%;">斗鱼模拟登录案例,结合超级鹰打码平台(了解)</span></h4><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">from selenium import webdriver</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">import time</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">import requests</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">from io import BytesIO</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">from PIL import Image</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">from chaojiying import Chaojiying_Client</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">from selenium.webdriver import ActionChains</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">driver = webdriver.Chrome(executable_path='/home/ljh/桌面/driver/chromedriver')</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">driver.get('https://passport.douyu.com/member/login?lang=cn&amp;type=login&amp;client_id=1')</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">driver.find_element_by_xpath('//span[@]').click()</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">driver.find_element_by_name('phoneNum').send_keys('18518753265')</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">driver.find_element_by_name('password').send_keys('ljh12345678')</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">time.sleep(1)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">driver.find_element_by_xpath('//input[@]').click()</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">time.sleep(4)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">imgae_element_div = driver.find_element_by_xpath('//div[@]')</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">location = imgae_element_div.location</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">size = imgae_element_div.size</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print(location)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print(size)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">top,bottom,left,right = location['y']+2,location['y']+size['height']-42,location['x']-size['width']-2,location['x']-4</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print(top,bottom,left,right)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">screen_image = driver.get_screenshot_as_png()</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">screen_image = Image.open(BytesIO(screen_image))</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">captcha = screen_image.crop((left,top,right,bottom))</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">captcha.save('image.png')</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">chaojiying = Chaojiying_Client('18518753265', 'ljh12345678', '898122')</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">im = open('image.png', 'rb').read()</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">result = chaojiying.PostPic(im, 9004)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print(result)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">pic_str = result['pic_str'].split("|")</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">pic_id = result['pic_id']</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">locations = [[location for location in pic_location.split(",")] for pic_location in pic_str]</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print(locations)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">for location in locations:</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">ActionChains(driver).move_to_element_with_offset(imgae_element_div,int(location[0]),int(location[1])).click().perform()</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">time.sleep(1)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">driver.find_element_by_xpath('//div[@]').click()</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">time.sleep(4)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">if driver.find_element_by_xpath('//div[@]'):</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print('登录失败')</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">result = chaojiying.ReportError(pic_id)</span></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;">print(result)</span></div><div><br/></div><div><span style="font-size: 14px; color: rgb(244, 244, 244); line-height: 160%;"># print(driver.get_cookies())</span></div></div></div></div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%0A**%E6%9C%BA%E5%99%A8%E8%A7%86%E8%A7%89**%0A%E4%BB%8E%20Google%20%E7%9A%84%E6%97%A0%E4%BA%BA%E9%A9%BE%E9%A9%B6%E6%B1%BD%E8%BD%A6%E5%88%B0%E5%8F%AF%E4%BB%A5%E8%AF%86%E5%88%AB%E5%81%87%E9%92%9E%E7%9A%84%E8%87%AA%E5%8A%A8%E5%94%AE%E5%8D%96%E6%9C%BA%EF%BC%8C%E6%9C%BA%E5%99%A8%E8%A7%86%E8%A7%89%E4%B8%80%E7%9B%B4%E9%83%BD%E6%98%AF%E4%B8%80%E4%B8%AA%E5%BA%94%E7%94%A8%E5%B9%BF%20%E6%B3%9B%E4%B8%94%E5%85%B7%E6%9C%89%E6%B7%B1%E8%BF%9C%E7%9A%84%E5%BD%B1%E5%93%8D%E5%92%8C%E9%9B%84%E4%BC%9F%E7%9A%84%E6%84%BF%E6%99%AF%E7%9A%84%E9%A2%86%E5%9F%9F%E3%80%82%0A%0A%E6%88%91%E4%BB%AC%E5%B0%86%E9%87%8D%E7%82%B9%E4%BB%8B%E7%BB%8D%E6%9C%BA%E5%99%A8%E8%A7%86%E8%A7%89%E7%9A%84%E4%B8%80%E4%B8%AA%E5%88%86%E6%94%AF%EF%BC%9A%E6%96%87%E5%AD%97%E8%AF%86%E5%88%AB%EF%BC%8C%E4%BB%8B%E7%BB%8D%E5%A6%82%E4%BD%95%E7%94%A8%E4%B8%80%E4%BA%9B%20Python%E5%BA%93%E6%9D%A5%E8%AF%86%E5%88%AB%E5%92%8C%E4%BD%BF%E7%94%A8%E5%9C%A8%E7%BA%BF%E5%9B%BE%E7%89%87%E4%B8%AD%E7%9A%84%E6%96%87%E5%AD%97%E3%80%82%0A%0A%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E5%BE%88%E8%BD%BB%E6%9D%BE%E7%9A%84%E9%98%85%E8%AF%BB%E5%9B%BE%E7%89%87%E9%87%8C%E7%9A%84%E6%96%87%E5%AD%97%EF%BC%8C%E4%BD%86%E6%98%AF%E6%9C%BA%E5%99%A8%E9%98%85%E8%AF%BB%E8%BF%99%E4%BA%9B%E5%9B%BE%E7%89%87%E5%B0%B1%E4%BC%9A%E9%9D%9E%E5%B8%B8%E5%9B%B0%E9%9A%BE%EF%BC%8C%E5%88%A9%E7%94%A8%E8%BF%99%E7%A7%8D%E4%BA%BA%E7%B1%BB%E7%94%A8%E6%88%B7%E5%8F%AF%E4%BB%A5%E6%AD%A3%E5%B8%B8%E8%AF%BB%E5%8F%96%E4%BD%86%E6%98%AF%E5%A4%A7%E5%A4%9A%E6%95%B0%E6%9C%BA%E5%99%A8%E4%BA%BA%E9%83%BD%E6%B2%A1%E6%B3%95%E8%AF%BB%E5%8F%96%E7%9A%84%E5%9B%BE%E7%89%87%EF%BC%8C%E9%AA%8C%E8%AF%81%E7%A0%81%20(CAPTCHA)%E5%B0%B1%E5%87%BA%E7%8E%B0%E4%BA%86%E3%80%82%E9%AA%8C%E8%AF%81%E7%A0%81%E8%AF%BB%E5%8F%96%E7%9A%84%E9%9A%BE%E6%98%93%E7%A8%8B%E5%BA%A6%E4%B9%9F%E5%A4%A7%E4%B8%8D%E7%9B%B8%E5%90%8C%EF%BC%8C%E6%9C%89%E4%BA%9B%E9%AA%8C%E8%AF%81%E7%A0%81%E6%AF%94%E5%85%B6%E4%BB%96%E7%9A%84%E6%9B%B4%E5%8A%A0%E9%9A%BE%E8%AF%BB%E3%80%82%0A%0A%E5%B0%86%E5%9B%BE%E5%83%8F%E7%BF%BB%E8%AF%91%E6%88%90%E6%96%87%E5%AD%97%E4%B8%80%E8%88%AC%E8%A2%AB%E7%A7%B0%E4%B8%BA%E5%85%89%E5%AD%A6%E6%96%87%E5%AD%97%E8%AF%86%E5%88%AB(Optical%20Character%20Recognition%2C%20OCR)%E3%80%82%E5%8F%AF%E4%BB%A5%E5%AE%9E%E7%8E%B0OCR%E7%9A%84%E5%BA%95%E5%B1%82%E5%BA%93%E5%B9%B6%E4%B8%8D%E5%A4%9A%2C%E7%9B%AE%E5%89%8D%E5%BE%88%E5%A4%9A%E5%BA%93%E9%83%BD%E6%98%AF%E4%BD%BF%E7%94%A8%E5%85%B1%E5%90%8C%E7%9A%84%E5%87%A0%E4%B8%AA%E5%BA%95%E5%B1%82%20OCR%20%E5%BA%93%2C%E6%88%96%E8%80%85%E6%98%AF%E5%9C%A8%E4%B8%8A%E9%9D%A2%20%E8%BF%9B%E8%A1%8C%E5%AE%9A%E5%88%B6%E3%80%82%0A%0A**ORC%E5%BA%93%E6%A6%82%E8%BF%B0**%0A%E5%9C%A8%E8%AF%BB%E5%8F%96%E5%92%8C%E5%A4%84%E7%90%86%E5%9B%BE%E5%83%8F%E3%80%81%E5%9B%BE%E5%83%8F%E7%9B%B8%E5%85%B3%E7%9A%84%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%BB%A5%E5%8F%8A%E5%88%9B%E5%BB%BA%E5%9B%BE%E5%83%8F%E7%AD%89%E4%BB%BB%E5%8A%A1%E4%B8%AD%EF%BC%8CPython%20%E4%B8%80%E7%9B%B4%E9%83%BD%E6%98%AF%E9%9D%9E%E5%B8%B8%E5%87%BA%E8%89%B2%E7%9A%84%E8%AF%AD%E8%A8%80%E3%80%82%E8%99%BD%E7%84%B6%E6%9C%89%E5%BE%88%E5%A4%9A%E5%BA%93%E5%8F%AF%E4%BB%A5%E8%BF%9B%E8%A1%8C%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%EF%BC%8C%E4%BD%86%E5%9C%A8%E8%BF%99%E9%87%8C%E6%88%91%E4%BB%AC%E5%8F%AA%E9%87%8D%E7%82%B9%E4%BB%8B%E7%BB%8D%EF%BC%9ATesseract%0A%0A**Tesseract**%0ATesseract%20%E6%98%AF%E4%B8%80%E4%B8%AA%20OCR%20%E5%BA%93%2C%E7%9B%AE%E5%89%8D%E7%94%B1%20Google%20%E8%B5%9E%E5%8A%A9(Google%20%E4%B9%9F%E6%98%AF%E4%B8%80%E5%AE%B6%E4%BB%A5%20OCR%20%E5%92%8C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%8A%80%E6%9C%AF%E9%97%BB%E5%90%8D%E4%BA%8E%E4%B8%96%E7%9A%84%E5%85%AC%E5%8F%B8)%E3%80%82Tesseract%20%E6%98%AF%E7%9B%AE%E5%89%8D%E5%85%AC%E8%AE%A4%E6%9C%80%E4%BC%98%E7%A7%80%E3%80%81%E6%9C%80%E7%B2%BE%E7%A1%AE%E7%9A%84%E5%BC%80%E6%BA%90%20OCR%20%E7%B3%BB%E7%BB%9F%EF%BC%8C%E9%99%A4%E4%BA%86%E6%9E%81%E9%AB%98%E7%9A%84%E7%B2%BE%E7%A1%AE%E5%BA%A6%EF%BC%8CTesseract%20%E4%B9%9F%E5%85%B7%E6%9C%89%E5%BE%88%E9%AB%98%E7%9A%84%E7%81%B5%E6%B4%BB%E6%80%A7%E3%80%82%E5%AE%83%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E8%AE%AD%E7%BB%83%E8%AF%86%E5%88%AB%E5%87%BA%E4%BB%BB%E4%BD%95%E5%AD%97%E4%BD%93%EF%BC%8C%E4%B9%9F%E5%8F%AF%E4%BB%A5%E8%AF%86%E5%88%AB%E5%87%BA%E4%BB%BB%E4%BD%95%20Unicode%20%E5%AD%97%E7%AC%A6%E3%80%82%0A%0A%0A%E5%AE%89%E8%A3%85Tesseract%0AWindows%20%E7%B3%BB%E7%BB%9F%0A%E4%B8%8B%E8%BD%BD%E5%8F%AF%E6%89%A7%E8%A1%8C%E5%AE%89%E8%A3%85%E6%96%87%E4%BB%B6https%3A%2F%2Fcode.google.com%2Fp%2Ftesseract-ocr%2Fdownloads%2Flist%E5%AE%89%E8%A3%85%E3%80%82%0A%0A%0AMac%20OS%20X%E7%B3%BB%E7%BB%9F%0A%E7%94%A8%20Homebrew(http%3A%2F%2Fbrew.sh%2F)%E7%AD%89%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93%E5%8F%AF%E4%BB%A5%E5%BE%88%E6%96%B9%E4%BE%BF%E5%9C%B0%E5%AE%89%E8%A3%85%20%0A%3Ebrew%20install%20tesseract%0A%0ALinux%20%E7%B3%BB%E7%BB%9F%0A%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%20apt-get%20%E5%AE%89%E8%A3%85%3A%20%0A%3Esudo%20apt-get%20install%20tesseract-ocr%0A%0A**%E5%AE%89%E8%A3%85pytesseract**%0ATesseract%20%E6%98%AF%E4%B8%80%E4%B8%AA%20Python%20%E7%9A%84%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7%EF%BC%8C%E4%B8%8D%E6%98%AF%E9%80%9A%E8%BF%87%20import%20%E8%AF%AD%E5%8F%A5%E5%AF%BC%E5%85%A5%E7%9A%84%E5%BA%93%E3%80%82%E5%AE%89%E8%A3%85%E4%B9%8B%E5%90%8E%2C%E8%A6%81%E7%94%A8%20tesseract%20%E5%91%BD%E4%BB%A4%E5%9C%A8%20Python%20%E7%9A%84%E5%A4%96%E9%9D%A2%E8%BF%90%E8%A1%8C%EF%BC%8C%E4%BD%86%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%20pip%20%E5%AE%89%E8%A3%85%E6%94%AF%E6%8C%81Python%20%E7%89%88%E6%9C%AC%E7%9A%84%20Tesseract%E5%BA%93%EF%BC%9A%0A%0A%0A**%E5%A4%84%E7%90%86%E7%BB%99%E8%A7%84%E8%8C%83%E7%9A%84%E6%96%87%E5%AD%97**%0A%E5%A4%84%E7%90%86%E7%9A%84%E5%A4%A7%E5%A4%9A%E6%95%B0%E6%96%87%E5%AD%97%E6%9C%80%E5%A5%BD%E9%83%BD%E6%98%AF%E6%AF%94%E8%BE%83%E5%B9%B2%E5%87%80%E3%80%81%E6%A0%BC%E5%BC%8F%E8%A7%84%E8%8C%83%E7%9A%84%E3%80%82%E6%A0%BC%E5%BC%8F%E8%A7%84%E8%8C%83%E7%9A%84%E6%96%87%E5%AD%97%E9%80%9A%E5%B8%B8%E5%8F%AF%E4%BB%A5%E6%BB%A1%E8%B6%B3%E4%B8%80%E4%BA%9B%E9%9C%80%E6%B1%82%EF%BC%8C%E9%80%9A%E5%B8%B8%E6%A0%BC%E5%BC%8F%E8%A7%84%E8%8C%83%E7%9A%84%E6%96%87%E5%AD%97%E5%85%B7%E6%9C%89%E4%BB%A5%E4%B8%8B%E7%89%B9%E7%82%B9%3A%0A%0A-%20%E4%BD%BF%E7%94%A8%E4%B8%80%E4%B8%AA%E6%A0%87%E5%87%86%E5%AD%97%E4%BD%93(%E4%B8%8D%E5%8C%85%E5%90%AB%E6%89%8B%E5%86%99%E4%BD%93%E3%80%81%E8%8D%89%E4%B9%A6%2C%E6%88%96%E8%80%85%E5%8D%81%E5%88%86%E2%80%9C%E8%8A%B1%E5%93%A8%E7%9A%84%E2%80%9D%E5%AD%97%E4%BD%93)%0A-%20%E5%8D%B3%E4%BD%BF%E8%A2%AB%E5%A4%8D%E5%8D%B0%E6%88%96%E6%8B%8D%E7%85%A7%EF%BC%8C%E5%AD%97%E4%BD%93%E8%BF%98%E6%98%AF%E5%BE%88%E6%B8%85%E6%99%B0%EF%BC%8C%E6%B2%A1%E6%9C%89%E5%A4%9A%E4%BD%99%E7%9A%84%E7%97%95%E8%BF%B9%E6%88%96%E6%B1%A1%E7%82%B9%0A-%20%E6%8E%92%E5%88%97%E6%95%B4%E9%BD%90%EF%BC%8C%E6%B2%A1%E6%9C%89%E6%AD%AA%E6%AD%AA%E6%96%9C%E6%96%9C%E7%9A%84%E5%AD%97%0A-%20%E6%B2%A1%E6%9C%89%E8%B6%85%E5%87%BA%E5%9B%BE%E7%89%87%E8%8C%83%E5%9B%B4%EF%BC%8C%E4%B9%9F%E6%B2%A1%E6%9C%89%E6%AE%8B%E7%BC%BA%E4%B8%8D%E5%85%A8%EF%BC%8C%E6%88%96%E7%B4%A7%E7%B4%A7%E8%B4%B4%E5%9C%A8%E5%9B%BE%E7%89%87%E7%9A%84%E8%BE%B9%E7%BC%98%0A%0A%E6%96%87%E5%AD%97%E7%9A%84%E4%B8%80%E4%BA%9B%E6%A0%BC%E5%BC%8F%E9%97%AE%E9%A2%98%E5%9C%A8%E5%9B%BE%E7%89%87%E9%A2%84%E5%A4%84%E7%90%86%E6%97%B6%E5%8F%AF%E4%BB%A5%E8%BF%9B%E8%A1%8C%E8%A7%A3%E5%86%B3%E3%80%82%E4%BE%8B%E5%A6%82%2C%E5%8F%AF%E4%BB%A5%E6%8A%8A%E5%9B%BE%E7%89%87%E8%BD%AC%E6%8D%A2%E6%88%90%E7%81%B0%E5%BA%A6%E5%9B%BE%EF%BC%8C%E8%B0%83%E6%95%B4%E4%BA%AE%E5%BA%A6%E5%92%8C%E5%AF%B9%E6%AF%94%E5%BA%A6%EF%BC%8C%E8%BF%98%E5%8F%AF%E4%BB%A5%E6%A0%B9%E6%8D%AE%E9%9C%80%E8%A6%81%E8%BF%9B%E8%A1%8C%E8%A3%81%E5%89%AA%E5%92%8C%E6%97%8B%E8%BD%AC%EF%BC%88%E8%AF%A6%E6%83%85%E9%9C%80%E8%A6%81%E4%BA%86%E8%A7%A3%E5%9B%BE%E5%83%8F%E4%B8%8E%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%EF%BC%89%E7%AD%89%E3%80%82%0A%0A!%5Btesseracttest%5D(https%3A%2F%2Fi.loli.net%2F2018%2F10%2F26%2F5bd25b4bd0725.jpg)%0A%0A!%5BDeepinScrot-5213%5D(https%3A%2F%2Fi.loli.net%2F2018%2F10%2F26%2F5bd25b6e48336.png)%0A%0A!%5BDeepinScrot-5307%5D(https%3A%2F%2Fi.loli.net%2F2018%2F10%2F26%2F5bd25b900a74b.png)%0A%0Acat%20text.txt%20%E5%8D%B3%E5%8F%AF%E6%98%BE%E7%A4%BA%E7%BB%93%E6%9E%9C%E3%80%82%0A%0A%E8%AF%86%E5%88%AB%E7%BB%93%E6%9E%9C%E5%BE%88%E5%87%86%E7%A1%AE%2C%E4%B8%8D%E8%BF%87%E7%AC%A6%E5%8F%B7%5E%E5%92%8C*%E5%88%86%E5%88%AB%E8%A2%AB%E8%A1%A8%E7%A4%BA%E6%88%90%E4%BA%86%E5%8F%8C%E5%BC%95%E5%8F%B7%E5%92%8C%E5%8D%95%E5%BC%95%E5%8F%B7%E3%80%82%E5%A4%A7%E4%BD%93%E4%B8%8A%E5%8F%AF%E4%BB%A5%E8%AE%A9%E4%BD%A0%E5%BE%88%E8%88%92%E6%9C%8D%E5%9C%B0%E9%98%85%E8%AF%BB%E3%80%82%0A%0A**%E9%80%9A%E8%BF%87Python%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0**%0A%0A%3Epip3%20install%20pytesseract%0A%3Epip3%20install%20pillow%0A%0A%60%60%60%0Aimport%20pytesseract%0Afrom%20PIL%20import%20Image%0A%0Aimage%20%3D%20Image.open('test.jpg')%0Atext%20%3D%20pytesseract.image_to_string(image)%0Aprint%20(text)%0A%60%60%60%0A%0A%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C%EF%BC%9A%0A%60%60%60%0AThis%20is%20some%20text%2C%20written%20in%20Arial%2C%20that%20will%20be%20read%20by%0ATesseract.%20Here%20are%20some%20symbols%3A%20!%40%23%24%25%22%26*()%0A%60%60%60%0A%0A%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E4%B8%8B%E5%9B%BE%E5%86%8D%E6%B5%8B%E8%AF%95%E4%B8%80%E4%B8%8B%E7%BB%93%E6%9E%9C%EF%BC%9A%0A!%5B1-3%5D(https%3A%2F%2Fi.loli.net%2F2018%2F10%2F26%2F5bd25bc8a5a5f.jpg)%0A%0A%0A**%E5%AF%B9%E5%9B%BE%E7%89%87%E8%BF%9B%E8%A1%8C%E9%98%88%E5%80%BC%E8%BF%87%E6%BB%A4%E5%92%8C%E9%99%8D%E5%99%AA%E5%A4%84%E7%90%86%EF%BC%88%E4%BA%86%E8%A7%A3%E5%8D%B3%E5%8F%AF%EF%BC%89**%0A%0A%E5%AF%B9%E4%BA%8E%E4%B8%80%E4%BA%9B%E7%A8%8D%E5%BE%AE%E5%A4%8D%E6%9D%82%E4%B8%80%E7%82%B9%E7%9A%84%E5%9B%BE%E7%89%87%EF%BC%8C%E4%BC%9A%E5%87%BA%E7%8E%B0%E5%B9%B2%E6%89%B0%E6%9D%A5%E5%BD%B1%E5%93%8D%E6%88%91%E4%BB%AC%E7%9A%84%E8%AF%86%E5%88%AB%E7%BB%93%E6%9E%9C%0A%0A%E5%A6%82%E4%B8%8B%E5%9B%BE%EF%BC%9A%0A!%5Bcode%5D(https%3A%2F%2Fi.loli.net%2F2018%2F10%2F26%2F5bd25bafce673.jpg)%0A%0A%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8%E4%B9%8B%E5%89%8D%E7%9A%84%E6%96%B9%E5%BC%8F%E8%AF%86%E5%88%AB%E4%B8%8A%E5%9B%BE%EF%BC%9A%0A%0A%60%60%60%0Aimport%20pytesseract%0Afrom%20PIL%20import%20Image%0A%0Aimage2%20%3D%20Image.open('code.jpg')%0Aresult%20%3D%20pytesseract.image_to_string(image2)%0Aprint(result)%0A%60%60%60%0A%0A%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8B%EF%BC%9A%0A%60%60%60%0A.ll%3F42%0A%60%60%60%0A%0A%E8%BF%99%E6%98%AF%E5%9B%A0%E4%B8%BA%E5%9B%BE%E7%89%87%E8%83%8C%E6%99%AF%E7%9A%84%E5%B9%B2%E6%89%B0%E5%AF%BC%E8%87%B4%E7%9A%84%EF%BC%8C%E6%AD%A4%E6%97%B6%E6%88%91%E4%BB%AC%E9%9C%80%E8%A6%81%E5%81%9A%E5%9B%BE%E7%89%87%E7%9A%84%E8%BF%87%E6%BB%A4%E5%92%8C%E9%99%8D%E5%99%AA%E5%A4%84%E7%90%86%0A%0A%60%60%60%0Aimport%20pytesseract%0Afrom%20PIL%20import%20Image%0A%0Aimg%20%3D%20Image.open('code.jpg')%0A%23%E8%BD%AC%E5%8C%96%E5%88%B0%E7%81%B0%E5%BA%A6%E5%9B%BE%0Aimgry%20%3D%20img.convert('L')%0Aimgry.save('g'%2B'code.jpg')%0A%0A%23%E4%BA%8C%E5%80%BC%E5%8C%96%EF%BC%8C%E9%87%87%E7%94%A8%E9%98%88%E5%80%BC%E5%88%86%E5%89%B2%E6%B3%95%EF%BC%8Cthreshold%E4%B8%BA%E5%88%86%E5%89%B2%E7%82%B9%0Athrshold%20%3D%20140%0Atable%20%3D%20%5B%5D%0Afor%20j%20in%20range(256)%3A%0A%20%20%20%20if%20j%20%3C%20thrshold%3A%0A%20%20%20%20%20%20%20%20table.append(0)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20table.append(1)%0Aout%20%3D%20imgry.point(table%2C'1')%0Aout.save('b'%2B'code.jpg')%0A%0A%23%E8%AF%86%E5%88%AB%0Atext%20%3D%20pytesseract.image_to_string(out)%0A%0Aprint(text)%0A%60%60%60%0A%0A--------------------------------------------%0A%0A%23%23%23%23%20**%E5%AF%B9%E4%BA%8E%E6%9B%B4%E5%A4%8D%E6%9D%82%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%EF%BC%8C%E8%AF%86%E5%88%AB%E6%88%91%E4%BB%AC%E4%B8%80%E8%88%AC%E4%BC%9A%E5%80%9F%E5%8A%A9%E4%B8%8E%E6%89%93%E7%A0%81%E5%B9%B3%E5%8F%B0%E6%9D%A5%E5%AE%9E%E7%8E%B0**%0A%0A%E4%BE%8B%E5%A6%82%E4%BA%91%E6%89%93%E7%A0%81%EF%BC%9A%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%E5%90%8E%E9%9C%80%E8%A6%81%E4%BF%AE%E6%94%B9%E9%83%A8%E5%88%86%E5%A6%82%E4%B8%8B%0A%0A!%5BDeepinScrot-3826%5D(https%3A%2F%2Fi.loli.net%2F2018%2F11%2F29%2F5bff278d26908.png)%0A%0A!%5BDeepinScrot-3946%5D(https%3A%2F%2Fi.loli.net%2F2018%2F11%2F29%2F5bff279e82644.png)%0A%0A%60%60%60%0Adef%20get_code_result_by_filename(filename%2Ccodetype)%3A%0A%20%20%20%20%23%20%E7%94%A8%E6%88%B7%E5%90%8D%0A%20%20%20%20username%20%20%20%20%3D%20'wsygfsj'%0A%0A%20%20%20%20%23%20%E5%AF%86%E7%A0%81%0A%20%20%20%20password%20%20%20%20%3D%20'_ljh123456'%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%0A%20%20%20%20%23%20%E8%BD%AF%E4%BB%B6%EF%BC%A9%EF%BC%A4%EF%BC%8C%E5%BC%80%E5%8F%91%E8%80%85%E5%88%86%E6%88%90%E5%BF%85%E8%A6%81%E5%8F%82%E6%95%B0%E3%80%82%E7%99%BB%E5%BD%95%E5%BC%80%E5%8F%91%E8%80%85%E5%90%8E%E5%8F%B0%E3%80%90%E6%88%91%E7%9A%84%E8%BD%AF%E4%BB%B6%E3%80%91%E8%8E%B7%E5%BE%97%EF%BC%81%0A%20%20%20%20appid%20%20%20%20%20%20%20%3D%206001%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%0A%20%20%20%20%23%20%E8%BD%AF%E4%BB%B6%E5%AF%86%E9%92%A5%EF%BC%8C%E5%BC%80%E5%8F%91%E8%80%85%E5%88%86%E6%88%90%E5%BF%85%E8%A6%81%E5%8F%82%E6%95%B0%E3%80%82%E7%99%BB%E5%BD%95%E5%BC%80%E5%8F%91%E8%80%85%E5%90%8E%E5%8F%B0%E3%80%90%E6%88%91%E7%9A%84%E8%BD%AF%E4%BB%B6%E3%80%91%E8%8E%B7%E5%BE%97%EF%BC%81%0A%20%20%20%20appkey%20%20%20%20%20%20%3D%20'3a22796930bb9fdcac622c46e3abf230'%20%20%20%20%0A%0A%20%20%20%20%23%20%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6%0A%20%20%20%20filename%20%20%20%20%3D%20filename%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%0A%20%20%20%20%23%20%E9%AA%8C%E8%AF%81%E7%A0%81%E7%B1%BB%E5%9E%8B%EF%BC%8C%23%20%E4%BE%8B%EF%BC%9A1004%E8%A1%A8%E7%A4%BA4%E4%BD%8D%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%EF%BC%8C%E4%B8%8D%E5%90%8C%E7%B1%BB%E5%9E%8B%E6%94%B6%E8%B4%B9%E4%B8%8D%E5%90%8C%E3%80%82%E8%AF%B7%E5%87%86%E7%A1%AE%E5%A1%AB%E5%86%99%EF%BC%8C%E5%90%A6%E5%88%99%E5%BD%B1%E5%93%8D%E8%AF%86%E5%88%AB%E7%8E%87%E3%80%82%E5%9C%A8%E6%AD%A4%E6%9F%A5%E8%AF%A2%E6%89%80%E6%9C%89%E7%B1%BB%E5%9E%8B%20http%3A%2F%2Fwww.yundama.com%2Fprice.html%0A%20%20%20%20codetype%20%20%20%20%3D%20codetype%0A%0A%20%20%20%20%23%20%E8%B6%85%E6%97%B6%E6%97%B6%E9%97%B4%EF%BC%8C%E7%A7%92%0A%20%20%20%20timeout%20%20%20%20%20%3D%2060%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%0A%20%20%20%20%23%20%E6%A3%80%E6%9F%A5%0A%20%20%20%20if%20(username%20%3D%3D%20'username')%3A%0A%20%20%20%20%20%20%20%20print('%E8%AF%B7%E8%AE%BE%E7%BD%AE%E5%A5%BD%E7%9B%B8%E5%85%B3%E5%8F%82%E6%95%B0%E5%86%8D%E6%B5%8B%E8%AF%95')%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%23%20%E5%88%9D%E5%A7%8B%E5%8C%96%0A%20%20%20%20%20%20%20%20yundama%20%3D%20YDMHttp(username%2C%20password%2C%20appid%2C%20appkey)%0A%0A%20%20%20%20%20%20%20%20%23%20%E7%99%BB%E9%99%86%E4%BA%91%E6%89%93%E7%A0%81%0A%20%20%20%20%20%20%20%20uid%20%3D%20yundama.login()%3B%0A%20%20%20%20%20%20%20%20print('uid%3A%20%25s'%20%25%20uid)%0A%0A%20%20%20%20%20%20%20%20%23%20%E6%9F%A5%E8%AF%A2%E4%BD%99%E9%A2%9D%0A%20%20%20%20%20%20%20%20balance%20%3D%20yundama.balance()%3B%0A%20%20%20%20%20%20%20%20print('balance%3A%20%25s'%20%25%20balance)%0A%0A%20%20%20%20%20%20%20%20%23%20%E5%BC%80%E5%A7%8B%E8%AF%86%E5%88%AB%EF%BC%8C%E5%9B%BE%E7%89%87%E8%B7%AF%E5%BE%84%EF%BC%8C%E9%AA%8C%E8%AF%81%E7%A0%81%E7%B1%BB%E5%9E%8BID%EF%BC%8C%E8%B6%85%E6%97%B6%E6%97%B6%E9%97%B4%EF%BC%88%E7%A7%92%EF%BC%89%EF%BC%8C%E8%AF%86%E5%88%AB%E7%BB%93%E6%9E%9C%0A%20%20%20%20%20%20%20%20cid%2C%20result%20%3D%20yundama.decode(filename%2C%20codetype%2C%20timeout)%3B%0A%20%20%20%20%20%20%20%20print('cid%3A%20%25s%2C%20result%3A%20%25s'%20%25%20(cid%2C%20result))%0A%0A%20%20%20%20%20%20%20%20return%20result%0A%60%60%60%0A%0A%E4%BD%BF%E7%94%A8%EF%BC%9A%0A%60%60%60%0Afrom%20PythonHTTP.YDMHTTPHandler%20import%20get_code_result_by_filename%0Aimport%20requests%0A%0Aheaders%20%3D%20%7B%0A%20%20%20%20'User-Agent'%3A'Mozilla%2F5.0%20(X11%3B%20Linux%20x86_64)%20AppleWebKit%2F537.36%20(KHTML%2C%20like%20Gecko)%20Chrome%2F67.0.3396.99%20Safari%2F537.36'%2C%0A%7D%0A%0A%23%E8%8E%B7%E5%8F%96%E9%AA%8C%E8%AF%81%E7%A0%81%EF%BC%9A%0Aurl%20%3D%20%22https%3A%2F%2Fwww.douban.com%2Fmisc%2Fcaptcha%3Fid%3DtuvjIlLfdVLHQZmnLubDsZ8C%3Aen%26size%3Ds%22%0A%0Aresponse%20%3D%20requests.get(url%2Cheaders%3Dheaders)%0A%0Aif%20response.status_code%20%3D%3D%20200%3A%0A%20%20%20%20with%20open('image.png'%2C'wb')%20as%20file%3A%0A%20%20%20%20%20%20%20%20file.write(response.content)%0A%0Aelse%3A%0A%20%20%20%20print('%E4%B8%8B%E8%BD%BD%E5%A4%B1%E8%B4%A5')%0A%0Acodetype%20%3D%203009%0Aresult%20%3D%20get_code_result_by_filename('image.png'%2Ccodetype)%0A%0Aprint(result)%0A%60%60%60%0A%0A%23%23%23%23%20%E6%96%97%E9%B1%BC%E6%A8%A1%E6%8B%9F%E7%99%BB%E5%BD%95%E6%A1%88%E4%BE%8B%2C%E7%BB%93%E5%90%88%E8%B6%85%E7%BA%A7%E9%B9%B0%E6%89%93%E7%A0%81%E5%B9%B3%E5%8F%B0(%E4%BA%86%E8%A7%A3)%0A%60%60%60%0Afrom%20selenium%20import%20webdriver%0Aimport%20time%0Aimport%20requests%0Afrom%20io%20import%20BytesIO%0Afrom%20PIL%20import%20Image%0Afrom%20chaojiying%20import%20Chaojiying_Client%0Afrom%20selenium.webdriver%20import%20ActionChains%0A%0Adriver%20%3D%20webdriver.Chrome(executable_path%3D'%2Fhome%2Fljh%2F%E6%A1%8C%E9%9D%A2%2Fdriver%2Fchromedriver')%0A%0Adriver.get('https%3A%2F%2Fpassport.douyu.com%2Fmember%2Flogin%3Flang%3Dcn%26type%3Dlogin%26client_id%3D1')%0A%0Adriver.find_element_by_xpath('%2F%2Fspan%5B%40class%3D%22scancide-to%20js-to-link%20js-need-param%20fr%22%5D').click()%0A%0Adriver.find_element_by_name('phoneNum').send_keys('18518753265')%0A%0Adriver.find_element_by_name('password').send_keys('ljh12345678')%0A%0Atime.sleep(1)%0A%0Adriver.find_element_by_xpath('%2F%2Finput%5B%40class%3D%22loginbox-sbt%20btn-sub%22%5D').click()%0A%0Atime.sleep(4)%0A%0Aimgae_element_div%20%3D%20driver.find_element_by_xpath('%2F%2Fdiv%5B%40class%3D%22geetest_widget%20geetest_medium_fontsize%22%5D')%0A%0Alocation%20%3D%20imgae_element_div.location%0Asize%20%3D%20imgae_element_div.size%0Aprint(location)%0Aprint(size)%0A%0Atop%2Cbottom%2Cleft%2Cright%20%3D%20location%5B'y'%5D%2B2%2Clocation%5B'y'%5D%2Bsize%5B'height'%5D-42%2Clocation%5B'x'%5D-size%5B'width'%5D-2%2Clocation%5B'x'%5D-4%0A%0Aprint(top%2Cbottom%2Cleft%2Cright)%0A%0Ascreen_image%20%3D%20driver.get_screenshot_as_png()%0A%0Ascreen_image%20%3D%20Image.open(BytesIO(screen_image))%0A%0Acaptcha%20%3D%20screen_image.crop((left%2Ctop%2Cright%2Cbottom))%0A%0Acaptcha.save('image.png')%0A%0Achaojiying%20%3D%20Chaojiying_Client('18518753265'%2C%20'ljh12345678'%2C%20'898122')%0Aim%20%3D%20open('image.png'%2C%20'rb').read()%0Aresult%20%3D%20chaojiying.PostPic(im%2C%209004)%0Aprint(result)%0A%0Apic_str%20%3D%20result%5B'pic_str'%5D.split(%22%7C%22)%0Apic_id%20%3D%20result%5B'pic_id'%5D%0Alocations%20%3D%20%5B%5Blocation%20for%20location%20in%20pic_location.split(%22%2C%22)%5D%20for%20pic_location%20in%20pic_str%5D%0Aprint(locations)%0A%0Afor%20location%20in%20locations%3A%0A%20%20%20%20ActionChains(driver).move_to_element_with_offset(imgae_element_div%2Cint(location%5B0%5D)%2Cint(location%5B1%5D)).click().perform()%0A%20%20%20%20time.sleep(1)%0A%0Adriver.find_element_by_xpath('%2F%2Fdiv%5B%40class%3D%22geetest_commit_tip%22%5D').click()%0A%0Atime.sleep(4)%0A%0Aif%20driver.find_element_by_xpath('%2F%2Fdiv%5B%40class%3D%22geetest_widget%20geetest_medium_fontsize%22%5D')%3A%0A%20%20%20%20print('%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5')%0A%20%20%20%20result%20%3D%20chaojiying.ReportError(pic_id)%0A%20%20%20%20print(result)%0A%0A%23%20print(driver.get_cookies())%0A%60%60%60</center></div></body></html>