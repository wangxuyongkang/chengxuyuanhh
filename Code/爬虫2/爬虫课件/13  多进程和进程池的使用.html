<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.0.5 (458014)"/><meta name="altitude" content="36"/><meta name="author" content="李居豪"/><meta name="created" content="2019-05-26 15:23:21 +0000"/><meta name="latitude" content="39.6315583124646"/><meta name="longitude" content="116.0505118918222"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2019-06-04 00:37:07 +0000"/><meta name="content-class" content="yinxiang.markdown"/><title>13  多进程和进程池的使用</title></head><body><div><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(82, 134, 188); text-decoration: underline; box-sizing: content-box;">进程以及状态</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(82, 134, 188); text-decoration: underline; box-sizing: content-box;">进程的创建-multiprocessing</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(82, 134, 188); text-decoration: underline; box-sizing: content-box;">进程与线程的对比：</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(82, 134, 188); text-decoration: underline; box-sizing: content-box;">进程间通信-Queue</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(82, 134, 188); text-decoration: underline; box-sizing: content-box;">进程池Pool</span></div></li></ul><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">进程以及状态</span></h3><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">1. 什么是进程</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">程序：例如xxx.py这是程序，是一个静态的</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">进程</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：一个程序运行起来后，代码+用到的资源 称之为进程，它是操作系统分配资源的基本单元。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">不仅可以通过线程完成多任务，进程也是可以的</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">2. 进程的状态</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">工作中，任务数往往大于cpu的核数，即一定有一些任务正在执行，而另外一些任务在等待cpu进行执行，因此导致了有了不同的状态</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;"><img src="13%20%20%E5%A4%9A%E8%BF%9B%E7%A8%8B%E5%92%8C%E8%BF%9B%E7%A8%8B%E6%B1%A0%E7%9A%84%E4%BD%BF%E7%94%A8.resources/C2AADEA9-8379-4341-AECD-8A06325C8676.png" height="296" width="859"/></span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">就绪态：运行的条件都已经慢去，正在等在cpu执行</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">执行态：cpu正在执行其功能</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">等待态：等待某些条件满足，例如一个程序sleep了，此时就处于等待态</span></div></li></ul><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">进程的创建-multiprocessing</span></h3><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">multiprocessing</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">模块就是跨平台版本的多进程模块，提供了一个Process类来代表一个进程对象，这个对象可以理解为是一个独立的进程，可以执行另外的事情</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">例１. 　2个while循环一起执行</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># -*- coding:utf-8 -*-</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">from multiprocessing import Process</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import time</span></div><div><br/></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def run_proc():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">"""子进程要执行的代码"""</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">while True:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("----2----")</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(1)</span></div><div><br/></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">if __name__=='__main__':</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p = Process(target=run_proc)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p.start()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">while True:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("----1----")</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(1)</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">说明</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">创建子进程时，只需要传入一个执行函数和函数的参数，创建一个Process实例，用start()方法启动</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">例2. 　进程pid</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># -*- coding:utf-8 -*-</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">from multiprocessing import Process</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import os</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import time</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def run_proc():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">"""子进程要执行的代码"""</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print('子进程运行中，pid=%d...' % os.getpid()) # os.getpid获取当前进程的进程号</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print('子进程将要结束...')</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">if __name__ == '__main__':</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print('父进程pid: %d' % os.getpid()) # os.getpid获取当前进程的进程号</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p = Process(target=run_proc)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(p.name)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p.start()</span></div></div></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#可以获取所有进程，三方包需要安装才能使用</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import psutil</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">pids = psutil.pids()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for pid in pids:</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p = psutil.Process(pid)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("pid-%d,pname-%s" %(pid,p.name()))</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">3. Process参数如下：</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">Process(group, target, name, args , kwargs)</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">target：如果传递了函数的引用，可以任务这个子进程就执行这里的代码</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">args：给target指定的函数传递的参数，以元组的方式传递</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">kwargs：给target指定的函数传递命名参数</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">name：给进程设定一个名字，可以不设定</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">group：指定进程组，大多数情况下用不到</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">Process创建的实例对象的常用方法：</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">start()：启动子进程实例（创建子进程）</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">is_alive()：判断进程子进程是否还在活着</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">join([timeout])：是否等待子进程执行结束，或等待多少秒</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">terminate()：不管任务是否完成，立即终止子进程</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">Process创建的实例对象的常用属性：</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">name：当前进程的别名，默认为Process-N，N为从1开始递增的整数</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">pid：当前进程的pid（进程号）</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">4. 给子进程指定的函数传递参数</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># -*- coding:utf-8 -*-</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">from multiprocessing import Process</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import os</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">from time import sleep</span></div><div><br/></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def run_proc(name, age, **kwargs):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(10):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print('子进程运行中，name= %s,age=%d ,pid=%d...' % (name, age, os.getpid()))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(kwargs)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">sleep(0.2)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">if __name__=='__main__':</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p = Process(target=run_proc, args=('test',18), kwargs={"m":20})</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p.start()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">sleep(1) # 1秒中之后，立即结束子进程</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p.terminate()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p.join()</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">运行结果:</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">子进程运行中，name= test,age=18 ,pid=45097...</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">{'m': 20}</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">子进程运行中，name= test,age=18 ,pid=45097...</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">{'m': 20}</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">子进程运行中，name= test,age=18 ,pid=45097...</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">{'m': 20}</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">子进程运行中，name= test,age=18 ,pid=45097...</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">{'m': 20}</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">子进程运行中，name= test,age=18 ,pid=45097...</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">{'m': 20}</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">5. 进程间不同享全局变量</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># -*- coding:utf-8 -*-</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">from multiprocessing import Process</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import os</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import time</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">nums = [11, 22]</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def work1():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">"""子进程要执行的代码"""</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("in process1 pid=%d ,nums=%s" % (os.getpid(), nums))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(3):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">nums.append(i)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(1)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("in process1 pid=%d ,nums=%s" % (os.getpid(), nums))</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def work2():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">"""子进程要执行的代码"""</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("in process2 pid=%d ,nums=%s" % (os.getpid(), nums))</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">if __name__ == '__main__':</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p1 = Process(target=work1)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p1.start()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p1.join()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p2 = Process(target=work2)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p2.start()</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">运行结果:</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">in process1 pid=11349 ,nums=[11, 22]</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">in process1 pid=11349 ,nums=[11, 22, 0]</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">in process1 pid=11349 ,nums=[11, 22, 0, 1]</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">in process1 pid=11349 ,nums=[11, 22, 0, 1, 2]</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">in process2 pid=11350 ,nums=[11, 22]</span></div></div></div><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%; box-sizing: content-box;">进程间通信-Queue</span></h3><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">进程间通信-Queue:</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">Process之间有时需要通信，操作系统提供了很多机制来实现进程间的通信。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">1. Queue的使用</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">可以使用</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">multiprocessing</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">模块的</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">Queue</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">实现多进程之间的数据传递，</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">Queue</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">本身是一个消息列队程序，以下小实例来演示一下Queue的工作原理：</span></div></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#coding=utf-8</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">from multiprocessing import Queue</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">q=Queue(3) #初始化一个Queue对象，最多可接收三条put消息</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">q.put("消息1")</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">q.put("消息2")</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(q.full()) #False</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">q.put("消息3")</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(q.full()) #True</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#因为消息列队已满下面的try都会抛出异常，第一个try会等待2秒后再抛出异常，第二个Try会立刻抛出异常</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">try:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">q.put("消息4",True,2)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">except:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("消息列队已满，现有消息数量:%s"%q.qsize())</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">try:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">q.put_nowait("消息4")</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">except:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("消息列队已满，现有消息数量:%s"%q.qsize())</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#推荐的方式，先判断消息列队是否已满，再写入</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">if not q.full():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">q.put_nowait("消息4")</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#读取消息时，先判断消息列队是否为空，再读取</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">if not q.empty():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(q.qsize()):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(q.get_nowait())</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">运行结果</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">:</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">False</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">True</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">消息列队已满，现有消息数量:3</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">消息列队已满，现有消息数量:3</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">消息1</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">消息2</span></div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">消息3</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">说明</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">初始化Queue()对象时（例如：q=Queue()），若括号中没有指定最大可接收的消息数量，或数量为负值，那么就代表可接受的消息数量没有上限（直到内存的尽头）；</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">Queue.qsize()</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：返回当前队列包含的消息数量；</span></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">Queue.empty()</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：如果队列为空，返回True，反之False ；</span></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">Queue.full()</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：如果队列满了，返回True,反之False；</span></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">Queue.get(block, timeout)</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：获取队列中的一条消息，然后将其从列队中移除，block默认值为True；</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">1）如果block使用默认值，且没有设置timeout（单位秒），消息列队如果为空，此时程序将被阻塞（停在读取状态），直到从消息列队读到消息为止，如果设置了timeout，则会等待timeout秒，若还没读取到任何消息，则抛出"Queue.Empty"异常；</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">2）如果block值为False，消息列队如果为空，则会立刻抛出"Queue.Empty"异常；</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">Queue.get_nowait()</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：相当Queue.get(False)；</span></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">Queue.put(item,block,timeout)</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：将item消息写入队列，block默认值为True；</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">1）如果block使用默认值，且没有设置timeout（单位秒），消息列队如果已经没有空间可写入，此时程序将被阻塞（停在写入状态），直到从消息列队腾出空间为止，如果设置了timeout，则会等待timeout秒，若还没空间，则抛出"Queue.Full"异常；</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">2）如果block值为False，消息列队如果没有空间可写入，则会立刻抛出"Queue.Full"异常；</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">Queue.put_nowait(item)</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：相当Queue.put(item, False)；</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">2. Queue实例以及在多进程间的使用</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">我们以Queue为例，在父进程中创建两个子进程，一个往Queue里写数据，一个从Queue里读数据：</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">from multiprocessing import Process, Queue</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import os, time, random</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 写数据进程执行的代码:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def write(q):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for value in ['A', 'B', 'C', 'D', 'E']:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print('Put %s to queue...' % value)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">q.put(value)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(random.random())</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 读数据进程执行的代码:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def read(q):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">while True:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">if not q.empty():</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">value = q.get(True)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print('Get %s from queue.' % value)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(random.random())</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">else:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">break</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">if __name__=='__main__':</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 父进程创建Queue，并传给各个子进程：</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">q = Queue()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">pw = Process(target=write, args=(q,))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">pr = Process(target=read, args=(q,))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 启动子进程pw，写入:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">pw.start()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 等待pw结束:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">pw.join()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 启动子进程pr，读取:</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">pr.start()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">pr.join()</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print('所有数据都写入并且读完')</span></div></div></div><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%; box-sizing: content-box;">进程池Pool</span></h3><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">当需要创建的子进程数量不多时，可以直接利用multiprocessing中的Process动态成生多个进程，但如果是上百甚至上千个目标，手动的去创建进程的工作量巨大，此时就可以用到multiprocessing模块提供的Pool方法。</span></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">初始化Pool时，可以指定一个最大进程数，当有新的请求提交到Pool中时，如果池还没有满，那么就会创建一个新的进程用来执行该请求；但如果池中的进程数已经达到指定的最大值，那么该请求就会等待，直到池中有进程结束，才会用之前的进程来执行新的任务，请看下面的实例：</span></div></li></ul><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># -*- coding:utf-8 -*-</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">from multiprocessing import Pool</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import os, time, random</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def worker(msg):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t_start = time.time()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("%s开始执行,进程号为%d" % (msg,os.getpid()))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># random.random()随机生成0~1之间的浮点数</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(random.random()*2)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">t_stop = time.time()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(msg,"执行完毕，耗时%0.2f" % (t_stop-t_start))</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">po = Pool(3) # 定义一个进程池，最大进程数3</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(0,10):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># Pool().apply_async(要调用的目标,(传递给目标的参数元祖,))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 每次循环将会用空闲出来的子进程去调用目标</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">po.apply_async(worker,(i,))</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("----start----")</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">po.close() # 关闭进程池，关闭后po(进程池)不再接收新任务</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">po.join() # 等待po(进程池)中所有子进程执行完成，必须放在close语句之后</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("-----end-----")</span></div><div><br/></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">运行结果:</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">----start----</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">0开始执行,进程号为21466</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">1开始执行,进程号为21468</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">2开始执行,进程号为21467</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">0 执行完毕，耗时1.01</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">3开始执行,进程号为21466</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">2 执行完毕，耗时1.24</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">4开始执行,进程号为21467</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">3 执行完毕，耗时0.56</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">5开始执行,进程号为21466</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">1 执行完毕，耗时1.68</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">6开始执行,进程号为21468</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">4 执行完毕，耗时0.67</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">7开始执行,进程号为21467</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">5 执行完毕，耗时0.83</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">8开始执行,进程号为21466</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">6 执行完毕，耗时0.75</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">9开始执行,进程号为21468</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">7 执行完毕，耗时1.03</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">8 执行完毕，耗时1.05</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">9 执行完毕，耗时1.69</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">-----end-----</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">multiprocessing.Pool常用函数解析：</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">apply_async(func[, args[, kwds]])</span> <span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：使用非阻塞方式调用func（并行执行，堵塞方式必须等待上一个进程退出才能执行下一个进程），args为传递给func的参数列表，kwds为传递给func的关键字参数列表；</span></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">close()</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：关闭Pool，使其不再接受新的任务；</span></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">terminate()</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：不管任务是否完成，立即终止；</span></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">join()</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：主进程阻塞，等待子进程的退出， 必须在close或terminate之后使用；</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">进程池中中进程通信Manager().Queue()</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">如果要使用Pool创建进程，就需要使用multiprocessing.Manager()中的Queue()，而不是multiprocessing.Queue()，否则会得到一条如下的错误信息：</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">RuntimeError: Queue objects should only be shared between processes through inheritance.</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">下面的实例演示了进程池中的进程如何通信：</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># -*- coding:utf-8 -*-</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># 修改import中的Queue为Manager</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">from multiprocessing import Manager,Pool</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import os,time,random</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def writer(q):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("writer启动(%s),父进程为(%s)" % (os.getpid(), os.getppid()))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in "beicai1804":</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">q.put(i)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def reader(q):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("reader启动(%s),父进程为(%s)" % (os.getpid(), os.getppid()))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(q.qsize()):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("reader从Queue获取到消息：%s" % q.get(True))</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">if __name__=="__main__":</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("(%s) start" % os.getpid())</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">q = Manager().Queue() # 使用Manager中的Queue</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">po = Pool()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">po.apply_async(writer, (q,))</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(1) # 先让上面的任务向Queue存入数据，然后再让下面的任务开始从中取数据</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">po.apply_async(reader, (q,))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">po.close()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">po.join()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print("(%s) End" % os.getpid())</span></div></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">运行结果:</span></div><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">(11095) start</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">writer启动(11097),父进程为(11095)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">reader启动(11098),父进程为(11095)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">reader从Queue获取到消息：b</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">reader从Queue获取到消息：e</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">reader从Queue获取到消息：i</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">reader从Queue获取到消息：c</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">reader从Queue获取到消息：a</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">reader从Queue获取到消息：i</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">......</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">(11095) End</span></div></div></div><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">进程与线程的对比：</span></h3><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">进程、线程对比</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">功能</span></div></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">进程，能够完成多任务，比如 在一台电脑上能够同时运行多个QQ</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">线程，能够完成多任务，比如 一个QQ中的多个聊天窗口</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">定义的不同</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">进程是系统进行资源分配基本单位.</span></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">线程是进程的一个实体,是CPU调度和分派的基本单位,它是比进程更小的能独立运行的基本单位.</span></div></li><li style="box-sizing: content-box; position: relative;"><div style="box-sizing: content-box; margin: 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">线程自己基本上不拥有系统资源,只拥有一点在运行中必不可少的资源(如程序计数器,一组寄存器和栈),但是它可与同属一个进程的其他的线程共享所在进程所拥有的全部资源</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">区别</span></div><ul style="box-sizing: content-box; list-style-type: disc; padding-left: 30px; margin: 6px 0px 10px;"><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">一个程序至少有一个进程,一个进程至少有一个线程.</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">线程的划分尺度小于进程(资源比进程少)，使得多线程程序的并发性高。</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">进程在执行过程中拥有独立的内存单元，而多个线程共享内存，从而极大地提高了程序的运行效率</span></div></li><li style="box-sizing: content-box; position: relative;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">线线程不能够独立执行，必须依存在进程中</span></div></li></ul><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">优缺点</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">线程和进程在使用上各有优缺点：线程执行开销小，但不利于资源的管理和保护；而进程正相反。</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">使用场景</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：</span></div><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">多进程常用来处理计算密集型任务</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">计算密集型任务的特点：是要进行大量的计算，消耗CPU资源，比如计算圆周率、对视频进行高清解码等等，全靠CPU的运算能力。计算密集型任务可以用多任务完成，但是任务越多，花在任务切换的时间就越多，CPU执行任务的效率就越低，所以，要最高效地利用CPU，计算密集型任务同时进行的数量应当等于CPU的核心数。</span></div></div><div style="box-sizing: content-box; margin: 10px 0px;"><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">多线程常用来处理IO密集型任务</span><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">：</span></div><div><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">IO密集型：涉及到网络、磁盘IO的任务都是IO密集型任务，特点是CPU消耗很少，任务的大部分时间都在等待IO操作完成（因为IO的速度远远低于CPU和内存的速度）。但是也要切记，在执行多任务时，并不是越多线程越好。</span></div></div><hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">案例一: 将jobbole多线程修改为多进程爬虫</span></div><hr style="line-height: 160%; box-sizing: content-box; border-top: 1px solid #eee; margin: 16px 0;"/><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">进程池</span></h3><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%; font-weight: 700; box-sizing: content-box;">创建进程的两种方式</span></div><h3 style="box-sizing: content-box; font-size: 27px;"><span style="font-size: 27px; color: rgb(51, 51, 51); font-weight: 700; line-height: 160%;">第一种</span></h3><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">from multiprocessing import Pool</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import os,time</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def runtest(num):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print('进程开启'+str(os.getpid()))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(2)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># print(num)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print('进程结束'+str(os.getpid()))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">return num</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def done(future):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(future)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#构建一个进程池</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p = Pool(4)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(0,50):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#func：表示方法（函数）的名称，args：方法（函数）的参数是一个tuple（元组），</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#callback回调函数(不一定要写，看需求)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p.apply_async(func=runtest,args=(i,),callback=done)</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#close()表示关闭进程池，不能再往里面添加任务</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p.close()</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">p.join()</span></div></div></div><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; color: rgb(51, 51, 51); line-height: 160%;">第二种</span></h4><div style="box-sizing: content-box; border: 0px; border-radius: 0px; margin: 2px 0px 8px; background-color: rgb(245, 247, 248);"><div style="overflow-x: auto; background: rgb(30, 30, 30); box-sizing: content-box; border: 0px; border-radius: 0px; letter-spacing: -0.3px; padding: 18px; white-space: pre-wrap;"><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">from concurrent.futures import ThreadPoolExecutor,ProcessPoolExecutor</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">import time,os</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">#创建一个进程池</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def runtest(num):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print('进程开启'+str(os.getpid()))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">time.sleep(2)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);"># print(num)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print('进程结束'+str(os.getpid()))</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">return num</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">def done(future):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">print(future.result())</span></div><div><br/></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">pool = ProcessPoolExecutor(4)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">for i in range(0,50):</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">handler = pool.submit(runtest,i)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">handler.add_done_callback(done)</span></div><div><span style="font-size: 14px; line-height: 160%; color: rgb(244, 244, 244);">pool.shutdown(wait=True)</span></div></div></div><h4 style="box-sizing: content-box; font-size: 20px;"><span style="font-size: 20px; color: rgb(51, 51, 51); line-height: 160%;">课后作业：</span></h4><div style="box-sizing: content-box; margin: 10px 0px;"><span style="font-size: 14px; color: rgb(51, 51, 51); line-height: 160%;">自定义一个类,可以设置任意京东商品url地址，获取该商品的全部评论信息，将评论信息数据分别保存至csv文件和mysql数据库，要求使用进程池来完成</span></div></div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">*%20%5B%E8%BF%9B%E7%A8%8B%E4%BB%A5%E5%8F%8A%E7%8A%B6%E6%80%81%5D(%23%E8%BF%9B%E7%A8%8B%E4%BB%A5%E5%8F%8A%E7%8A%B6%E6%80%81)%0A*%20%5B%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%88%9B%E5%BB%BA-multiprocessing%5D(%23%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%88%9B%E5%BB%BA-multiprocessing)%0A*%20%5B%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%AF%B9%E6%AF%94%EF%BC%9A%5D(%23%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%AF%B9%E6%AF%94)%0A*%20%5B%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1-Queue%5D(%23%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1-queue)%0A*%20%5B%E8%BF%9B%E7%A8%8B%E6%B1%A0Pool%5D(%23%E8%BF%9B%E7%A8%8B%E6%B1%A0pool)%0A%0A%23%23%23%20%E8%BF%9B%E7%A8%8B%E4%BB%A5%E5%8F%8A%E7%8A%B6%E6%80%81%0A**1.%20%E4%BB%80%E4%B9%88%E6%98%AF%E8%BF%9B%E7%A8%8B**%0A%E7%A8%8B%E5%BA%8F%EF%BC%9A%E4%BE%8B%E5%A6%82xxx.py%E8%BF%99%E6%98%AF%E7%A8%8B%E5%BA%8F%EF%BC%8C%E6%98%AF%E4%B8%80%E4%B8%AA%E9%9D%99%E6%80%81%E7%9A%84%0A%0A**%E8%BF%9B%E7%A8%8B**%EF%BC%9A%E4%B8%80%E4%B8%AA%E7%A8%8B%E5%BA%8F%E8%BF%90%E8%A1%8C%E8%B5%B7%E6%9D%A5%E5%90%8E%EF%BC%8C%E4%BB%A3%E7%A0%81%2B%E7%94%A8%E5%88%B0%E7%9A%84%E8%B5%84%E6%BA%90%20%E7%A7%B0%E4%B9%8B%E4%B8%BA%E8%BF%9B%E7%A8%8B%EF%BC%8C%E5%AE%83%E6%98%AF%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%88%86%E9%85%8D%E8%B5%84%E6%BA%90%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8D%95%E5%85%83%E3%80%82%0A%0A%E4%B8%8D%E4%BB%85%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E7%BA%BF%E7%A8%8B%E5%AE%8C%E6%88%90%E5%A4%9A%E4%BB%BB%E5%8A%A1%EF%BC%8C%E8%BF%9B%E7%A8%8B%E4%B9%9F%E6%98%AF%E5%8F%AF%E4%BB%A5%E7%9A%84%0A%0A**2.%20%E8%BF%9B%E7%A8%8B%E7%9A%84%E7%8A%B6%E6%80%81**%0A%0A%E5%B7%A5%E4%BD%9C%E4%B8%AD%EF%BC%8C%E4%BB%BB%E5%8A%A1%E6%95%B0%E5%BE%80%E5%BE%80%E5%A4%A7%E4%BA%8Ecpu%E7%9A%84%E6%A0%B8%E6%95%B0%EF%BC%8C%E5%8D%B3%E4%B8%80%E5%AE%9A%E6%9C%89%E4%B8%80%E4%BA%9B%E4%BB%BB%E5%8A%A1%E6%AD%A3%E5%9C%A8%E6%89%A7%E8%A1%8C%EF%BC%8C%E8%80%8C%E5%8F%A6%E5%A4%96%E4%B8%80%E4%BA%9B%E4%BB%BB%E5%8A%A1%E5%9C%A8%E7%AD%89%E5%BE%85cpu%E8%BF%9B%E8%A1%8C%E6%89%A7%E8%A1%8C%EF%BC%8C%E5%9B%A0%E6%AD%A4%E5%AF%BC%E8%87%B4%E4%BA%86%E6%9C%89%E4%BA%86%E4%B8%8D%E5%90%8C%E7%9A%84%E7%8A%B6%E6%80%81%0A%0A!%5BDeepinScrot-5453%5D(https%3A%2F%2Fi.loli.net%2F2018%2F10%2F23%2F5bce806168576.png)%0A%0A%0A-%20%E5%B0%B1%E7%BB%AA%E6%80%81%EF%BC%9A%E8%BF%90%E8%A1%8C%E7%9A%84%E6%9D%A1%E4%BB%B6%E9%83%BD%E5%B7%B2%E7%BB%8F%E6%85%A2%E5%8E%BB%EF%BC%8C%E6%AD%A3%E5%9C%A8%E7%AD%89%E5%9C%A8cpu%E6%89%A7%E8%A1%8C%0A-%20%E6%89%A7%E8%A1%8C%E6%80%81%EF%BC%9Acpu%E6%AD%A3%E5%9C%A8%E6%89%A7%E8%A1%8C%E5%85%B6%E5%8A%9F%E8%83%BD%0A-%20%E7%AD%89%E5%BE%85%E6%80%81%EF%BC%9A%E7%AD%89%E5%BE%85%E6%9F%90%E4%BA%9B%E6%9D%A1%E4%BB%B6%E6%BB%A1%E8%B6%B3%EF%BC%8C%E4%BE%8B%E5%A6%82%E4%B8%80%E4%B8%AA%E7%A8%8B%E5%BA%8Fsleep%E4%BA%86%EF%BC%8C%E6%AD%A4%E6%97%B6%E5%B0%B1%E5%A4%84%E4%BA%8E%E7%AD%89%E5%BE%85%E6%80%81%0A%0A%0A%23%23%23%20%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%88%9B%E5%BB%BA-multiprocessing%0A%0A**multiprocessing**%E6%A8%A1%E5%9D%97%E5%B0%B1%E6%98%AF%E8%B7%A8%E5%B9%B3%E5%8F%B0%E7%89%88%E6%9C%AC%E7%9A%84%E5%A4%9A%E8%BF%9B%E7%A8%8B%E6%A8%A1%E5%9D%97%EF%BC%8C%E6%8F%90%E4%BE%9B%E4%BA%86%E4%B8%80%E4%B8%AAProcess%E7%B1%BB%E6%9D%A5%E4%BB%A3%E8%A1%A8%E4%B8%80%E4%B8%AA%E8%BF%9B%E7%A8%8B%E5%AF%B9%E8%B1%A1%EF%BC%8C%E8%BF%99%E4%B8%AA%E5%AF%B9%E8%B1%A1%E5%8F%AF%E4%BB%A5%E7%90%86%E8%A7%A3%E4%B8%BA%E6%98%AF%E4%B8%80%E4%B8%AA%E7%8B%AC%E7%AB%8B%E7%9A%84%E8%BF%9B%E7%A8%8B%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%89%A7%E8%A1%8C%E5%8F%A6%E5%A4%96%E7%9A%84%E4%BA%8B%E6%83%85%0A%0A**%E4%BE%8B%EF%BC%91.%20%E3%80%802%E4%B8%AAwhile%E5%BE%AA%E7%8E%AF%E4%B8%80%E8%B5%B7%E6%89%A7%E8%A1%8C**%0A%60%60%60%0A%23%20-*-%20coding%3Autf-8%20-*-%0Afrom%20multiprocessing%20import%20Process%0Aimport%20time%0A%0A%0Adef%20run_proc()%3A%0A%20%20%20%20%22%22%22%E5%AD%90%E8%BF%9B%E7%A8%8B%E8%A6%81%E6%89%A7%E8%A1%8C%E7%9A%84%E4%BB%A3%E7%A0%81%22%22%22%0A%20%20%20%20while%20True%3A%0A%20%20%20%20%20%20%20%20print(%22----2----%22)%0A%20%20%20%20%20%20%20%20time.sleep(1)%0A%0A%0Aif%20__name__%3D%3D'__main__'%3A%0A%20%20%20%20p%20%3D%20Process(target%3Drun_proc)%0A%20%20%20%20p.start()%0A%20%20%20%20while%20True%3A%0A%20%20%20%20%20%20%20%20print(%22----1----%22)%0A%20%20%20%20%20%20%20%20time.sleep(1)%0A%60%60%60%0A**%E8%AF%B4%E6%98%8E**%0A-%20%E5%88%9B%E5%BB%BA%E5%AD%90%E8%BF%9B%E7%A8%8B%E6%97%B6%EF%BC%8C%E5%8F%AA%E9%9C%80%E8%A6%81%E4%BC%A0%E5%85%A5%E4%B8%80%E4%B8%AA%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0%E5%92%8C%E5%87%BD%E6%95%B0%E7%9A%84%E5%8F%82%E6%95%B0%EF%BC%8C%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAProcess%E5%AE%9E%E4%BE%8B%EF%BC%8C%E7%94%A8start()%E6%96%B9%E6%B3%95%E5%90%AF%E5%8A%A8%0A%0A**%E4%BE%8B2.%20%E3%80%80%E8%BF%9B%E7%A8%8Bpid**%0A%60%60%60%0A%23%20-*-%20coding%3Autf-8%20-*-%0Afrom%20multiprocessing%20import%20Process%0Aimport%20os%0Aimport%20time%0A%0Adef%20run_proc()%3A%0A%20%20%20%20%22%22%22%E5%AD%90%E8%BF%9B%E7%A8%8B%E8%A6%81%E6%89%A7%E8%A1%8C%E7%9A%84%E4%BB%A3%E7%A0%81%22%22%22%0A%20%20%20%20print('%E5%AD%90%E8%BF%9B%E7%A8%8B%E8%BF%90%E8%A1%8C%E4%B8%AD%EF%BC%8Cpid%3D%25d...'%20%25%20os.getpid())%20%20%23%20os.getpid%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E8%BF%9B%E7%A8%8B%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%8F%B7%0A%20%20%20%20print('%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%B0%86%E8%A6%81%E7%BB%93%E6%9D%9F...')%0A%0Aif%20__name__%20%3D%3D%20'__main__'%3A%0A%20%20%20%20print('%E7%88%B6%E8%BF%9B%E7%A8%8Bpid%3A%20%25d'%20%25%20os.getpid())%20%20%23%20os.getpid%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E8%BF%9B%E7%A8%8B%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%8F%B7%0A%20%20%20%20p%20%3D%20Process(target%3Drun_proc)%0A%20%20%20%20print(p.name)%0A%20%20%20%20p.start()%0A%60%60%60%0A%60%60%60%0A%23%E5%8F%AF%E4%BB%A5%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E8%BF%9B%E7%A8%8B%EF%BC%8C%E4%B8%89%E6%96%B9%E5%8C%85%E9%9C%80%E8%A6%81%E5%AE%89%E8%A3%85%E6%89%8D%E8%83%BD%E4%BD%BF%E7%94%A8%0Aimport%20psutil%0A%0Apids%20%3D%20psutil.pids()%0A%0Afor%20pid%20in%20pids%3A%0A%0A%20%20%20%20p%20%3D%20psutil.Process(pid)%0A%0A%20%20%20%20print(%22pid-%25d%2Cpname-%25s%22%20%25(pid%2Cp.name()))%0A%60%60%60%0A%0A%0A**3.%20Process%E5%8F%82%E6%95%B0%E5%A6%82%E4%B8%8B%EF%BC%9A**%0A%0AProcess(group%2C%20target%2C%20name%2C%20args%20%2C%20kwargs)%0A%0A-%20target%EF%BC%9A%E5%A6%82%E6%9E%9C%E4%BC%A0%E9%80%92%E4%BA%86%E5%87%BD%E6%95%B0%E7%9A%84%E5%BC%95%E7%94%A8%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%BB%BB%E5%8A%A1%E8%BF%99%E4%B8%AA%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%B0%B1%E6%89%A7%E8%A1%8C%E8%BF%99%E9%87%8C%E7%9A%84%E4%BB%A3%E7%A0%81%0A-%20args%EF%BC%9A%E7%BB%99target%E6%8C%87%E5%AE%9A%E7%9A%84%E5%87%BD%E6%95%B0%E4%BC%A0%E9%80%92%E7%9A%84%E5%8F%82%E6%95%B0%EF%BC%8C%E4%BB%A5%E5%85%83%E7%BB%84%E7%9A%84%E6%96%B9%E5%BC%8F%E4%BC%A0%E9%80%92%0A-%20kwargs%EF%BC%9A%E7%BB%99target%E6%8C%87%E5%AE%9A%E7%9A%84%E5%87%BD%E6%95%B0%E4%BC%A0%E9%80%92%E5%91%BD%E5%90%8D%E5%8F%82%E6%95%B0%0A-%20name%EF%BC%9A%E7%BB%99%E8%BF%9B%E7%A8%8B%E8%AE%BE%E5%AE%9A%E4%B8%80%E4%B8%AA%E5%90%8D%E5%AD%97%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%B8%8D%E8%AE%BE%E5%AE%9A%0A-%20group%EF%BC%9A%E6%8C%87%E5%AE%9A%E8%BF%9B%E7%A8%8B%E7%BB%84%EF%BC%8C%E5%A4%A7%E5%A4%9A%E6%95%B0%E6%83%85%E5%86%B5%E4%B8%8B%E7%94%A8%E4%B8%8D%E5%88%B0%0A%0A**Process%E5%88%9B%E5%BB%BA%E7%9A%84%E5%AE%9E%E4%BE%8B%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95%EF%BC%9A**%0A%0A-%20start()%EF%BC%9A%E5%90%AF%E5%8A%A8%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%AE%9E%E4%BE%8B%EF%BC%88%E5%88%9B%E5%BB%BA%E5%AD%90%E8%BF%9B%E7%A8%8B%EF%BC%89%0A-%20is_alive()%EF%BC%9A%E5%88%A4%E6%96%AD%E8%BF%9B%E7%A8%8B%E5%AD%90%E8%BF%9B%E7%A8%8B%E6%98%AF%E5%90%A6%E8%BF%98%E5%9C%A8%E6%B4%BB%E7%9D%80%0A-%20join(%5Btimeout%5D)%EF%BC%9A%E6%98%AF%E5%90%A6%E7%AD%89%E5%BE%85%E5%AD%90%E8%BF%9B%E7%A8%8B%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9D%9F%EF%BC%8C%E6%88%96%E7%AD%89%E5%BE%85%E5%A4%9A%E5%B0%91%E7%A7%92%0A-%20terminate()%EF%BC%9A%E4%B8%8D%E7%AE%A1%E4%BB%BB%E5%8A%A1%E6%98%AF%E5%90%A6%E5%AE%8C%E6%88%90%EF%BC%8C%E7%AB%8B%E5%8D%B3%E7%BB%88%E6%AD%A2%E5%AD%90%E8%BF%9B%E7%A8%8B%0A%0A**Process%E5%88%9B%E5%BB%BA%E7%9A%84%E5%AE%9E%E4%BE%8B%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7%EF%BC%9A**%0A%0A-%20name%EF%BC%9A%E5%BD%93%E5%89%8D%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%88%AB%E5%90%8D%EF%BC%8C%E9%BB%98%E8%AE%A4%E4%B8%BAProcess-N%EF%BC%8CN%E4%B8%BA%E4%BB%8E1%E5%BC%80%E5%A7%8B%E9%80%92%E5%A2%9E%E7%9A%84%E6%95%B4%E6%95%B0%0A-%20pid%EF%BC%9A%E5%BD%93%E5%89%8D%E8%BF%9B%E7%A8%8B%E7%9A%84pid%EF%BC%88%E8%BF%9B%E7%A8%8B%E5%8F%B7%EF%BC%89%0A%0A**4.%20%E7%BB%99%E5%AD%90%E8%BF%9B%E7%A8%8B%E6%8C%87%E5%AE%9A%E7%9A%84%E5%87%BD%E6%95%B0%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0**%0A%60%60%60%0A%23%20-*-%20coding%3Autf-8%20-*-%0Afrom%20multiprocessing%20import%20Process%0Aimport%20os%0Afrom%20time%20import%20sleep%0A%0A%0Adef%20run_proc(name%2C%20age%2C%20**kwargs)%3A%0A%20%20%20%20for%20i%20in%20range(10)%3A%0A%20%20%20%20%20%20%20%20print('%E5%AD%90%E8%BF%9B%E7%A8%8B%E8%BF%90%E8%A1%8C%E4%B8%AD%EF%BC%8Cname%3D%20%25s%2Cage%3D%25d%20%2Cpid%3D%25d...'%20%25%20(name%2C%20age%2C%20os.getpid()))%0A%20%20%20%20%20%20%20%20print(kwargs)%0A%20%20%20%20%20%20%20%20sleep(0.2)%0A%0Aif%20__name__%3D%3D'__main__'%3A%0A%20%20%20%20p%20%3D%20Process(target%3Drun_proc%2C%20args%3D('test'%2C18)%2C%20kwargs%3D%7B%22m%22%3A20%7D)%0A%20%20%20%20p.start()%0A%20%20%20%20sleep(1)%20%20%23%201%E7%A7%92%E4%B8%AD%E4%B9%8B%E5%90%8E%EF%BC%8C%E7%AB%8B%E5%8D%B3%E7%BB%93%E6%9D%9F%E5%AD%90%E8%BF%9B%E7%A8%8B%0A%20%20%20%20p.terminate()%0A%20%20%20%20p.join()%0A%60%60%60%0A**%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C%3A**%0A%60%60%60%0A%20%20%20%20%E5%AD%90%E8%BF%9B%E7%A8%8B%E8%BF%90%E8%A1%8C%E4%B8%AD%EF%BC%8Cname%3D%20test%2Cage%3D18%20%2Cpid%3D45097...%0A%20%20%20%20%7B'm'%3A%2020%7D%0A%20%20%20%20%E5%AD%90%E8%BF%9B%E7%A8%8B%E8%BF%90%E8%A1%8C%E4%B8%AD%EF%BC%8Cname%3D%20test%2Cage%3D18%20%2Cpid%3D45097...%0A%20%20%20%20%7B'm'%3A%2020%7D%0A%20%20%20%20%E5%AD%90%E8%BF%9B%E7%A8%8B%E8%BF%90%E8%A1%8C%E4%B8%AD%EF%BC%8Cname%3D%20test%2Cage%3D18%20%2Cpid%3D45097...%0A%20%20%20%20%7B'm'%3A%2020%7D%0A%20%20%20%20%E5%AD%90%E8%BF%9B%E7%A8%8B%E8%BF%90%E8%A1%8C%E4%B8%AD%EF%BC%8Cname%3D%20test%2Cage%3D18%20%2Cpid%3D45097...%0A%20%20%20%20%7B'm'%3A%2020%7D%0A%20%20%20%20%E5%AD%90%E8%BF%9B%E7%A8%8B%E8%BF%90%E8%A1%8C%E4%B8%AD%EF%BC%8Cname%3D%20test%2Cage%3D18%20%2Cpid%3D45097...%0A%20%20%20%20%7B'm'%3A%2020%7D%0A%60%60%60%0A%20**5.%20%E8%BF%9B%E7%A8%8B%E9%97%B4%E4%B8%8D%E5%90%8C%E4%BA%AB%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F**%0A%60%60%60%0A%23%20-*-%20coding%3Autf-8%20-*-%0Afrom%20multiprocessing%20import%20Process%0Aimport%20os%0Aimport%20time%0A%0Anums%20%3D%20%5B11%2C%2022%5D%0A%0Adef%20work1()%3A%0A%20%20%20%20%22%22%22%E5%AD%90%E8%BF%9B%E7%A8%8B%E8%A6%81%E6%89%A7%E8%A1%8C%E7%9A%84%E4%BB%A3%E7%A0%81%22%22%22%0A%20%20%20%20print(%22in%20process1%20pid%3D%25d%20%2Cnums%3D%25s%22%20%25%20(os.getpid()%2C%20nums))%0A%20%20%20%20for%20i%20in%20range(3)%3A%0A%20%20%20%20%20%20%20%20nums.append(i)%0A%20%20%20%20%20%20%20%20time.sleep(1)%0A%20%20%20%20%20%20%20%20print(%22in%20process1%20pid%3D%25d%20%2Cnums%3D%25s%22%20%25%20(os.getpid()%2C%20nums))%0A%0Adef%20work2()%3A%0A%20%20%20%20%22%22%22%E5%AD%90%E8%BF%9B%E7%A8%8B%E8%A6%81%E6%89%A7%E8%A1%8C%E7%9A%84%E4%BB%A3%E7%A0%81%22%22%22%0A%20%20%20%20print(%22in%20process2%20pid%3D%25d%20%2Cnums%3D%25s%22%20%25%20(os.getpid()%2C%20nums))%0A%0Aif%20__name__%20%3D%3D%20'__main__'%3A%0A%20%20%20%20p1%20%3D%20Process(target%3Dwork1)%0A%20%20%20%20p1.start()%0A%20%20%20%20p1.join()%0A%0A%20%20%20%20p2%20%3D%20Process(target%3Dwork2)%0A%20%20%20%20p2.start()%0A%60%60%60%0A**%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C%3A**%0A%60%60%60%0Ain%20process1%20pid%3D11349%20%2Cnums%3D%5B11%2C%2022%5D%0Ain%20process1%20pid%3D11349%20%2Cnums%3D%5B11%2C%2022%2C%200%5D%0Ain%20process1%20pid%3D11349%20%2Cnums%3D%5B11%2C%2022%2C%200%2C%201%5D%0Ain%20process1%20pid%3D11349%20%2Cnums%3D%5B11%2C%2022%2C%200%2C%201%2C%202%5D%0Ain%20process2%20pid%3D11350%20%2Cnums%3D%5B11%2C%2022%5D%0A%60%60%60%0A%23%23%23%20**%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1-Queue**%0A%0A%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1-Queue%3A%0A%0AProcess%E4%B9%8B%E9%97%B4%E6%9C%89%E6%97%B6%E9%9C%80%E8%A6%81%E9%80%9A%E4%BF%A1%EF%BC%8C%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%8F%90%E4%BE%9B%E4%BA%86%E5%BE%88%E5%A4%9A%E6%9C%BA%E5%88%B6%E6%9D%A5%E5%AE%9E%E7%8E%B0%E8%BF%9B%E7%A8%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1%E3%80%82%0A%0A**1.%20Queue%E7%9A%84%E4%BD%BF%E7%94%A8**%0A%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8**multiprocessing**%E6%A8%A1%E5%9D%97%E7%9A%84**Queue**%E5%AE%9E%E7%8E%B0%E5%A4%9A%E8%BF%9B%E7%A8%8B%E4%B9%8B%E9%97%B4%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BC%A0%E9%80%92%EF%BC%8C**Queue**%E6%9C%AC%E8%BA%AB%E6%98%AF%E4%B8%80%E4%B8%AA%E6%B6%88%E6%81%AF%E5%88%97%E9%98%9F%E7%A8%8B%E5%BA%8F%EF%BC%8C%E4%BB%A5%E4%B8%8B%E5%B0%8F%E5%AE%9E%E4%BE%8B%E6%9D%A5%E6%BC%94%E7%A4%BA%E4%B8%80%E4%B8%8BQueue%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%EF%BC%9A%0A%60%60%60%0A%0A%23coding%3Dutf-8%0Afrom%20multiprocessing%20import%20Queue%0Aq%3DQueue(3)%20%23%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%80%E4%B8%AAQueue%E5%AF%B9%E8%B1%A1%EF%BC%8C%E6%9C%80%E5%A4%9A%E5%8F%AF%E6%8E%A5%E6%94%B6%E4%B8%89%E6%9D%A1put%E6%B6%88%E6%81%AF%0Aq.put(%22%E6%B6%88%E6%81%AF1%22)%20%0Aq.put(%22%E6%B6%88%E6%81%AF2%22)%0Aprint(q.full())%20%20%23False%0Aq.put(%22%E6%B6%88%E6%81%AF3%22)%0Aprint(q.full())%20%23True%0A%0A%23%E5%9B%A0%E4%B8%BA%E6%B6%88%E6%81%AF%E5%88%97%E9%98%9F%E5%B7%B2%E6%BB%A1%E4%B8%8B%E9%9D%A2%E7%9A%84try%E9%83%BD%E4%BC%9A%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8%EF%BC%8C%E7%AC%AC%E4%B8%80%E4%B8%AAtry%E4%BC%9A%E7%AD%89%E5%BE%852%E7%A7%92%E5%90%8E%E5%86%8D%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8%EF%BC%8C%E7%AC%AC%E4%BA%8C%E4%B8%AATry%E4%BC%9A%E7%AB%8B%E5%88%BB%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8%0Atry%3A%0A%20%20%20%20q.put(%22%E6%B6%88%E6%81%AF4%22%2CTrue%2C2)%0Aexcept%3A%0A%20%20%20%20print(%22%E6%B6%88%E6%81%AF%E5%88%97%E9%98%9F%E5%B7%B2%E6%BB%A1%EF%BC%8C%E7%8E%B0%E6%9C%89%E6%B6%88%E6%81%AF%E6%95%B0%E9%87%8F%3A%25s%22%25q.qsize())%0A%0Atry%3A%0A%20%20%20%20q.put_nowait(%22%E6%B6%88%E6%81%AF4%22)%0Aexcept%3A%0A%20%20%20%20print(%22%E6%B6%88%E6%81%AF%E5%88%97%E9%98%9F%E5%B7%B2%E6%BB%A1%EF%BC%8C%E7%8E%B0%E6%9C%89%E6%B6%88%E6%81%AF%E6%95%B0%E9%87%8F%3A%25s%22%25q.qsize())%0A%0A%23%E6%8E%A8%E8%8D%90%E7%9A%84%E6%96%B9%E5%BC%8F%EF%BC%8C%E5%85%88%E5%88%A4%E6%96%AD%E6%B6%88%E6%81%AF%E5%88%97%E9%98%9F%E6%98%AF%E5%90%A6%E5%B7%B2%E6%BB%A1%EF%BC%8C%E5%86%8D%E5%86%99%E5%85%A5%0Aif%20not%20q.full()%3A%0A%20%20%20%20q.put_nowait(%22%E6%B6%88%E6%81%AF4%22)%0A%0A%23%E8%AF%BB%E5%8F%96%E6%B6%88%E6%81%AF%E6%97%B6%EF%BC%8C%E5%85%88%E5%88%A4%E6%96%AD%E6%B6%88%E6%81%AF%E5%88%97%E9%98%9F%E6%98%AF%E5%90%A6%E4%B8%BA%E7%A9%BA%EF%BC%8C%E5%86%8D%E8%AF%BB%E5%8F%96%0Aif%20not%20q.empty()%3A%0A%20%20%20%20for%20i%20in%20range(q.qsize())%3A%0A%20%20%20%20%20%20%20%20print(q.get_nowait())%0A%60%60%60%0A**%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C**%3A%0A%60%60%60%0AFalse%0ATrue%0A%E6%B6%88%E6%81%AF%E5%88%97%E9%98%9F%E5%B7%B2%E6%BB%A1%EF%BC%8C%E7%8E%B0%E6%9C%89%E6%B6%88%E6%81%AF%E6%95%B0%E9%87%8F%3A3%0A%E6%B6%88%E6%81%AF%E5%88%97%E9%98%9F%E5%B7%B2%E6%BB%A1%EF%BC%8C%E7%8E%B0%E6%9C%89%E6%B6%88%E6%81%AF%E6%95%B0%E9%87%8F%3A3%0A%E6%B6%88%E6%81%AF1%0A%E6%B6%88%E6%81%AF2%0A%E6%B6%88%E6%81%AF3%0A%60%60%60%0A**%E8%AF%B4%E6%98%8E**%0A%0A%E5%88%9D%E5%A7%8B%E5%8C%96Queue()%E5%AF%B9%E8%B1%A1%E6%97%B6%EF%BC%88%E4%BE%8B%E5%A6%82%EF%BC%9Aq%3DQueue()%EF%BC%89%EF%BC%8C%E8%8B%A5%E6%8B%AC%E5%8F%B7%E4%B8%AD%E6%B2%A1%E6%9C%89%E6%8C%87%E5%AE%9A%E6%9C%80%E5%A4%A7%E5%8F%AF%E6%8E%A5%E6%94%B6%E7%9A%84%E6%B6%88%E6%81%AF%E6%95%B0%E9%87%8F%EF%BC%8C%E6%88%96%E6%95%B0%E9%87%8F%E4%B8%BA%E8%B4%9F%E5%80%BC%EF%BC%8C%E9%82%A3%E4%B9%88%E5%B0%B1%E4%BB%A3%E8%A1%A8%E5%8F%AF%E6%8E%A5%E5%8F%97%E7%9A%84%E6%B6%88%E6%81%AF%E6%95%B0%E9%87%8F%E6%B2%A1%E6%9C%89%E4%B8%8A%E9%99%90%EF%BC%88%E7%9B%B4%E5%88%B0%E5%86%85%E5%AD%98%E7%9A%84%E5%B0%BD%E5%A4%B4%EF%BC%89%EF%BC%9B%0A%0A-%20**Queue.qsize()**%EF%BC%9A%E8%BF%94%E5%9B%9E%E5%BD%93%E5%89%8D%E9%98%9F%E5%88%97%E5%8C%85%E5%90%AB%E7%9A%84%E6%B6%88%E6%81%AF%E6%95%B0%E9%87%8F%EF%BC%9B%0A%0A-%20**Queue.empty()**%EF%BC%9A%E5%A6%82%E6%9E%9C%E9%98%9F%E5%88%97%E4%B8%BA%E7%A9%BA%EF%BC%8C%E8%BF%94%E5%9B%9ETrue%EF%BC%8C%E5%8F%8D%E4%B9%8BFalse%20%EF%BC%9B%0A%0A-%20**Queue.full()**%EF%BC%9A%E5%A6%82%E6%9E%9C%E9%98%9F%E5%88%97%E6%BB%A1%E4%BA%86%EF%BC%8C%E8%BF%94%E5%9B%9ETrue%2C%E5%8F%8D%E4%B9%8BFalse%EF%BC%9B%0A%0A-%20**Queue.get(block%2C%20timeout)**%EF%BC%9A%E8%8E%B7%E5%8F%96%E9%98%9F%E5%88%97%E4%B8%AD%E7%9A%84%E4%B8%80%E6%9D%A1%E6%B6%88%E6%81%AF%EF%BC%8C%E7%84%B6%E5%90%8E%E5%B0%86%E5%85%B6%E4%BB%8E%E5%88%97%E9%98%9F%E4%B8%AD%E7%A7%BB%E9%99%A4%EF%BC%8Cblock%E9%BB%98%E8%AE%A4%E5%80%BC%E4%B8%BATrue%EF%BC%9B%0A%0A1%EF%BC%89%E5%A6%82%E6%9E%9Cblock%E4%BD%BF%E7%94%A8%E9%BB%98%E8%AE%A4%E5%80%BC%EF%BC%8C%E4%B8%94%E6%B2%A1%E6%9C%89%E8%AE%BE%E7%BD%AEtimeout%EF%BC%88%E5%8D%95%E4%BD%8D%E7%A7%92%EF%BC%89%EF%BC%8C%E6%B6%88%E6%81%AF%E5%88%97%E9%98%9F%E5%A6%82%E6%9E%9C%E4%B8%BA%E7%A9%BA%EF%BC%8C%E6%AD%A4%E6%97%B6%E7%A8%8B%E5%BA%8F%E5%B0%86%E8%A2%AB%E9%98%BB%E5%A1%9E%EF%BC%88%E5%81%9C%E5%9C%A8%E8%AF%BB%E5%8F%96%E7%8A%B6%E6%80%81%EF%BC%89%EF%BC%8C%E7%9B%B4%E5%88%B0%E4%BB%8E%E6%B6%88%E6%81%AF%E5%88%97%E9%98%9F%E8%AF%BB%E5%88%B0%E6%B6%88%E6%81%AF%E4%B8%BA%E6%AD%A2%EF%BC%8C%E5%A6%82%E6%9E%9C%E8%AE%BE%E7%BD%AE%E4%BA%86timeout%EF%BC%8C%E5%88%99%E4%BC%9A%E7%AD%89%E5%BE%85timeout%E7%A7%92%EF%BC%8C%E8%8B%A5%E8%BF%98%E6%B2%A1%E8%AF%BB%E5%8F%96%E5%88%B0%E4%BB%BB%E4%BD%95%E6%B6%88%E6%81%AF%EF%BC%8C%E5%88%99%E6%8A%9B%E5%87%BA%22Queue.Empty%22%E5%BC%82%E5%B8%B8%EF%BC%9B%0A%0A2%EF%BC%89%E5%A6%82%E6%9E%9Cblock%E5%80%BC%E4%B8%BAFalse%EF%BC%8C%E6%B6%88%E6%81%AF%E5%88%97%E9%98%9F%E5%A6%82%E6%9E%9C%E4%B8%BA%E7%A9%BA%EF%BC%8C%E5%88%99%E4%BC%9A%E7%AB%8B%E5%88%BB%E6%8A%9B%E5%87%BA%22Queue.Empty%22%E5%BC%82%E5%B8%B8%EF%BC%9B%0A%0A-%20**Queue.get_nowait()**%EF%BC%9A%E7%9B%B8%E5%BD%93Queue.get(False)%EF%BC%9B%0A%0A-%20**Queue.put(item%2Cblock%2Ctimeout)**%EF%BC%9A%E5%B0%86item%E6%B6%88%E6%81%AF%E5%86%99%E5%85%A5%E9%98%9F%E5%88%97%EF%BC%8Cblock%E9%BB%98%E8%AE%A4%E5%80%BC%E4%B8%BATrue%EF%BC%9B%0A%0A1%EF%BC%89%E5%A6%82%E6%9E%9Cblock%E4%BD%BF%E7%94%A8%E9%BB%98%E8%AE%A4%E5%80%BC%EF%BC%8C%E4%B8%94%E6%B2%A1%E6%9C%89%E8%AE%BE%E7%BD%AEtimeout%EF%BC%88%E5%8D%95%E4%BD%8D%E7%A7%92%EF%BC%89%EF%BC%8C%E6%B6%88%E6%81%AF%E5%88%97%E9%98%9F%E5%A6%82%E6%9E%9C%E5%B7%B2%E7%BB%8F%E6%B2%A1%E6%9C%89%E7%A9%BA%E9%97%B4%E5%8F%AF%E5%86%99%E5%85%A5%EF%BC%8C%E6%AD%A4%E6%97%B6%E7%A8%8B%E5%BA%8F%E5%B0%86%E8%A2%AB%E9%98%BB%E5%A1%9E%EF%BC%88%E5%81%9C%E5%9C%A8%E5%86%99%E5%85%A5%E7%8A%B6%E6%80%81%EF%BC%89%EF%BC%8C%E7%9B%B4%E5%88%B0%E4%BB%8E%E6%B6%88%E6%81%AF%E5%88%97%E9%98%9F%E8%85%BE%E5%87%BA%E7%A9%BA%E9%97%B4%E4%B8%BA%E6%AD%A2%EF%BC%8C%E5%A6%82%E6%9E%9C%E8%AE%BE%E7%BD%AE%E4%BA%86timeout%EF%BC%8C%E5%88%99%E4%BC%9A%E7%AD%89%E5%BE%85timeout%E7%A7%92%EF%BC%8C%E8%8B%A5%E8%BF%98%E6%B2%A1%E7%A9%BA%E9%97%B4%EF%BC%8C%E5%88%99%E6%8A%9B%E5%87%BA%22Queue.Full%22%E5%BC%82%E5%B8%B8%EF%BC%9B%0A%0A2%EF%BC%89%E5%A6%82%E6%9E%9Cblock%E5%80%BC%E4%B8%BAFalse%EF%BC%8C%E6%B6%88%E6%81%AF%E5%88%97%E9%98%9F%E5%A6%82%E6%9E%9C%E6%B2%A1%E6%9C%89%E7%A9%BA%E9%97%B4%E5%8F%AF%E5%86%99%E5%85%A5%EF%BC%8C%E5%88%99%E4%BC%9A%E7%AB%8B%E5%88%BB%E6%8A%9B%E5%87%BA%22Queue.Full%22%E5%BC%82%E5%B8%B8%EF%BC%9B%0A%0A-%20**Queue.put_nowait(item)**%EF%BC%9A%E7%9B%B8%E5%BD%93Queue.put(item%2C%20False)%EF%BC%9B%0A%0A**2.%20Queue%E5%AE%9E%E4%BE%8B%E4%BB%A5%E5%8F%8A%E5%9C%A8%E5%A4%9A%E8%BF%9B%E7%A8%8B%E9%97%B4%E7%9A%84%E4%BD%BF%E7%94%A8**%0A%0A%E6%88%91%E4%BB%AC%E4%BB%A5Queue%E4%B8%BA%E4%BE%8B%EF%BC%8C%E5%9C%A8%E7%88%B6%E8%BF%9B%E7%A8%8B%E4%B8%AD%E5%88%9B%E5%BB%BA%E4%B8%A4%E4%B8%AA%E5%AD%90%E8%BF%9B%E7%A8%8B%EF%BC%8C%E4%B8%80%E4%B8%AA%E5%BE%80Queue%E9%87%8C%E5%86%99%E6%95%B0%E6%8D%AE%EF%BC%8C%E4%B8%80%E4%B8%AA%E4%BB%8EQueue%E9%87%8C%E8%AF%BB%E6%95%B0%E6%8D%AE%EF%BC%9A%0A%60%60%60%0Afrom%20multiprocessing%20import%20Process%2C%20Queue%0Aimport%20os%2C%20time%2C%20random%0A%0A%23%20%E5%86%99%E6%95%B0%E6%8D%AE%E8%BF%9B%E7%A8%8B%E6%89%A7%E8%A1%8C%E7%9A%84%E4%BB%A3%E7%A0%81%3A%0Adef%20write(q)%3A%0A%20%20%20%20for%20value%20in%20%5B'A'%2C%20'B'%2C%20'C'%2C%20'D'%2C%20'E'%5D%3A%0A%20%20%20%20%20%20%20%20print('Put%20%25s%20to%20queue...'%20%25%20value)%0A%20%20%20%20%20%20%20%20q.put(value)%0A%20%20%20%20%20%20%20%20time.sleep(random.random())%0A%0A%23%20%E8%AF%BB%E6%95%B0%E6%8D%AE%E8%BF%9B%E7%A8%8B%E6%89%A7%E8%A1%8C%E7%9A%84%E4%BB%A3%E7%A0%81%3A%0Adef%20read(q)%3A%0A%20%20%20%20while%20True%3A%0A%20%20%20%20%20%20%20%20if%20not%20q.empty()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20value%20%3D%20q.get(True)%0A%20%20%20%20%20%20%20%20%20%20%20%20print('Get%20%25s%20from%20queue.'%20%25%20value)%0A%20%20%20%20%20%20%20%20%20%20%20%20time.sleep(random.random())%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20break%0A%0Aif%20__name__%3D%3D'__main__'%3A%0A%20%20%20%20%23%20%E7%88%B6%E8%BF%9B%E7%A8%8B%E5%88%9B%E5%BB%BAQueue%EF%BC%8C%E5%B9%B6%E4%BC%A0%E7%BB%99%E5%90%84%E4%B8%AA%E5%AD%90%E8%BF%9B%E7%A8%8B%EF%BC%9A%0A%20%20%20%20q%20%3D%20Queue()%0A%20%20%20%20pw%20%3D%20Process(target%3Dwrite%2C%20args%3D(q%2C))%0A%20%20%20%20pr%20%3D%20Process(target%3Dread%2C%20args%3D(q%2C))%0A%20%20%20%20%23%20%E5%90%AF%E5%8A%A8%E5%AD%90%E8%BF%9B%E7%A8%8Bpw%EF%BC%8C%E5%86%99%E5%85%A5%3A%0A%20%20%20%20pw.start()%0A%20%20%20%20%23%20%E7%AD%89%E5%BE%85pw%E7%BB%93%E6%9D%9F%3A%0A%20%20%20%20pw.join()%0A%20%20%20%20%23%20%E5%90%AF%E5%8A%A8%E5%AD%90%E8%BF%9B%E7%A8%8Bpr%EF%BC%8C%E8%AF%BB%E5%8F%96%3A%0A%20%20%20%20pr.start()%0A%20%20%20%20pr.join()%0A%0A%20%20%20%20print('%E6%89%80%E6%9C%89%E6%95%B0%E6%8D%AE%E9%83%BD%E5%86%99%E5%85%A5%E5%B9%B6%E4%B8%94%E8%AF%BB%E5%AE%8C')%0A%60%60%60%0A%0A%0A%23%23%23%20**%E8%BF%9B%E7%A8%8B%E6%B1%A0Pool**%0A%0A-%20%E5%BD%93%E9%9C%80%E8%A6%81%E5%88%9B%E5%BB%BA%E7%9A%84%E5%AD%90%E8%BF%9B%E7%A8%8B%E6%95%B0%E9%87%8F%E4%B8%8D%E5%A4%9A%E6%97%B6%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E5%88%A9%E7%94%A8multiprocessing%E4%B8%AD%E7%9A%84Process%E5%8A%A8%E6%80%81%E6%88%90%E7%94%9F%E5%A4%9A%E4%B8%AA%E8%BF%9B%E7%A8%8B%EF%BC%8C%E4%BD%86%E5%A6%82%E6%9E%9C%E6%98%AF%E4%B8%8A%E7%99%BE%E7%94%9A%E8%87%B3%E4%B8%8A%E5%8D%83%E4%B8%AA%E7%9B%AE%E6%A0%87%EF%BC%8C%E6%89%8B%E5%8A%A8%E7%9A%84%E5%8E%BB%E5%88%9B%E5%BB%BA%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%B7%A5%E4%BD%9C%E9%87%8F%E5%B7%A8%E5%A4%A7%EF%BC%8C%E6%AD%A4%E6%97%B6%E5%B0%B1%E5%8F%AF%E4%BB%A5%E7%94%A8%E5%88%B0multiprocessing%E6%A8%A1%E5%9D%97%E6%8F%90%E4%BE%9B%E7%9A%84Pool%E6%96%B9%E6%B3%95%E3%80%82%0A%0A-%20%E5%88%9D%E5%A7%8B%E5%8C%96Pool%E6%97%B6%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%8C%87%E5%AE%9A%E4%B8%80%E4%B8%AA%E6%9C%80%E5%A4%A7%E8%BF%9B%E7%A8%8B%E6%95%B0%EF%BC%8C%E5%BD%93%E6%9C%89%E6%96%B0%E7%9A%84%E8%AF%B7%E6%B1%82%E6%8F%90%E4%BA%A4%E5%88%B0Pool%E4%B8%AD%E6%97%B6%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%B1%A0%E8%BF%98%E6%B2%A1%E6%9C%89%E6%BB%A1%EF%BC%8C%E9%82%A3%E4%B9%88%E5%B0%B1%E4%BC%9A%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84%E8%BF%9B%E7%A8%8B%E7%94%A8%E6%9D%A5%E6%89%A7%E8%A1%8C%E8%AF%A5%E8%AF%B7%E6%B1%82%EF%BC%9B%E4%BD%86%E5%A6%82%E6%9E%9C%E6%B1%A0%E4%B8%AD%E7%9A%84%E8%BF%9B%E7%A8%8B%E6%95%B0%E5%B7%B2%E7%BB%8F%E8%BE%BE%E5%88%B0%E6%8C%87%E5%AE%9A%E7%9A%84%E6%9C%80%E5%A4%A7%E5%80%BC%EF%BC%8C%E9%82%A3%E4%B9%88%E8%AF%A5%E8%AF%B7%E6%B1%82%E5%B0%B1%E4%BC%9A%E7%AD%89%E5%BE%85%EF%BC%8C%E7%9B%B4%E5%88%B0%E6%B1%A0%E4%B8%AD%E6%9C%89%E8%BF%9B%E7%A8%8B%E7%BB%93%E6%9D%9F%EF%BC%8C%E6%89%8D%E4%BC%9A%E7%94%A8%E4%B9%8B%E5%89%8D%E7%9A%84%E8%BF%9B%E7%A8%8B%E6%9D%A5%E6%89%A7%E8%A1%8C%E6%96%B0%E7%9A%84%E4%BB%BB%E5%8A%A1%EF%BC%8C%E8%AF%B7%E7%9C%8B%E4%B8%8B%E9%9D%A2%E7%9A%84%E5%AE%9E%E4%BE%8B%EF%BC%9A%0A%0A%60%60%60%0A%23%20-*-%20coding%3Autf-8%20-*-%0Afrom%20multiprocessing%20import%20Pool%0Aimport%20os%2C%20time%2C%20random%0A%0Adef%20worker(msg)%3A%0A%20%20%20%20t_start%20%3D%20time.time()%0A%20%20%20%20print(%22%25s%E5%BC%80%E5%A7%8B%E6%89%A7%E8%A1%8C%2C%E8%BF%9B%E7%A8%8B%E5%8F%B7%E4%B8%BA%25d%22%20%25%20(msg%2Cos.getpid()))%0A%20%20%20%20%23%20random.random()%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%900~1%E4%B9%8B%E9%97%B4%E7%9A%84%E6%B5%AE%E7%82%B9%E6%95%B0%0A%20%20%20%20time.sleep(random.random()*2)%20%0A%20%20%20%20t_stop%20%3D%20time.time()%0A%20%20%20%20print(msg%2C%22%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%AF%95%EF%BC%8C%E8%80%97%E6%97%B6%250.2f%22%20%25%20(t_stop-t_start))%0A%0Apo%20%3D%20Pool(3)%20%20%23%20%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E8%BF%9B%E7%A8%8B%E6%B1%A0%EF%BC%8C%E6%9C%80%E5%A4%A7%E8%BF%9B%E7%A8%8B%E6%95%B03%0Afor%20i%20in%20range(0%2C10)%3A%0A%20%20%20%20%23%20Pool().apply_async(%E8%A6%81%E8%B0%83%E7%94%A8%E7%9A%84%E7%9B%AE%E6%A0%87%2C(%E4%BC%A0%E9%80%92%E7%BB%99%E7%9B%AE%E6%A0%87%E7%9A%84%E5%8F%82%E6%95%B0%E5%85%83%E7%A5%96%2C))%0A%20%20%20%20%23%20%E6%AF%8F%E6%AC%A1%E5%BE%AA%E7%8E%AF%E5%B0%86%E4%BC%9A%E7%94%A8%E7%A9%BA%E9%97%B2%E5%87%BA%E6%9D%A5%E7%9A%84%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%8E%BB%E8%B0%83%E7%94%A8%E7%9B%AE%E6%A0%87%0A%20%20%20%20po.apply_async(worker%2C(i%2C))%0A%0Aprint(%22----start----%22)%0A%0Apo.close()%20%20%23%20%E5%85%B3%E9%97%AD%E8%BF%9B%E7%A8%8B%E6%B1%A0%EF%BC%8C%E5%85%B3%E9%97%AD%E5%90%8Epo(%E8%BF%9B%E7%A8%8B%E6%B1%A0)%E4%B8%8D%E5%86%8D%E6%8E%A5%E6%94%B6%E6%96%B0%E4%BB%BB%E5%8A%A1%0Apo.join()%20%20%23%20%E7%AD%89%E5%BE%85po(%E8%BF%9B%E7%A8%8B%E6%B1%A0)%E4%B8%AD%E6%89%80%E6%9C%89%E5%AD%90%E8%BF%9B%E7%A8%8B%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%88%90%EF%BC%8C%E5%BF%85%E9%A1%BB%E6%94%BE%E5%9C%A8close%E8%AF%AD%E5%8F%A5%E4%B9%8B%E5%90%8E%0A%0Aprint(%22-----end-----%22)%0A%0A%60%60%60%0A**%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C%3A**%0A%60%60%60%0A----start----%0A0%E5%BC%80%E5%A7%8B%E6%89%A7%E8%A1%8C%2C%E8%BF%9B%E7%A8%8B%E5%8F%B7%E4%B8%BA21466%0A1%E5%BC%80%E5%A7%8B%E6%89%A7%E8%A1%8C%2C%E8%BF%9B%E7%A8%8B%E5%8F%B7%E4%B8%BA21468%0A2%E5%BC%80%E5%A7%8B%E6%89%A7%E8%A1%8C%2C%E8%BF%9B%E7%A8%8B%E5%8F%B7%E4%B8%BA21467%0A0%20%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%AF%95%EF%BC%8C%E8%80%97%E6%97%B61.01%0A3%E5%BC%80%E5%A7%8B%E6%89%A7%E8%A1%8C%2C%E8%BF%9B%E7%A8%8B%E5%8F%B7%E4%B8%BA21466%0A2%20%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%AF%95%EF%BC%8C%E8%80%97%E6%97%B61.24%0A4%E5%BC%80%E5%A7%8B%E6%89%A7%E8%A1%8C%2C%E8%BF%9B%E7%A8%8B%E5%8F%B7%E4%B8%BA21467%0A3%20%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%AF%95%EF%BC%8C%E8%80%97%E6%97%B60.56%0A5%E5%BC%80%E5%A7%8B%E6%89%A7%E8%A1%8C%2C%E8%BF%9B%E7%A8%8B%E5%8F%B7%E4%B8%BA21466%0A1%20%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%AF%95%EF%BC%8C%E8%80%97%E6%97%B61.68%0A6%E5%BC%80%E5%A7%8B%E6%89%A7%E8%A1%8C%2C%E8%BF%9B%E7%A8%8B%E5%8F%B7%E4%B8%BA21468%0A4%20%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%AF%95%EF%BC%8C%E8%80%97%E6%97%B60.67%0A7%E5%BC%80%E5%A7%8B%E6%89%A7%E8%A1%8C%2C%E8%BF%9B%E7%A8%8B%E5%8F%B7%E4%B8%BA21467%0A5%20%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%AF%95%EF%BC%8C%E8%80%97%E6%97%B60.83%0A8%E5%BC%80%E5%A7%8B%E6%89%A7%E8%A1%8C%2C%E8%BF%9B%E7%A8%8B%E5%8F%B7%E4%B8%BA21466%0A6%20%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%AF%95%EF%BC%8C%E8%80%97%E6%97%B60.75%0A9%E5%BC%80%E5%A7%8B%E6%89%A7%E8%A1%8C%2C%E8%BF%9B%E7%A8%8B%E5%8F%B7%E4%B8%BA21468%0A7%20%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%AF%95%EF%BC%8C%E8%80%97%E6%97%B61.03%0A8%20%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%AF%95%EF%BC%8C%E8%80%97%E6%97%B61.05%0A9%20%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%AF%95%EF%BC%8C%E8%80%97%E6%97%B61.69%0A-----end-----%0A%60%60%60%0A**multiprocessing.Pool%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0%E8%A7%A3%E6%9E%90%EF%BC%9A**%0A%0A-%20**apply_async(func%5B%2C%20args%5B%2C%20kwds%5D%5D)**%20%EF%BC%9A%E4%BD%BF%E7%94%A8%E9%9D%9E%E9%98%BB%E5%A1%9E%E6%96%B9%E5%BC%8F%E8%B0%83%E7%94%A8func%EF%BC%88%E5%B9%B6%E8%A1%8C%E6%89%A7%E8%A1%8C%EF%BC%8C%E5%A0%B5%E5%A1%9E%E6%96%B9%E5%BC%8F%E5%BF%85%E9%A1%BB%E7%AD%89%E5%BE%85%E4%B8%8A%E4%B8%80%E4%B8%AA%E8%BF%9B%E7%A8%8B%E9%80%80%E5%87%BA%E6%89%8D%E8%83%BD%E6%89%A7%E8%A1%8C%E4%B8%8B%E4%B8%80%E4%B8%AA%E8%BF%9B%E7%A8%8B%EF%BC%89%EF%BC%8Cargs%E4%B8%BA%E4%BC%A0%E9%80%92%E7%BB%99func%E7%9A%84%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8%EF%BC%8Ckwds%E4%B8%BA%E4%BC%A0%E9%80%92%E7%BB%99func%E7%9A%84%E5%85%B3%E9%94%AE%E5%AD%97%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8%EF%BC%9B%0A%0A-%20**close()**%EF%BC%9A%E5%85%B3%E9%97%ADPool%EF%BC%8C%E4%BD%BF%E5%85%B6%E4%B8%8D%E5%86%8D%E6%8E%A5%E5%8F%97%E6%96%B0%E7%9A%84%E4%BB%BB%E5%8A%A1%EF%BC%9B%0A-%20**terminate()**%EF%BC%9A%E4%B8%8D%E7%AE%A1%E4%BB%BB%E5%8A%A1%E6%98%AF%E5%90%A6%E5%AE%8C%E6%88%90%EF%BC%8C%E7%AB%8B%E5%8D%B3%E7%BB%88%E6%AD%A2%EF%BC%9B%0A-%20**join()**%EF%BC%9A%E4%B8%BB%E8%BF%9B%E7%A8%8B%E9%98%BB%E5%A1%9E%EF%BC%8C%E7%AD%89%E5%BE%85%E5%AD%90%E8%BF%9B%E7%A8%8B%E7%9A%84%E9%80%80%E5%87%BA%EF%BC%8C%20%E5%BF%85%E9%A1%BB%E5%9C%A8close%E6%88%96terminate%E4%B9%8B%E5%90%8E%E4%BD%BF%E7%94%A8%EF%BC%9B%0A%0A**%E8%BF%9B%E7%A8%8B%E6%B1%A0%E4%B8%AD%E4%B8%AD%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1Manager().Queue()**%0A%0A%E5%A6%82%E6%9E%9C%E8%A6%81%E4%BD%BF%E7%94%A8Pool%E5%88%9B%E5%BB%BA%E8%BF%9B%E7%A8%8B%EF%BC%8C%E5%B0%B1%E9%9C%80%E8%A6%81%E4%BD%BF%E7%94%A8multiprocessing.Manager()%E4%B8%AD%E7%9A%84Queue()%EF%BC%8C%E8%80%8C%E4%B8%8D%E6%98%AFmultiprocessing.Queue()%EF%BC%8C%E5%90%A6%E5%88%99%E4%BC%9A%E5%BE%97%E5%88%B0%E4%B8%80%E6%9D%A1%E5%A6%82%E4%B8%8B%E7%9A%84%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF%EF%BC%9A%0A%60%60%60%0ARuntimeError%3A%20Queue%20objects%20should%20only%20be%20shared%20between%20processes%20through%20inheritance.%0A%60%60%60%0A%E4%B8%8B%E9%9D%A2%E7%9A%84%E5%AE%9E%E4%BE%8B%E6%BC%94%E7%A4%BA%E4%BA%86%E8%BF%9B%E7%A8%8B%E6%B1%A0%E4%B8%AD%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%A6%82%E4%BD%95%E9%80%9A%E4%BF%A1%EF%BC%9A%0A%0A%60%60%60%0A%23%20-*-%20coding%3Autf-8%20-*-%0A%0A%23%20%E4%BF%AE%E6%94%B9import%E4%B8%AD%E7%9A%84Queue%E4%B8%BAManager%0Afrom%20multiprocessing%20import%20Manager%2CPool%0Aimport%20os%2Ctime%2Crandom%0A%0Adef%20writer(q)%3A%0A%20%20%20%20print(%22writer%E5%90%AF%E5%8A%A8(%25s)%2C%E7%88%B6%E8%BF%9B%E7%A8%8B%E4%B8%BA(%25s)%22%20%25%20(os.getpid()%2C%20os.getppid()))%0A%20%20%20%20for%20i%20in%20%22beicai1804%22%3A%0A%20%20%20%20%20%20%20%20q.put(i)%0A%0Adef%20reader(q)%3A%0A%20%20%20%20print(%22reader%E5%90%AF%E5%8A%A8(%25s)%2C%E7%88%B6%E8%BF%9B%E7%A8%8B%E4%B8%BA(%25s)%22%20%25%20(os.getpid()%2C%20os.getppid()))%0A%20%20%20%20for%20i%20in%20range(q.qsize())%3A%0A%20%20%20%20%20%20%20%20print(%22reader%E4%BB%8EQueue%E8%8E%B7%E5%8F%96%E5%88%B0%E6%B6%88%E6%81%AF%EF%BC%9A%25s%22%20%25%20q.get(True))%0A%0Aif%20__name__%3D%3D%22__main__%22%3A%0A%20%20%20%20print(%22(%25s)%20start%22%20%25%20os.getpid())%0A%20%20%20%20q%20%3D%20Manager().Queue()%20%20%23%20%E4%BD%BF%E7%94%A8Manager%E4%B8%AD%E7%9A%84Queue%0A%20%20%20%20po%20%3D%20Pool()%0A%20%20%20%20po.apply_async(writer%2C%20(q%2C))%0A%0A%20%20%20%20time.sleep(1)%20%20%23%20%E5%85%88%E8%AE%A9%E4%B8%8A%E9%9D%A2%E7%9A%84%E4%BB%BB%E5%8A%A1%E5%90%91Queue%E5%AD%98%E5%85%A5%E6%95%B0%E6%8D%AE%EF%BC%8C%E7%84%B6%E5%90%8E%E5%86%8D%E8%AE%A9%E4%B8%8B%E9%9D%A2%E7%9A%84%E4%BB%BB%E5%8A%A1%E5%BC%80%E5%A7%8B%E4%BB%8E%E4%B8%AD%E5%8F%96%E6%95%B0%E6%8D%AE%0A%0A%20%20%20%20po.apply_async(reader%2C%20(q%2C))%0A%20%20%20%20po.close()%0A%20%20%20%20po.join()%0A%20%20%20%20print(%22(%25s)%20End%22%20%25%20os.getpid())%0A%60%60%60%0A**%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C%3A**%0A%60%60%60%0A(11095)%20start%0Awriter%E5%90%AF%E5%8A%A8(11097)%2C%E7%88%B6%E8%BF%9B%E7%A8%8B%E4%B8%BA(11095)%0Areader%E5%90%AF%E5%8A%A8(11098)%2C%E7%88%B6%E8%BF%9B%E7%A8%8B%E4%B8%BA(11095)%0Areader%E4%BB%8EQueue%E8%8E%B7%E5%8F%96%E5%88%B0%E6%B6%88%E6%81%AF%EF%BC%9Ab%0Areader%E4%BB%8EQueue%E8%8E%B7%E5%8F%96%E5%88%B0%E6%B6%88%E6%81%AF%EF%BC%9Ae%0Areader%E4%BB%8EQueue%E8%8E%B7%E5%8F%96%E5%88%B0%E6%B6%88%E6%81%AF%EF%BC%9Ai%0Areader%E4%BB%8EQueue%E8%8E%B7%E5%8F%96%E5%88%B0%E6%B6%88%E6%81%AF%EF%BC%9Ac%0Areader%E4%BB%8EQueue%E8%8E%B7%E5%8F%96%E5%88%B0%E6%B6%88%E6%81%AF%EF%BC%9Aa%0Areader%E4%BB%8EQueue%E8%8E%B7%E5%8F%96%E5%88%B0%E6%B6%88%E6%81%AF%EF%BC%9Ai%0A......%0A(11095)%20End%0A%60%60%60%0A%0A%0A%23%23%23%20%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%AF%B9%E6%AF%94%EF%BC%9A%0A%0A**%E8%BF%9B%E7%A8%8B%E3%80%81%E7%BA%BF%E7%A8%8B%E5%AF%B9%E6%AF%94**%0A**%E5%8A%9F%E8%83%BD**%0A-%20%E8%BF%9B%E7%A8%8B%EF%BC%8C%E8%83%BD%E5%A4%9F%E5%AE%8C%E6%88%90%E5%A4%9A%E4%BB%BB%E5%8A%A1%EF%BC%8C%E6%AF%94%E5%A6%82%20%E5%9C%A8%E4%B8%80%E5%8F%B0%E7%94%B5%E8%84%91%E4%B8%8A%E8%83%BD%E5%A4%9F%E5%90%8C%E6%97%B6%E8%BF%90%E8%A1%8C%E5%A4%9A%E4%B8%AAQQ%0A-%20%E7%BA%BF%E7%A8%8B%EF%BC%8C%E8%83%BD%E5%A4%9F%E5%AE%8C%E6%88%90%E5%A4%9A%E4%BB%BB%E5%8A%A1%EF%BC%8C%E6%AF%94%E5%A6%82%20%E4%B8%80%E4%B8%AAQQ%E4%B8%AD%E7%9A%84%E5%A4%9A%E4%B8%AA%E8%81%8A%E5%A4%A9%E7%AA%97%E5%8F%A3%0A%0A**%E5%AE%9A%E4%B9%89%E7%9A%84%E4%B8%8D%E5%90%8C**%0A-%20%E8%BF%9B%E7%A8%8B%E6%98%AF%E7%B3%BB%E7%BB%9F%E8%BF%9B%E8%A1%8C%E8%B5%84%E6%BA%90%E5%88%86%E9%85%8D%E5%9F%BA%E6%9C%AC%E5%8D%95%E4%BD%8D.%0A%0A-%20%E7%BA%BF%E7%A8%8B%E6%98%AF%E8%BF%9B%E7%A8%8B%E7%9A%84%E4%B8%80%E4%B8%AA%E5%AE%9E%E4%BD%93%2C%E6%98%AFCPU%E8%B0%83%E5%BA%A6%E5%92%8C%E5%88%86%E6%B4%BE%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8D%95%E4%BD%8D%2C%E5%AE%83%E6%98%AF%E6%AF%94%E8%BF%9B%E7%A8%8B%E6%9B%B4%E5%B0%8F%E7%9A%84%E8%83%BD%E7%8B%AC%E7%AB%8B%E8%BF%90%E8%A1%8C%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8D%95%E4%BD%8D.%0A-%20%E7%BA%BF%E7%A8%8B%E8%87%AA%E5%B7%B1%E5%9F%BA%E6%9C%AC%E4%B8%8A%E4%B8%8D%E6%8B%A5%E6%9C%89%E7%B3%BB%E7%BB%9F%E8%B5%84%E6%BA%90%2C%E5%8F%AA%E6%8B%A5%E6%9C%89%E4%B8%80%E7%82%B9%E5%9C%A8%E8%BF%90%E8%A1%8C%E4%B8%AD%E5%BF%85%E4%B8%8D%E5%8F%AF%E5%B0%91%E7%9A%84%E8%B5%84%E6%BA%90(%E5%A6%82%E7%A8%8B%E5%BA%8F%E8%AE%A1%E6%95%B0%E5%99%A8%2C%E4%B8%80%E7%BB%84%E5%AF%84%E5%AD%98%E5%99%A8%E5%92%8C%E6%A0%88)%2C%E4%BD%86%E6%98%AF%E5%AE%83%E5%8F%AF%E4%B8%8E%E5%90%8C%E5%B1%9E%E4%B8%80%E4%B8%AA%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%85%B6%E4%BB%96%E7%9A%84%E7%BA%BF%E7%A8%8B%E5%85%B1%E4%BA%AB%E6%89%80%E5%9C%A8%E8%BF%9B%E7%A8%8B%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E5%85%A8%E9%83%A8%E8%B5%84%E6%BA%90%0A%0A**%E5%8C%BA%E5%88%AB**%0A-%20%E4%B8%80%E4%B8%AA%E7%A8%8B%E5%BA%8F%E8%87%B3%E5%B0%91%E6%9C%89%E4%B8%80%E4%B8%AA%E8%BF%9B%E7%A8%8B%2C%E4%B8%80%E4%B8%AA%E8%BF%9B%E7%A8%8B%E8%87%B3%E5%B0%91%E6%9C%89%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B.%0A-%20%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%88%92%E5%88%86%E5%B0%BA%E5%BA%A6%E5%B0%8F%E4%BA%8E%E8%BF%9B%E7%A8%8B(%E8%B5%84%E6%BA%90%E6%AF%94%E8%BF%9B%E7%A8%8B%E5%B0%91)%EF%BC%8C%E4%BD%BF%E5%BE%97%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%B9%B6%E5%8F%91%E6%80%A7%E9%AB%98%E3%80%82%0A-%20%E8%BF%9B%E7%A8%8B%E5%9C%A8%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B%E4%B8%AD%E6%8B%A5%E6%9C%89%E7%8B%AC%E7%AB%8B%E7%9A%84%E5%86%85%E5%AD%98%E5%8D%95%E5%85%83%EF%BC%8C%E8%80%8C%E5%A4%9A%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%EF%BC%8C%E4%BB%8E%E8%80%8C%E6%9E%81%E5%A4%A7%E5%9C%B0%E6%8F%90%E9%AB%98%E4%BA%86%E7%A8%8B%E5%BA%8F%E7%9A%84%E8%BF%90%E8%A1%8C%E6%95%88%E7%8E%87%0A-%20%E7%BA%BF%E7%BA%BF%E7%A8%8B%E4%B8%8D%E8%83%BD%E5%A4%9F%E7%8B%AC%E7%AB%8B%E6%89%A7%E8%A1%8C%EF%BC%8C%E5%BF%85%E9%A1%BB%E4%BE%9D%E5%AD%98%E5%9C%A8%E8%BF%9B%E7%A8%8B%E4%B8%AD%0A%0A**%E4%BC%98%E7%BC%BA%E7%82%B9**%0A%0A%E7%BA%BF%E7%A8%8B%E5%92%8C%E8%BF%9B%E7%A8%8B%E5%9C%A8%E4%BD%BF%E7%94%A8%E4%B8%8A%E5%90%84%E6%9C%89%E4%BC%98%E7%BC%BA%E7%82%B9%EF%BC%9A%E7%BA%BF%E7%A8%8B%E6%89%A7%E8%A1%8C%E5%BC%80%E9%94%80%E5%B0%8F%EF%BC%8C%E4%BD%86%E4%B8%8D%E5%88%A9%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%AE%A1%E7%90%86%E5%92%8C%E4%BF%9D%E6%8A%A4%EF%BC%9B%E8%80%8C%E8%BF%9B%E7%A8%8B%E6%AD%A3%E7%9B%B8%E5%8F%8D%E3%80%82%0A%0A**%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF**%EF%BC%9A%0A%0A**%E5%A4%9A%E8%BF%9B%E7%A8%8B%E5%B8%B8%E7%94%A8%E6%9D%A5%E5%A4%84%E7%90%86%E8%AE%A1%E7%AE%97%E5%AF%86%E9%9B%86%E5%9E%8B%E4%BB%BB%E5%8A%A1**%EF%BC%9A%0A%E8%AE%A1%E7%AE%97%E5%AF%86%E9%9B%86%E5%9E%8B%E4%BB%BB%E5%8A%A1%E7%9A%84%E7%89%B9%E7%82%B9%EF%BC%9A%E6%98%AF%E8%A6%81%E8%BF%9B%E8%A1%8C%E5%A4%A7%E9%87%8F%E7%9A%84%E8%AE%A1%E7%AE%97%EF%BC%8C%E6%B6%88%E8%80%97CPU%E8%B5%84%E6%BA%90%EF%BC%8C%E6%AF%94%E5%A6%82%E8%AE%A1%E7%AE%97%E5%9C%86%E5%91%A8%E7%8E%87%E3%80%81%E5%AF%B9%E8%A7%86%E9%A2%91%E8%BF%9B%E8%A1%8C%E9%AB%98%E6%B8%85%E8%A7%A3%E7%A0%81%E7%AD%89%E7%AD%89%EF%BC%8C%E5%85%A8%E9%9D%A0CPU%E7%9A%84%E8%BF%90%E7%AE%97%E8%83%BD%E5%8A%9B%E3%80%82%E8%AE%A1%E7%AE%97%E5%AF%86%E9%9B%86%E5%9E%8B%E4%BB%BB%E5%8A%A1%E5%8F%AF%E4%BB%A5%E7%94%A8%E5%A4%9A%E4%BB%BB%E5%8A%A1%E5%AE%8C%E6%88%90%EF%BC%8C%E4%BD%86%E6%98%AF%E4%BB%BB%E5%8A%A1%E8%B6%8A%E5%A4%9A%EF%BC%8C%E8%8A%B1%E5%9C%A8%E4%BB%BB%E5%8A%A1%E5%88%87%E6%8D%A2%E7%9A%84%E6%97%B6%E9%97%B4%E5%B0%B1%E8%B6%8A%E5%A4%9A%EF%BC%8CCPU%E6%89%A7%E8%A1%8C%E4%BB%BB%E5%8A%A1%E7%9A%84%E6%95%88%E7%8E%87%E5%B0%B1%E8%B6%8A%E4%BD%8E%EF%BC%8C%E6%89%80%E4%BB%A5%EF%BC%8C%E8%A6%81%E6%9C%80%E9%AB%98%E6%95%88%E5%9C%B0%E5%88%A9%E7%94%A8CPU%EF%BC%8C%E8%AE%A1%E7%AE%97%E5%AF%86%E9%9B%86%E5%9E%8B%E4%BB%BB%E5%8A%A1%E5%90%8C%E6%97%B6%E8%BF%9B%E8%A1%8C%E7%9A%84%E6%95%B0%E9%87%8F%E5%BA%94%E5%BD%93%E7%AD%89%E4%BA%8ECPU%E7%9A%84%E6%A0%B8%E5%BF%83%E6%95%B0%E3%80%82%0A%0A**%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%B8%B8%E7%94%A8%E6%9D%A5%E5%A4%84%E7%90%86IO%E5%AF%86%E9%9B%86%E5%9E%8B%E4%BB%BB%E5%8A%A1**%EF%BC%9A%0AIO%E5%AF%86%E9%9B%86%E5%9E%8B%EF%BC%9A%E6%B6%89%E5%8F%8A%E5%88%B0%E7%BD%91%E7%BB%9C%E3%80%81%E7%A3%81%E7%9B%98IO%E7%9A%84%E4%BB%BB%E5%8A%A1%E9%83%BD%E6%98%AFIO%E5%AF%86%E9%9B%86%E5%9E%8B%E4%BB%BB%E5%8A%A1%EF%BC%8C%E7%89%B9%E7%82%B9%E6%98%AFCPU%E6%B6%88%E8%80%97%E5%BE%88%E5%B0%91%EF%BC%8C%E4%BB%BB%E5%8A%A1%E7%9A%84%E5%A4%A7%E9%83%A8%E5%88%86%E6%97%B6%E9%97%B4%E9%83%BD%E5%9C%A8%E7%AD%89%E5%BE%85IO%E6%93%8D%E4%BD%9C%E5%AE%8C%E6%88%90%EF%BC%88%E5%9B%A0%E4%B8%BAIO%E7%9A%84%E9%80%9F%E5%BA%A6%E8%BF%9C%E8%BF%9C%E4%BD%8E%E4%BA%8ECPU%E5%92%8C%E5%86%85%E5%AD%98%E7%9A%84%E9%80%9F%E5%BA%A6%EF%BC%89%E3%80%82%E4%BD%86%E6%98%AF%E4%B9%9F%E8%A6%81%E5%88%87%E8%AE%B0%EF%BC%8C%E5%9C%A8%E6%89%A7%E8%A1%8C%E5%A4%9A%E4%BB%BB%E5%8A%A1%E6%97%B6%EF%BC%8C%E5%B9%B6%E4%B8%8D%E6%98%AF%E8%B6%8A%E5%A4%9A%E7%BA%BF%E7%A8%8B%E8%B6%8A%E5%A5%BD%E3%80%82%0A%0A-------------------------------------------------------%0A%0A%E6%A1%88%E4%BE%8B%E4%B8%80%3A%20%E5%B0%86jobbole%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%BF%AE%E6%94%B9%E4%B8%BA%E5%A4%9A%E8%BF%9B%E7%A8%8B%E7%88%AC%E8%99%AB%0A%0A-------------------------------------------------------%0A%0A%23%23%23%20%E8%BF%9B%E7%A8%8B%E6%B1%A0%0A%0A%0A**%E5%88%9B%E5%BB%BA%E8%BF%9B%E7%A8%8B%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F**%0A%0A%23%23%23%20%E7%AC%AC%E4%B8%80%E7%A7%8D%0A%60%60%60%0Afrom%20multiprocessing%20import%20Pool%0Aimport%20os%2Ctime%0Adef%20runtest(num)%3A%0A%20%20%20%20print('%E8%BF%9B%E7%A8%8B%E5%BC%80%E5%90%AF'%2Bstr(os.getpid()))%0A%20%20%20%20time.sleep(2)%0A%20%20%20%20%23%20print(num)%0A%20%20%20%20print('%E8%BF%9B%E7%A8%8B%E7%BB%93%E6%9D%9F'%2Bstr(os.getpid()))%0A%20%20%20%20return%20num%0A%0Adef%20done(future)%3A%0A%20%20%20%20print(future)%0A%0A%23%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E8%BF%9B%E7%A8%8B%E6%B1%A0%0Ap%20%3D%20Pool(4)%0Afor%20i%20in%20range(0%2C50)%3A%0A%20%20%20%20%23func%EF%BC%9A%E8%A1%A8%E7%A4%BA%E6%96%B9%E6%B3%95%EF%BC%88%E5%87%BD%E6%95%B0%EF%BC%89%E7%9A%84%E5%90%8D%E7%A7%B0%EF%BC%8Cargs%EF%BC%9A%E6%96%B9%E6%B3%95%EF%BC%88%E5%87%BD%E6%95%B0%EF%BC%89%E7%9A%84%E5%8F%82%E6%95%B0%E6%98%AF%E4%B8%80%E4%B8%AAtuple%EF%BC%88%E5%85%83%E7%BB%84%EF%BC%89%EF%BC%8C%0A%20%20%20%20%23callback%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0(%E4%B8%8D%E4%B8%80%E5%AE%9A%E8%A6%81%E5%86%99%EF%BC%8C%E7%9C%8B%E9%9C%80%E6%B1%82)%0A%20%20%20%20p.apply_async(func%3Druntest%2Cargs%3D(i%2C)%2Ccallback%3Ddone)%0A%0A%23close()%E8%A1%A8%E7%A4%BA%E5%85%B3%E9%97%AD%E8%BF%9B%E7%A8%8B%E6%B1%A0%EF%BC%8C%E4%B8%8D%E8%83%BD%E5%86%8D%E5%BE%80%E9%87%8C%E9%9D%A2%E6%B7%BB%E5%8A%A0%E4%BB%BB%E5%8A%A1%0Ap.close()%0Ap.join()%0A%60%60%60%0A%0A%23%23%23%23%20%E7%AC%AC%E4%BA%8C%E7%A7%8D%0A%60%60%60%0Afrom%20concurrent.futures%20import%20ThreadPoolExecutor%2CProcessPoolExecutor%0Aimport%20time%2Cos%0A%23%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E8%BF%9B%E7%A8%8B%E6%B1%A0%0Adef%20runtest(num)%3A%0A%20%20%20%20print('%E8%BF%9B%E7%A8%8B%E5%BC%80%E5%90%AF'%2Bstr(os.getpid()))%0A%20%20%20%20time.sleep(2)%0A%20%20%20%20%23%20print(num)%0A%20%20%20%20print('%E8%BF%9B%E7%A8%8B%E7%BB%93%E6%9D%9F'%2Bstr(os.getpid()))%0A%20%20%20%20return%20num%0A%0Adef%20done(future)%3A%0A%20%20%20%20print(future.result())%0A%0Apool%20%3D%20ProcessPoolExecutor(4)%0Afor%20i%20in%20range(0%2C50)%3A%0A%20%20%20%20handler%20%3D%20%20pool.submit(runtest%2Ci)%0A%20%20%20%20handler.add_done_callback(done)%0Apool.shutdown(wait%3DTrue)%0A%60%60%60%0A%0A%23%23%23%23%20%E8%AF%BE%E5%90%8E%E4%BD%9C%E4%B8%9A%EF%BC%9A%0A%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E7%B1%BB%2C%E5%8F%AF%E4%BB%A5%E8%AE%BE%E7%BD%AE%E4%BB%BB%E6%84%8F%E4%BA%AC%E4%B8%9C%E5%95%86%E5%93%81url%E5%9C%B0%E5%9D%80%EF%BC%8C%E8%8E%B7%E5%8F%96%E8%AF%A5%E5%95%86%E5%93%81%E7%9A%84%E5%85%A8%E9%83%A8%E8%AF%84%E8%AE%BA%E4%BF%A1%E6%81%AF%EF%BC%8C%E5%B0%86%E8%AF%84%E8%AE%BA%E4%BF%A1%E6%81%AF%E6%95%B0%E6%8D%AE%E5%88%86%E5%88%AB%E4%BF%9D%E5%AD%98%E8%87%B3csv%E6%96%87%E4%BB%B6%E5%92%8Cmysql%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8C%E8%A6%81%E6%B1%82%E4%BD%BF%E7%94%A8%E8%BF%9B%E7%A8%8B%E6%B1%A0%E6%9D%A5%E5%AE%8C%E6%88%90</center></div></body></html>